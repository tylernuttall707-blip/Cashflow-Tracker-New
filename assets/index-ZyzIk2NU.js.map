{"version":3,"file":"index-ZyzIk2NU.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../node_modules/react-dom/client.js","../../node_modules/zustand/esm/vanilla.mjs","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js","../../node_modules/use-sync-external-store/shim/index.js","../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js","../../node_modules/use-sync-external-store/shim/with-selector.js","../../node_modules/zustand/esm/index.mjs","../../node_modules/zustand/esm/middleware.mjs","../../src/modules/dateUtils.ts","../../src/modules/validation.ts","../../src/modules/storage.ts","../../src/store/useAppStore.ts","../../src/components/Layout.tsx","../../src/modules/transactions.ts","../../src/modules/calculations.ts","../../src/utils/chartUtils.ts","../../src/components/Dashboard.tsx","../../src/components/WhatIf.tsx","../../src/components/CashMovements.tsx","../../src/components/IncomePlan.tsx","../../src/components/Receivables.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useState = React.useState,\n  useEffect = React.useEffect,\n  useLayoutEffect = React.useLayoutEffect,\n  useDebugValue = React.useDebugValue;\nfunction useSyncExternalStore$2(subscribe, getSnapshot) {\n  var value = getSnapshot(),\n    _useState = useState({ inst: { value: value, getSnapshot: getSnapshot } }),\n    inst = _useState[0].inst,\n    forceUpdate = _useState[1];\n  useLayoutEffect(\n    function () {\n      inst.value = value;\n      inst.getSnapshot = getSnapshot;\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n    },\n    [subscribe, value, getSnapshot]\n  );\n  useEffect(\n    function () {\n      checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      return subscribe(function () {\n        checkIfSnapshotChanged(inst) && forceUpdate({ inst: inst });\n      });\n    },\n    [subscribe]\n  );\n  useDebugValue(value);\n  return value;\n}\nfunction checkIfSnapshotChanged(inst) {\n  var latestGetSnapshot = inst.getSnapshot;\n  inst = inst.value;\n  try {\n    var nextValue = latestGetSnapshot();\n    return !objectIs(inst, nextValue);\n  } catch (error) {\n    return !0;\n  }\n}\nfunction useSyncExternalStore$1(subscribe, getSnapshot) {\n  return getSnapshot();\n}\nvar shim =\n  \"undefined\" === typeof window ||\n  \"undefined\" === typeof window.document ||\n  \"undefined\" === typeof window.document.createElement\n    ? useSyncExternalStore$1\n    : useSyncExternalStore$2;\nexports.useSyncExternalStore =\n  void 0 !== React.useSyncExternalStore ? React.useSyncExternalStore : shim;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\"use strict\";\nvar React = require(\"react\"),\n  shim = require(\"use-sync-external-store/shim\");\nfunction is(x, y) {\n  return (x === y && (0 !== x || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\nvar objectIs = \"function\" === typeof Object.is ? Object.is : is,\n  useSyncExternalStore = shim.useSyncExternalStore,\n  useRef = React.useRef,\n  useEffect = React.useEffect,\n  useMemo = React.useMemo,\n  useDebugValue = React.useDebugValue;\nexports.useSyncExternalStoreWithSelector = function (\n  subscribe,\n  getSnapshot,\n  getServerSnapshot,\n  selector,\n  isEqual\n) {\n  var instRef = useRef(null);\n  if (null === instRef.current) {\n    var inst = { hasValue: !1, value: null };\n    instRef.current = inst;\n  } else inst = instRef.current;\n  instRef = useMemo(\n    function () {\n      function memoizedSelector(nextSnapshot) {\n        if (!hasMemo) {\n          hasMemo = !0;\n          memoizedSnapshot = nextSnapshot;\n          nextSnapshot = selector(nextSnapshot);\n          if (void 0 !== isEqual && inst.hasValue) {\n            var currentSelection = inst.value;\n            if (isEqual(currentSelection, nextSnapshot))\n              return (memoizedSelection = currentSelection);\n          }\n          return (memoizedSelection = nextSnapshot);\n        }\n        currentSelection = memoizedSelection;\n        if (objectIs(memoizedSnapshot, nextSnapshot)) return currentSelection;\n        var nextSelection = selector(nextSnapshot);\n        if (void 0 !== isEqual && isEqual(currentSelection, nextSelection))\n          return (memoizedSnapshot = nextSnapshot), currentSelection;\n        memoizedSnapshot = nextSnapshot;\n        return (memoizedSelection = nextSelection);\n      }\n      var hasMemo = !1,\n        memoizedSnapshot,\n        memoizedSelection,\n        maybeGetServerSnapshot =\n          void 0 === getServerSnapshot ? null : getServerSnapshot;\n      return [\n        function () {\n          return memoizedSelector(getSnapshot());\n        },\n        null === maybeGetServerSnapshot\n          ? void 0\n          : function () {\n              return memoizedSelector(maybeGetServerSnapshot());\n            }\n      ];\n    },\n    [getSnapshot, getServerSnapshot, selector, isEqual]\n  );\n  var value = useSyncExternalStore(subscribe, instRef[0], instRef[1]);\n  useEffect(\n    function () {\n      inst.hasValue = !0;\n      inst.value = value;\n    },\n    [value]\n  );\n  useDebugValue(value);\n  return value;\n};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n","import type { YMDString, WeekendRollPolicy } from '../types';\n\n/**\n * Pad a number with a leading zero when needed.\n */\nconst pad = (value: number): string => String(value).padStart(2, \"0\");\n\n/**\n * Convert a Date instance into a YYYY-MM-DD string.\n */\nexport const toYMD = (date: Date): YMDString =>\n  `${date.getFullYear()}-${pad(date.getMonth() + 1)}-${pad(date.getDate())}`;\n\n/**\n * Convert a YYYY-MM-DD string into a Date instance.\n */\nexport const fromYMD = (value: string): Date => {\n  const [year, month, day] = String(value || \"\").split(\"-\").map(Number);\n  return new Date(year, (month || 1) - 1, day || 1);\n};\n\n/**\n * Compare two YYYY-MM-DD strings lexicographically.\n * @returns Negative if a < b, positive if a > b, otherwise 0.\n */\nexport const compareYMD = (a: string, b: string): number =>\n  String(a || \"\").localeCompare(String(b || \"\"));\n\n/**\n * Add days to a YYYY-MM-DD string.\n */\nexport const addDays = (ymd: YMDString, days: number = 0): YMDString => {\n  if (!ymd || typeof ymd !== \"string\") return ymd;\n  const delta = Number(days || 0);\n  if (!Number.isFinite(delta)) return ymd;\n  const date = fromYMD(ymd);\n  if (Number.isNaN(date.getTime())) return ymd;\n  date.setDate(date.getDate() + delta);\n  return toYMD(date);\n};\n\n/**\n * Subtract days from a YYYY-MM-DD string.\n */\nexport const subtractDays = (ymd: YMDString, days: number = 0): YMDString =>\n  addDays(ymd, -(Number(days || 0)));\n\n/**\n * Determine if a date string falls on a weekend.\n */\nexport const isWeekend = (ymd: YMDString): boolean => {\n  if (!ymd || typeof ymd !== \"string\") return false;\n  const date = fromYMD(ymd);\n  if (Number.isNaN(date.getTime())) return false;\n  const day = date.getDay();\n  return day === 0 || day === 6;\n};\n\n/**\n * Move the supplied date away from weekends according to a policy.\n */\nexport const rollWeekend = (ymd: YMDString, policy: WeekendRollPolicy = \"forward\"): YMDString => {\n  if (!ymd || typeof ymd !== \"string\") return ymd;\n  const date = fromYMD(ymd);\n  if (Number.isNaN(date.getTime())) return ymd;\n\n  const moveForward = () => {\n    do {\n      date.setDate(date.getDate() + 1);\n    } while (date.getDay() === 0 || date.getDay() === 6);\n  };\n\n  const moveBack = () => {\n    do {\n      date.setDate(date.getDate() - 1);\n    } while (date.getDay() === 0 || date.getDay() === 6);\n  };\n\n  if (date.getDay() === 0 || date.getDay() === 6) {\n    if (policy === \"back\") moveBack();\n    else if (policy === \"forward\") moveForward();\n  }\n\n  return toYMD(date);\n};\n\n/**\n * Compute the next business day relative to a date string.\n */\nexport const nextBusinessDay = (ymd: YMDString, direction: \"forward\" | \"back\" = \"forward\"): YMDString => {\n  if (!ymd || typeof ymd !== \"string\") return ymd;\n  const step = direction === \"back\" ? -1 : 1;\n  let candidate = addDays(ymd, step);\n  for (let i = 0; i < 14; i += 1) {\n    if (!isWeekend(candidate)) return candidate;\n    candidate = addDays(candidate, step);\n  }\n  return candidate;\n};\n\n/**\n * Parse a value that may contain an Excel serial or ISO-like date.\n * @returns A YYYY-MM-DD string or null when parsing fails.\n */\nexport const parseExcelOrISODate = (value: string | number | Date | null | undefined): YMDString | null => {\n  if (value === null || value === undefined || value === \"\") return null;\n\n  if (value instanceof Date) {\n    if (Number.isNaN(value.getTime())) return null;\n    return toYMD(value);\n  }\n\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    const serial = Number(value);\n    const whole = Math.floor(serial);\n    const frac = serial - whole;\n    let days = whole;\n    if (days > 59) days -= 1; // Excel leap year bug\n    const epoch = Date.UTC(1899, 11, 31);\n    const ms = epoch + days * 86400000 + Math.round(frac * 86400000);\n    const dt = new Date(ms);\n    if (Number.isNaN(dt.getTime())) return null;\n    return `${dt.getUTCFullYear()}-${pad(dt.getUTCMonth() + 1)}-${pad(dt.getUTCDate())}`;\n  }\n\n  const str = String(value).trim();\n  if (!str) return null;\n\n  if (/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(str)) {\n    const [y, m, d] = str.split(\"-\").map(Number);\n    const dt = new Date(y, m - 1, d);\n    if (Number.isNaN(dt.getTime())) return null;\n    return toYMD(dt);\n  }\n\n  const [datePart] = str.split(/\\s+/);\n  if (/^\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4}$/.test(datePart)) {\n    const parts = datePart.split(/[/-]/).map((seg) => seg.trim());\n    if (parts.length === 3) {\n      const [m, d, yRaw] = parts;\n      let year = Number(yRaw);\n      const month = Number(m);\n      const day = Number(d);\n      if (!Number.isFinite(year) || !Number.isFinite(month) || !Number.isFinite(day)) return null;\n      if (year < 100) year += year >= 70 ? 1900 : 2000;\n      const dt = new Date(year, month - 1, day);\n      if (Number.isNaN(dt.getTime())) return null;\n      return toYMD(dt);\n    }\n  }\n\n  const parsed = new Date(str);\n  if (Number.isNaN(parsed.getTime())) return null;\n  return toYMD(parsed);\n};\n\n/**\n * Calculate the whole number of months between two dates.\n * @returns Non-negative number of months separating the inputs.\n */\nexport const monthsBetween = (start: Date, end: Date): number => {\n  if (!(start instanceof Date) || !(end instanceof Date)) return 0;\n  const diff = (end.getFullYear() - start.getFullYear()) * 12 + (end.getMonth() - start.getMonth());\n  return Math.max(0, diff);\n};\n\n/**\n * Resolve today's date in YYYY-MM-DD format.\n */\nexport const todayYMD = (() => {\n  const now = new Date();\n  return toYMD(now);\n})();\n","\"use strict\";\n\nimport { compareYMD, fromYMD, toYMD, todayYMD } from \"./dateUtils\";\nimport type {\n  AppState,\n  Transaction,\n  OneOffTransaction,\n  RecurringTransaction,\n  IncomeStream,\n  Step,\n  OneOffSortState,\n  OneOffSortKey,\n  YMDString,\n  NthWeek,\n  WhatIfState,\n  AROptions,\n  ARMappingOverrides,\n  ClampOptions,\n  Settings,\n  GlobalTweak,\n  StreamTweak,\n  SaleConfig,\n} from \"../types\";\n\nconst ONE_OFF_SORT_KEYS: OneOffSortKey[] = [\"date\", \"schedule\", \"type\", \"name\", \"category\", \"next\"];\nconst DEFAULT_END: YMDString = \"2025-12-31\";\n\n/**\n * Normalize arbitrary weekday input into a sorted array of unique indices.\n */\nconst normalizeWeekdayArray = (value: unknown): number[] => {\n  if (value === undefined || value === null) return [];\n\n  const raw = Array.isArray(value)\n    ? value\n    : typeof value === \"string\" && value.includes(\",\")\n    ? value.split(/[\\s,]+/)\n    : [value];\n\n  const seen = new Set<number>();\n  const days: number[] = [];\n  for (const item of raw) {\n    if (item === undefined || item === null) continue;\n    const str = String(item).trim();\n    if (!str) continue;\n    const num = Number(str);\n    if (!Number.isFinite(num)) continue;\n    const normalized = clamp(Math.trunc(num), 0, 6);\n    if (!seen.has(normalized)) {\n      seen.add(normalized);\n      days.push(normalized);\n    }\n  }\n\n  return days.sort((a, b) => a - b);\n};\n\n/**\n * Resolve the first weekday index from arbitrary input.\n */\nconst normalizeFirstWeekday = (value: unknown, fallback: number = 0): number => {\n  const days = normalizeWeekdayArray(value);\n  if (days.length) return days[0];\n  const num = Number(value);\n  if (Number.isFinite(num)) return clamp(Math.trunc(num), 0, 6);\n  return clamp(Number(fallback) || 0, 0, 6);\n};\n\n/**\n * Normalize the nth ordinal descriptor for monthly recurrences.\n */\nconst normalizeNthDescriptor = (value: unknown): NthWeek => {\n  if (value === null || value === undefined) return \"1\";\n  if (typeof value === \"string\") {\n    const trimmed = value.trim().toLowerCase();\n    if (trimmed === \"last\") return \"last\";\n    const parsed = Number.parseInt(trimmed, 10);\n    if (Number.isFinite(parsed) && parsed >= 1 && parsed <= 5) return String(parsed) as NthWeek;\n  }\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    const int = Math.trunc(value);\n    if (int >= 1 && int <= 5) return String(int) as NthWeek;\n  }\n  return \"1\";\n};\n\n/**\n * Generate a random identifier suitable for client-side records.\n */\nconst uid = (): string => Math.random().toString(36).slice(2, 9);\n\n/**\n * Deep clone arbitrary JSON-safe values.\n */\nconst deepClone = <T>(value: T): T | null => {\n  try {\n    return JSON.parse(JSON.stringify(value));\n  } catch {\n    return null;\n  }\n};\n\n/**\n * Round a numeric value to two decimal places.\n */\nconst round2 = (value: number): number => {\n  const num = Number(value);\n  if (!Number.isFinite(num)) return 0;\n  return Math.round(num * 100) / 100;\n};\n\n/**\n * Clamp a numeric value between inclusive bounds.\n */\nexport const clamp = (value: number, min: number, max: number): number =>\n  Math.max(min, Math.min(max, value));\n\n/**\n * Clamp percentage-like inputs while preserving precision.\n */\nexport const clampPercent = (\n  value: number,\n  { min = -1, max = 2, fallback = 0 }: ClampOptions = {}\n): number => {\n  const num = Number(value);\n  if (!Number.isFinite(num)) return fallback;\n  return Math.max(min, Math.min(max, Math.round(num * 1000) / 1000));\n};\n\n/**\n * Clamp currency values to two decimal places.\n */\nexport const clampCurrency = (value: number, fallback: number = 0): number => {\n  const num = Number(value);\n  if (!Number.isFinite(num)) return fallback;\n  return round2(num);\n};\n\n/**\n * Produce the default one-off sort state configuration.\n */\nexport const defaultOneOffSortState = (): OneOffSortState => ({\n  key: \"date\",\n  direction: \"asc\"\n});\n\n/**\n * Sanitize persisted sort preferences for one-off entries.\n */\nexport const sanitizeOneOffSortState = (value: unknown): OneOffSortState => {\n  const defaults = defaultOneOffSortState();\n  if (!value || typeof value !== \"object\") return defaults;\n  const obj = value as Record<string, unknown>;\n  const key = ONE_OFF_SORT_KEYS.includes(obj.key as OneOffSortKey)\n    ? (obj.key as OneOffSortKey)\n    : defaults.key;\n  const direction = obj.direction === \"desc\" ? \"desc\" : defaults.direction;\n  return { key, direction };\n};\n\n/**\n * Determine if a value is a valid YYYY-MM-DD string.\n */\nexport const isValidYMDString = (value: unknown): value is YMDString => {\n  if (typeof value !== \"string\" || !value) return false;\n  const parsed = fromYMD(value);\n  if (Number.isNaN(parsed.getTime())) return false;\n  return toYMD(parsed) === value;\n};\n\n/**\n * Sanitize recurring step adjustments.\n */\nexport const sanitizeSteps = (value: unknown): Step[] => {\n  if (!Array.isArray(value)) return [];\n  return value\n    .map((step): Step | null => {\n      if (!step || typeof step !== \"object\" || Array.isArray(step)) return null;\n      const stepObj = step as Record<string, unknown>;\n      const effectiveFrom =\n        typeof stepObj.effectiveFrom === \"string\" && isValidYMDString(stepObj.effectiveFrom)\n          ? stepObj.effectiveFrom\n          : null;\n      const amount = Number(stepObj.amount || 0);\n      if (!effectiveFrom || !Number.isFinite(amount)) return null;\n      return { effectiveFrom, amount: Math.abs(amount) };\n    })\n    .filter((step): step is Step => step !== null)\n    .sort((a, b) => compareYMD(a.effectiveFrom, b.effectiveFrom));\n};\n\n/**\n * Sanitize single one-off transaction entries.\n */\nexport const sanitizeOneOff = (entry: unknown, strict: boolean = false): Transaction | null => {\n  if (!entry || typeof entry !== \"object\" || Array.isArray(entry)) {\n    if (strict) throw new Error(\"Invalid one-off record\");\n    return null;\n  }\n\n  const entryObj = entry as Record<string, unknown>;\n  const amount = Number(entryObj.amount || 0);\n  if (!Number.isFinite(amount)) {\n    if (strict) throw new Error(\"Invalid one-off amount\");\n    return null;\n  }\n\n  const type: \"income\" | \"expense\" = entryObj.type === \"income\" ? \"income\" : \"expense\";\n  const id = typeof entryObj.id === \"string\" ? entryObj.id : uid();\n  const baseResult = {\n    id,\n    type,\n    name: typeof entryObj.name === \"string\" ? entryObj.name : \"\",\n    category: typeof entryObj.category === \"string\" ? entryObj.category : \"\",\n    amount: Math.abs(amount),\n    recurring: Boolean(entryObj.recurring),\n  };\n\n  const resultWithNote = typeof entryObj.note === \"string\"\n    ? { ...baseResult, note: entryObj.note }\n    : baseResult;\n\n  const steps = sanitizeSteps(entryObj.steps);\n  const escalator = Number(entryObj.escalatorPct || 0);\n  const escalatorPct = Number.isFinite(escalator) ? escalator : 0;\n\n  if (baseResult.recurring) {\n    const frequency = typeof entryObj.frequency === \"string\" ? entryObj.frequency : null;\n    const startDate = typeof entryObj.startDate === \"string\" ? entryObj.startDate : null;\n    const endDate = typeof entryObj.endDate === \"string\"\n      ? entryObj.endDate\n      : typeof entryObj.date === \"string\"\n        ? entryObj.date\n        : null;\n    const datesValid = frequency && startDate && endDate &&\n      isValidYMDString(startDate) && isValidYMDString(endDate);\n    if (!datesValid) {\n      if (strict) throw new Error(\"Invalid recurring one-off metadata\");\n      return null;\n    }\n\n    const recurringResult: RecurringTransaction = {\n      ...resultWithNote,\n      recurring: true as const,\n      frequency: frequency as any,\n      startDate,\n      endDate,\n      steps,\n      escalatorPct,\n    };\n\n    const start = fromYMD(startDate);\n    const startDow = Number.isNaN(start.getTime()) ? 0 : start.getDay();\n    const startDom = Number.isNaN(start.getTime()) ? 1 : start.getDate();\n\n    if (compareYMD(recurringResult.startDate, recurringResult.endDate) > 0) {\n      if (strict) throw new Error(\"Invalid recurring one-off range\");\n      recurringResult.endDate = recurringResult.startDate;\n    }\n\n    const onDate = typeof entryObj.onDate === \"string\" ? entryObj.onDate : null;\n    if (onDate) recurringResult.onDate = onDate;\n\n    if (frequency === \"daily\") {\n      recurringResult.skipWeekends = Boolean(entryObj.skipWeekends);\n    }\n\n    if (frequency === \"weekly\" || frequency === \"biweekly\") {\n      const weekdays = normalizeWeekdayArray(entryObj.dayOfWeek);\n      recurringResult.dayOfWeek = weekdays.length ? weekdays : [startDow];\n    }\n\n    if (frequency === \"monthly\") {\n      const mode = entryObj.monthlyMode === \"nth\" ? \"nth\" : \"day\";\n      recurringResult.monthlyMode = mode;\n      if (mode === \"nth\") {\n        const weekdays = normalizeWeekdayArray(entryObj.dayOfWeek);\n        if (weekdays.length) recurringResult.dayOfWeek = weekdays;\n        recurringResult.nthWeek = normalizeNthDescriptor(\n          (entryObj.nthWeek as any) ?? (entryObj.nthWeekNumber as any)\n        );\n        recurringResult.nthWeekday = normalizeFirstWeekday(\n          (entryObj.nthWeekday as any) ?? (entryObj.dayOfWeek as any),\n          startDow\n        );\n      } else {\n        const rawDom = Number(entryObj.dayOfMonth);\n        const dom = Number.isFinite(rawDom) ? Math.trunc(rawDom) : startDom;\n        recurringResult.dayOfMonth = clamp(dom, 1, 31);\n      }\n    }\n\n    return recurringResult;\n  } else {\n    const date = typeof entryObj.date === \"string\" ? entryObj.date : null;\n    if (!date) {\n      if (strict) throw new Error(\"Invalid one-off date\");\n      return null;\n    }\n\n    const oneOffResult: OneOffTransaction = {\n      ...resultWithNote,\n      recurring: false as const,\n      date,\n      steps: [] as never[],\n      escalatorPct: 0,\n    };\n\n    return oneOffResult;\n  }\n};\n\n/**\n * Sanitize an income stream definition.\n */\nexport const sanitizeStream = (entry: unknown, strict: boolean = false): IncomeStream | null => {\n  if (!entry || typeof entry !== \"object\" || Array.isArray(entry)) {\n    if (strict) throw new Error(\"Invalid income stream record\");\n    return null;\n  }\n\n  const entryObj = entry as Record<string, unknown>;\n  const amount = Number(entryObj.amount || 0);\n  if (!Number.isFinite(amount)) {\n    if (strict) throw new Error(\"Invalid income stream amount\");\n    return null;\n  }\n\n  const frequency = typeof entryObj.frequency === \"string\" ? entryObj.frequency : \"once\";\n  const startDate = typeof entryObj.startDate === \"string\"\n    ? entryObj.startDate\n    : typeof entryObj.onDate === \"string\"\n      ? entryObj.onDate\n      : null;\n  const endDate = typeof entryObj.endDate === \"string\"\n    ? entryObj.endDate\n    : typeof entryObj.onDate === \"string\"\n      ? entryObj.onDate\n      : null;\n  const datesValid = startDate && endDate &&\n    isValidYMDString(startDate) && isValidYMDString(endDate);\n  if (!datesValid) {\n    if (strict) throw new Error(\"Invalid income stream date range\");\n    return null;\n  }\n\n  const startVsEnd = compareYMD(startDate, endDate);\n  const normalizedStart = startVsEnd <= 0 ? startDate : endDate;\n  const normalizedEnd = startVsEnd <= 0 ? endDate : startDate;\n\n  const id = typeof entryObj.id === \"string\" ? entryObj.id : uid();\n  const startDateObj = fromYMD(normalizedStart);\n  const startDow = Number.isNaN(startDateObj.getTime()) ? 0 : startDateObj.getDay();\n  const startDom = Number.isNaN(startDateObj.getTime()) ? 1 : startDateObj.getDate();\n\n  const stream: IncomeStream = {\n    id,\n    name: typeof entryObj.name === \"string\" ? entryObj.name : \"\",\n    category: typeof entryObj.category === \"string\" ? entryObj.category : \"\",\n    amount: Math.abs(amount),\n    frequency: frequency as any,\n    startDate: normalizedStart,\n    endDate: normalizedEnd,\n    onDate: typeof entryObj.onDate === \"string\" ? entryObj.onDate : null,\n    skipWeekends: Boolean(entryObj.skipWeekends),\n    steps: sanitizeSteps(entryObj.steps),\n    escalatorPct: Number.isFinite(Number(entryObj.escalatorPct || 0))\n      ? Number(entryObj.escalatorPct || 0)\n      : 0,\n  };\n\n  if (frequency === \"once\") {\n    stream.onDate = typeof entryObj.onDate === \"string\" ? entryObj.onDate : stream.startDate;\n  }\n  if (frequency === \"daily\") {\n    stream.skipWeekends = Boolean(entryObj.skipWeekends);\n  }\n  if (frequency === \"weekly\" || frequency === \"biweekly\") {\n    const weekdays = normalizeWeekdayArray(entryObj.dayOfWeek);\n    stream.dayOfWeek = weekdays.length ? weekdays : [startDow];\n  }\n  if (frequency === \"monthly\") {\n    const mode = entryObj.monthlyMode === \"nth\" ? \"nth\" : \"day\";\n    stream.monthlyMode = mode;\n    if (mode === \"nth\") {\n      const weekdays = normalizeWeekdayArray(entryObj.dayOfWeek);\n      if (weekdays.length) stream.dayOfWeek = weekdays;\n      stream.nthWeek = normalizeNthDescriptor(\n        (entryObj.nthWeek as any) ?? (entryObj.nthWeekNumber as any)\n      );\n      stream.nthWeekday = normalizeFirstWeekday(\n        (entryObj.nthWeekday as any) ?? (entryObj.dayOfWeek as any),\n        startDow\n      );\n    } else {\n      const rawDom = Number(entryObj.dayOfMonth);\n      const dom = Number.isFinite(rawDom) ? Math.trunc(rawDom) : startDom;\n      stream.dayOfMonth = clamp(dom, 1, 31);\n    }\n  }\n\n  return stream;\n};\n\n/**\n * Generate the default application state structure.\n */\nexport const defaultState = (): AppState => ({\n  settings: {\n    startDate: todayYMD,\n    endDate: DEFAULT_END,\n    startingBalance: 0,\n  },\n  adjustments: [],\n  oneOffs: [],\n  incomeStreams: [],\n  ui: {\n    oneOffSort: defaultOneOffSortState(),\n  },\n});\n\n/**\n * Normalize persisted state payloads.\n */\nexport const normalizeState = (\n  raw: unknown,\n  { strict = false }: { strict?: boolean } = {}\n): AppState => {\n  if (!raw || typeof raw !== \"object\" || Array.isArray(raw)) {\n    throw new Error(\"Invalid state payload\");\n  }\n\n  const rawObj = raw as Record<string, unknown>;\n  const base = defaultState();\n  const state: AppState = { ...base, ...rawObj } as AppState;\n\n  const rawSettings = rawObj.settings;\n  if (rawSettings && typeof rawSettings === \"object\" && !Array.isArray(rawSettings)) {\n    state.settings = { ...base.settings, ...(rawSettings as Record<string, unknown>) } as Settings;\n  } else {\n    if (strict) throw new Error(\"Invalid settings data\");\n    state.settings = { ...base.settings };\n  }\n\n  if (rawObj.ui && typeof rawObj.ui === \"object\" && !Array.isArray(rawObj.ui)) {\n    const rawUi = rawObj.ui as Record<string, unknown>;\n    state.ui = { ...base.ui, ...rawUi } as any;\n    state.ui.oneOffSort = sanitizeOneOffSortState(rawUi.oneOffSort);\n  } else {\n    if (strict && rawObj.ui !== undefined) throw new Error(\"Invalid ui data\");\n    state.ui = { ...base.ui };\n  }\n\n  const ensureArray = (key: keyof AppState): void => {\n    const value = rawObj[key] ?? state[key];\n    if (value === undefined) {\n      (state as any)[key] = [];\n      return;\n    }\n    if (!Array.isArray(value)) {\n      if (strict) throw new Error(`Invalid ${key}; expected an array`);\n      (state as any)[key] = [];\n      return;\n    }\n    (state as any)[key] = value;\n  };\n\n  ensureArray(\"adjustments\");\n  ensureArray(\"oneOffs\");\n  ensureArray(\"incomeStreams\");\n\n  const sanitizeList = (list: unknown[]): Transaction[] =>\n    list\n      .map((item) => sanitizeOneOff(item, strict))\n      .filter((item): item is Transaction => item !== null);\n\n  state.oneOffs = sanitizeList(state.oneOffs as unknown[]);\n\n  state.incomeStreams = (state.incomeStreams as unknown[])\n    .map((entry) => sanitizeStream(entry, strict))\n    .filter((entry): entry is IncomeStream => entry !== null);\n\n  if (Array.isArray(rawObj.expenseStreams) && (rawObj.expenseStreams as unknown[]).length) {\n    const fallbackStart = state.settings.startDate;\n    const fallbackEnd = state.settings.endDate;\n    const mapped = (rawObj.expenseStreams as unknown[])\n      .map((stream): Transaction | null => {\n        if (!stream || typeof stream !== \"object\" || Array.isArray(stream)) {\n          if (strict) throw new Error(\"Invalid legacy expense stream\");\n          return null;\n        }\n        const streamObj = stream as Record<string, unknown>;\n        const candidate = {\n          ...streamObj,\n          id: typeof streamObj.id === \"string\" ? streamObj.id : uid(),\n          type: \"expense\",\n          recurring: true,\n          date: typeof streamObj.startDate === \"string\" ? streamObj.startDate : streamObj.onDate,\n          startDate: typeof streamObj.startDate === \"string\" ? streamObj.startDate : fallbackStart,\n          endDate: typeof streamObj.endDate === \"string\" ? streamObj.endDate : fallbackEnd,\n        };\n        return sanitizeOneOff(candidate, strict);\n      })\n      .filter((item): item is Transaction => item !== null);\n    if (mapped.length) {\n      state.oneOffs = [...state.oneOffs, ...mapped];\n    }\n  }\n\n  delete (state as any).expenseStreams;\n\n  if (typeof state.settings.startDate !== \"string\") {\n    if (strict) throw new Error(\"Invalid settings.startDate\");\n    state.settings.startDate = base.settings.startDate;\n  }\n  if (typeof state.settings.endDate !== \"string\") {\n    if (strict) throw new Error(\"Invalid settings.endDate\");\n    state.settings.endDate = base.settings.endDate;\n  }\n  if (!isValidYMDString(state.settings.startDate)) {\n    if (strict) throw new Error(\"Invalid settings.startDate format\");\n    state.settings.startDate = base.settings.startDate;\n  }\n  if (!isValidYMDString(state.settings.endDate)) {\n    if (strict) throw new Error(\"Invalid settings.endDate format\");\n    state.settings.endDate = base.settings.endDate;\n  }\n  if (compareYMD(state.settings.startDate, state.settings.endDate) > 0) {\n    if (strict) throw new Error(\"Invalid settings date range\");\n    state.settings.endDate = state.settings.startDate;\n  }\n  const sb = Number(state.settings.startingBalance);\n  if (Number.isFinite(sb)) {\n    state.settings.startingBalance = sb;\n  } else {\n    if (strict) throw new Error(\"Invalid settings.startingBalance\");\n    state.settings.startingBalance = base.settings.startingBalance;\n  }\n\n  return state;\n};\n\n/**\n * Clone state suitable for sandbox usage (What-If scenarios).\n */\nexport const cloneStateForSandbox = (src: AppState): AppState => {\n  try {\n    return normalizeState(deepClone(src) ?? {}, { strict: false });\n  } catch {\n    return normalizeState(defaultState(), { strict: false });\n  }\n};\n\n/**\n * Sanitize What-If scenario persistence payloads.\n */\nexport const sanitizeWhatIfState = (\n  raw: unknown,\n  fallbackBase: AppState = defaultState()\n): WhatIfState => {\n  const fallback = cloneStateForSandbox(fallbackBase);\n  const rawObj = raw && typeof raw === \"object\" ? (raw as Record<string, unknown>) : null;\n  const baseRaw = rawObj ? rawObj.base : null;\n  const base = baseRaw ? cloneStateForSandbox(baseRaw as AppState) : fallback;\n\n  if (!Array.isArray(base.incomeStreams)) base.incomeStreams = [];\n\n  const baseSettings = base.settings || fallback.settings || defaultState().settings;\n  const tweaksRaw = rawObj && typeof rawObj.tweaks === \"object\"\n    ? (rawObj.tweaks as Record<string, unknown>)\n    : {};\n\n  const globalRaw = tweaksRaw.global && typeof tweaksRaw.global === \"object\"\n    ? (tweaksRaw.global as Record<string, unknown>)\n    : {};\n  const global: GlobalTweak = {\n    pct: clampPercent(globalRaw.pct as number, { min: -1, max: 2, fallback: 0 }),\n    delta: clampCurrency(globalRaw.delta as number, 0),\n    lastEdited: [\"pct\", \"delta\", \"effective\"].includes(globalRaw.lastEdited as string)\n      ? (globalRaw.lastEdited as \"pct\" | \"delta\" | \"effective\")\n      : \"pct\",\n  };\n\n  const streamsRaw = tweaksRaw.streams && typeof tweaksRaw.streams === \"object\"\n    ? (tweaksRaw.streams as Record<string, unknown>)\n    : {};\n  const streams: Record<string, StreamTweak> = {};\n  for (const stream of base.incomeStreams) {\n    if (!stream || typeof stream !== \"object\") continue;\n    if (typeof stream.id !== \"string\") stream.id = uid();\n    const streamId = stream.id;\n    const rawEntry = streamsRaw && typeof streamsRaw[streamId] === \"object\"\n      ? (streamsRaw[streamId] as Record<string, unknown>)\n      : {};\n    const pct = clampPercent(rawEntry.pct as number, { min: -1, max: 2, fallback: 0 });\n    const delta = clampCurrency(rawEntry.delta as number, 0);\n    const effective = Number.isFinite(Number(rawEntry.effective))\n      ? round2(Number(rawEntry.effective))\n      : null;\n    const weeklyTarget = Number.isFinite(Number(rawEntry.weeklyTarget))\n      ? round2(Number(rawEntry.weeklyTarget))\n      : null;\n    const lastEdited = [\"pct\", \"delta\", \"effective\", \"weekly\"].includes(rawEntry.lastEdited as string)\n      ? (rawEntry.lastEdited as \"pct\" | \"delta\" | \"effective\" | \"weekly\")\n      : \"pct\";\n    streams[streamId] = { pct, delta, effective, weeklyTarget, lastEdited };\n  }\n\n  const startDate = isValidYMDString(tweaksRaw.startDate)\n    ? tweaksRaw.startDate\n    : baseSettings.startDate;\n  let endDate = isValidYMDString(tweaksRaw.endDate)\n    ? tweaksRaw.endDate\n    : baseSettings.endDate;\n  if (compareYMD(startDate, endDate) > 0) endDate = startDate;\n\n  const saleRaw = tweaksRaw.sale && typeof tweaksRaw.sale === \"object\"\n    ? (tweaksRaw.sale as Record<string, unknown>)\n    : {};\n  const legacyStart = isValidYMDString(saleRaw.startDate) ? saleRaw.startDate : startDate;\n  let legacyEnd = isValidYMDString(saleRaw.endDate) ? saleRaw.endDate : legacyStart;\n  if (compareYMD(legacyStart, legacyEnd) > 0) legacyEnd = legacyStart;\n  const saleEntriesRaw = Array.isArray(saleRaw.entries) ? saleRaw.entries : null;\n  const legacyEntryNeeded =\n    !saleEntriesRaw &&\n    (saleRaw.startDate || saleRaw.endDate || saleRaw.pct || saleRaw.topup || saleRaw.businessDaysOnly);\n  const combinedEntries =\n    saleEntriesRaw || (legacyEntryNeeded ? [{ ...saleRaw, startDate: legacyStart, endDate: legacyEnd }] : []);\n  const saleEntries = [];\n  for (const rawEntry of combinedEntries) {\n    if (!rawEntry || typeof rawEntry !== \"object\") continue;\n    const entry = { ...rawEntry } as Record<string, unknown>;\n    const entryStart = isValidYMDString(entry.startDate) ? entry.startDate : legacyStart;\n    let entryEnd = isValidYMDString(entry.endDate) ? entry.endDate : entryStart;\n    if (compareYMD(entryStart, entryEnd) > 0) entryEnd = entryStart;\n    const entryPct = clampPercent(entry.pct as number, { min: -1, max: 5, fallback: 0 });\n    const entryTopup = clampCurrency(entry.topup as number, 0);\n    const entryLastEdited: \"pct\" | \"topup\" = entry.lastEdited === \"topup\" ? \"topup\" : \"pct\";\n    const id = typeof entry.id === \"string\" ? entry.id : uid();\n    const name = typeof entry.name === \"string\" ? entry.name.trim().slice(0, 120) : \"\";\n    saleEntries.push({\n      id,\n      name,\n      pct: entryPct,\n      topup: entryTopup,\n      startDate: entryStart,\n      endDate: entryEnd,\n      businessDaysOnly: Boolean(entry.businessDaysOnly),\n      lastEdited: entryLastEdited,\n    });\n  }\n  const sale: SaleConfig = {\n    enabled: Boolean(saleRaw.enabled),\n    entries: saleEntries,\n  };\n\n  return {\n    base,\n    tweaks: {\n      global,\n      streams,\n      sale,\n      startDate,\n      endDate,\n    },\n  };\n};\n\n/**\n * Provide default Accounts Receivable options.\n */\nexport const defaultAROptions = (): AROptions => ({\n  roll: \"forward\",\n  lag: 0,\n  conf: 100,\n  category: \"AR\",\n  prune: false\n});\n\n/**\n * Provide default AR mapping overrides.\n */\nexport const defaultARMappingOverrides = (): ARMappingOverrides => ({\n  company: \"\",\n  invoice: \"\",\n  due: \"\",\n  amount: \"\"\n});\n\n/**\n * Sanitize Accounts Receivable options payloads.\n */\nexport const sanitizeAROptions = (value: unknown): AROptions => {\n  const defaults = defaultAROptions();\n  if (!value || typeof value !== \"object\") return { ...defaults };\n  const obj = value as Record<string, unknown>;\n  const roll = [\"forward\", \"back\", \"none\"].includes(obj.roll as string)\n    ? (obj.roll as \"forward\" | \"back\" | \"none\")\n    : defaults.roll;\n  const lagValue = Number(obj.lag);\n  const lag = Number.isFinite(lagValue) ? Math.max(0, Math.trunc(lagValue)) : defaults.lag;\n  const confValue = Number(obj.conf);\n  const conf = Number.isFinite(confValue) ? clamp(confValue, 0, 100) : defaults.conf;\n  const category = String(obj.category ?? defaults.category).trim() || defaults.category;\n  const prune = Boolean(obj.prune);\n  return { roll, lag, conf, category, prune };\n};\n\n/**\n * Sanitize Accounts Receivable mapping overrides.\n */\nexport const sanitizeARMapping = (value: unknown): ARMappingOverrides => {\n  const defaults = defaultARMappingOverrides();\n  if (!value || typeof value !== \"object\") return { ...defaults };\n  const obj = value as Record<string, unknown>;\n  const result = { ...defaults };\n  for (const key of Object.keys(defaults) as (keyof ARMappingOverrides)[]) {\n    if (obj[key]) {\n      result[key] = String(obj[key]);\n    }\n  }\n  return result;\n};\n","import {\n  defaultState,\n  normalizeState,\n  sanitizeWhatIfState,\n  defaultAROptions,\n  defaultARMappingOverrides,\n  sanitizeAROptions,\n  sanitizeARMapping,\n} from \"./validation\";\nimport type { AppState, WhatIfState, ARPreferences } from \"../types\";\n\nexport const STORAGE_KEY = \"cashflow2025_v1\";\nexport const WHATIF_STORAGE_KEY = \"cashflow2025_whatif_v1\";\nexport const AR_PREFS_STORAGE_KEY = \"cashflow2025_arPrefs_v1\";\n\n/**\n * Load the persisted primary application state from localStorage.\n */\nexport const loadState = (): AppState => {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (!raw) return defaultState();\n    const data = JSON.parse(raw);\n    return normalizeState(data, { strict: false });\n  } catch {\n    return defaultState();\n  }\n};\n\n/**\n * Persist the primary application state to localStorage.\n */\nexport const saveState = (state: AppState): void => {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n};\n\n/**\n * Load the What-If sandbox state from localStorage.\n */\nexport const loadWhatIfState = (fallbackBase?: AppState): WhatIfState => {\n  const fallback = fallbackBase || defaultState();\n  try {\n    const raw = localStorage.getItem(WHATIF_STORAGE_KEY);\n    if (!raw) return sanitizeWhatIfState({ base: fallback }, fallback);\n    const data = JSON.parse(raw);\n    return sanitizeWhatIfState(data, fallback);\n  } catch {\n    return sanitizeWhatIfState({ base: fallback }, fallback);\n  }\n};\n\n/**\n * Persist the What-If sandbox state to localStorage.\n */\nexport const saveWhatIfState = (sandbox: WhatIfState): void => {\n  localStorage.setItem(WHATIF_STORAGE_KEY, JSON.stringify(sandbox));\n};\n\n/**\n * Load Accounts Receivable preferences from localStorage.\n */\nexport const loadARPreferences = (): ARPreferences => {\n  try {\n    const raw = localStorage.getItem(AR_PREFS_STORAGE_KEY);\n    if (!raw) {\n      return { options: defaultAROptions(), mapping: defaultARMappingOverrides() };\n    }\n    const parsed = JSON.parse(raw);\n    return {\n      options: sanitizeAROptions(parsed.options),\n      mapping: sanitizeARMapping(parsed.mapping),\n    };\n  } catch {\n    return { options: defaultAROptions(), mapping: defaultARMappingOverrides() };\n  }\n};\n\n/**\n * Persist Accounts Receivable preferences to localStorage.\n */\nexport const saveARPreferences = (state?: any): void => {\n  if (!state || typeof state !== \"object\") return;\n  const options = state.options || {};\n  const mapping = state.mappingOverrides || state.mapping || {};\n  try {\n    const payload = {\n      options: {\n        roll: options.roll,\n        lag: options.lag,\n        conf: options.conf,\n        category: options.category,\n        prune: options.prune,\n      },\n      mapping: { ...mapping },\n    };\n    localStorage.setItem(AR_PREFS_STORAGE_KEY, JSON.stringify(payload));\n  } catch {\n    // ignore storage failures\n  }\n};\n","/**\n * Zustand store for application state management\n */\n\nimport { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport type { AppState, Settings, Adjustment, Transaction, IncomeStream, OneOffSortState } from '../types';\nimport { loadState, saveState } from '../modules/storage';\n\ninterface AppStore extends AppState {\n  // Actions for settings\n  updateSettings: (settings: Partial<Settings>) => void;\n\n  // Actions for adjustments\n  addAdjustment: (adjustment: Adjustment) => void;\n  removeAdjustment: (date: string) => void;\n\n  // Actions for one-offs\n  addOneOff: (transaction: Transaction) => void;\n  updateOneOff: (id: string, transaction: Transaction) => void;\n  removeOneOff: (id: string) => void;\n  setOneOffs: (oneOffs: Transaction[]) => void;\n\n  // Actions for income streams\n  addIncomeStream: (stream: IncomeStream) => void;\n  updateIncomeStream: (id: string, stream: IncomeStream) => void;\n  removeIncomeStream: (id: string) => void;\n  setIncomeStreams: (streams: IncomeStream[]) => void;\n\n  // Actions for UI state\n  setOneOffSort: (sort: OneOffSortState) => void;\n\n  // Global actions\n  importData: (data: Partial<AppState>) => void;\n  resetToDefaults: () => void;\n}\n\n// Default state\nconst getDefaultState = (): AppState => {\n  const today = new Date().toISOString().slice(0, 10);\n  const endOfYear = new Date(new Date().getFullYear(), 11, 31).toISOString().slice(0, 10);\n\n  return {\n    settings: {\n      startDate: today,\n      endDate: endOfYear,\n      startingBalance: 0,\n    },\n    adjustments: [],\n    oneOffs: [],\n    incomeStreams: [],\n    ui: {\n      oneOffSort: {\n        key: 'date',\n        direction: 'asc',\n      },\n    },\n  };\n};\n\n// Try to load existing state or use defaults\nconst getInitialState = (): AppState => {\n  try {\n    const loaded = loadState();\n    if (loaded) {\n      return {\n        ...getDefaultState(),\n        ...loaded,\n      };\n    }\n  } catch (err) {\n    console.warn('Failed to load state from storage:', err);\n  }\n  return getDefaultState();\n};\n\nexport const useAppStore = create<AppStore>()(\n  persist(\n    (set) => ({\n      ...getInitialState(),\n\n      // Settings actions\n      updateSettings: (settings) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            settings: { ...state.settings, ...settings },\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      // Adjustment actions\n      addAdjustment: (adjustment) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            adjustments: [...state.adjustments, adjustment],\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      removeAdjustment: (date) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            adjustments: state.adjustments.filter((adj) => adj.date !== date),\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      // One-off actions\n      addOneOff: (transaction) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            oneOffs: [...state.oneOffs, transaction],\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      updateOneOff: (id, transaction) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            oneOffs: state.oneOffs.map((t) => (t.id === id ? transaction : t)),\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      removeOneOff: (id) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            oneOffs: state.oneOffs.filter((t) => t.id !== id),\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      setOneOffs: (oneOffs) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            oneOffs,\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      // Income stream actions\n      addIncomeStream: (stream) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            incomeStreams: [...state.incomeStreams, stream],\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      updateIncomeStream: (id, stream) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            incomeStreams: state.incomeStreams.map((s) => (s.id === id ? stream : s)),\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      removeIncomeStream: (id) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            incomeStreams: state.incomeStreams.filter((s) => s.id !== id),\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      setIncomeStreams: (streams) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            incomeStreams: streams,\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      // UI actions\n      setOneOffSort: (sort) => {\n        set((state) => ({\n          ...state,\n          ui: { ...state.ui, oneOffSort: sort },\n        }));\n      },\n\n      // Global actions\n      importData: (data) => {\n        set((state) => {\n          const newState = {\n            ...state,\n            ...data,\n          };\n          saveState(newState);\n          return newState;\n        });\n      },\n\n      resetToDefaults: () => {\n        const defaultState = getDefaultState();\n        set(defaultState);\n        saveState(defaultState);\n      },\n    }),\n    {\n      name: 'cashflow-tracker-storage',\n    }\n  )\n);\n","/**\n * Layout component - Header, Navigation Tabs, and Footer\n */\n\ninterface LayoutProps {\n  children: React.ReactNode;\n  onExportJSON: () => void;\n  onImportJSON: () => void;\n  onExportPDF: () => void;\n  onExportSnapshotPDF: () => void;\n}\n\nexport type TabId = 'dashboard' | 'whatif' | 'movements' | 'income' | 'receivables';\n\nexport function Layout({ children, onExportJSON, onImportJSON, onExportPDF, onExportSnapshotPDF }: LayoutProps) {\n  return (\n    <div className=\"app-shell\">\n      <header className=\"app-header\">\n        <h1>2025 Cash Flow</h1>\n        <div className=\"header-actions\">\n          <button onClick={onExportJSON} className=\"btn\">\n            Export JSON\n          </button>\n          <button onClick={onExportPDF} className=\"btn\">\n            Next 30 Days PDF\n          </button>\n          <button onClick={onExportSnapshotPDF} className=\"btn\">\n            Cash Flow Snapshot PDF\n          </button>\n          <button onClick={onImportJSON} className=\"btn btn-outline\">\n            Import JSON\n          </button>\n        </div>\n      </header>\n\n      {children}\n\n      <footer className=\"app-footer\">\n        <small>All data is stored locally in your browser. </small>\n      </footer>\n    </div>\n  );\n}\n\ninterface TabNavigationProps {\n  activeTab: TabId;\n  onTabChange: (tab: TabId) => void;\n}\n\nexport function TabNavigation({ activeTab, onTabChange }: TabNavigationProps) {\n  const tabs: { id: TabId; label: string }[] = [\n    { id: 'dashboard', label: 'Dashboard' },\n    { id: 'whatif', label: 'What-If' },\n    { id: 'movements', label: 'Cash Movements' },\n    { id: 'income', label: 'Income Plan' },\n    { id: 'receivables', label: 'Receivables (AR)' },\n  ];\n\n  return (\n    <nav className=\"tabs\">\n      {tabs.map((tab) => (\n        <button\n          key={tab.id}\n          className={`tab ${activeTab === tab.id ? 'active' : ''}`}\n          onClick={() => onTabChange(tab.id)}\n          data-tab={tab.id}\n        >\n          {tab.label}\n        </button>\n      ))}\n    </nav>\n  );\n}\n","\"use strict\";\n\nimport { compareYMD, fromYMD, monthsBetween, toYMD } from \"./dateUtils\";\nimport {\n  clamp,\n  sanitizeOneOff,\n  sanitizeStream,\n  sanitizeSteps,\n  isValidYMDString,\n} from \"./validation\";\nimport type {\n  YMDString,\n  NthWeek,\n  IncomeStream,\n  Transaction,\n  Step,\n} from \"../types\";\n\n/**\n * Normalize arbitrary weekday input into a sorted array of unique indices.\n */\nexport const toWeekdayArray = (value: unknown): number[] => {\n  if (value === undefined || value === null) return [];\n\n  const raw = Array.isArray(value)\n    ? value\n    : typeof value === \"string\" && value.includes(\",\")\n    ? value.split(/[\\s,]+/)\n    : [value];\n\n  const seen = new Set<number>();\n  const days: number[] = [];\n  for (const item of raw) {\n    if (item === undefined || item === null) continue;\n    const str = String(item).trim();\n    if (!str) continue;\n    const num = Number(str);\n    if (!Number.isFinite(num)) continue;\n    const normalized = clamp(Math.trunc(num), 0, 6);\n    if (!seen.has(normalized)) {\n      seen.add(normalized);\n      days.push(normalized);\n    }\n  }\n\n  return days.sort((a, b) => a - b);\n};\n\n/**\n * Normalize the Nth qualifier for monthly weekday recurrences.\n */\nexport const normalizeNth = (value: unknown): NthWeek => {\n  if (value === null || value === undefined) return \"1\";\n  if (typeof value === \"string\") {\n    const trimmed = value.trim().toLowerCase();\n    if (trimmed === \"last\") return \"last\";\n    const parsed = Number.parseInt(trimmed, 10);\n    if (Number.isFinite(parsed) && parsed >= 1 && parsed <= 5) return String(parsed) as NthWeek;\n  }\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    const int = Math.trunc(value);\n    if (int >= 1 && int <= 5) return String(int) as NthWeek;\n  }\n  return \"1\";\n};\n\n/**\n * Resolve the first weekday to use when selecting from an arbitrary input.\n */\nexport const firstWeekday = (value: unknown, fallback: number = 0): number => {\n  const days = toWeekdayArray(value);\n  if (days.length) return days[0];\n  const num = Number(value);\n  if (Number.isFinite(num)) return clamp(Math.trunc(num), 0, 6);\n  return clamp(Number(fallback) || 0, 0, 6);\n};\n\n/**\n * Determine whether the supplied date falls within an inclusive range.\n */\nconst isBetween = (date: Date, start: Date, end: Date): boolean =>\n  date >= start && date <= end;\n\n/**\n * Determine whether a monthly recurrence matches a specific date.\n */\nexport const matchesMonthlyByDay = (date: Date, dayOfMonth: number): boolean => {\n  const lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n  const target = clamp(dayOfMonth, 1, lastDay);\n  return date.getDate() === target;\n};\n\n/**\n * Determine whether a date falls on the nth weekday of the month.\n */\nexport const matchesMonthlyByNthWeekday = (\n  date: Date,\n  nth: unknown,\n  weekday: unknown\n): boolean => {\n  const nthValue = normalizeNth(nth);\n  const targetDow = firstWeekday(weekday, 0);\n  const firstOfMonth = new Date(date.getFullYear(), date.getMonth(), 1);\n  const firstDow = firstOfMonth.getDay();\n  const firstOccurrenceDay = 1 + ((targetDow - firstDow + 7) % 7);\n\n  const occurrences: number[] = [];\n  const lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\n  for (let i = 0; i < 6; i += 1) {\n    const day = firstOccurrenceDay + i * 7;\n    if (day > lastDay) break;\n    occurrences.push(day);\n  }\n  if (!occurrences.length) return false;\n\n  if (nthValue === \"last\") {\n    return date.getDate() === occurrences[occurrences.length - 1];\n  }\n  const idx = Number(nthValue) - 1;\n  if (!Number.isFinite(idx) || idx < 0) return false;\n  if (idx >= occurrences.length) return false;\n  return date.getDate() === occurrences[idx];\n};\n\n/**\n * Determine if a weekly recurrence matches the provided date.\n */\nexport const matchesWeekly = (date: Date, weekdays: unknown): boolean => {\n  const days = toWeekdayArray(weekdays);\n  if (!days.length) return false;\n  return days.includes(date.getDay());\n};\n\n/**\n * Determine if a biweekly recurrence matches the provided date.\n */\nexport const matchesBiweekly = (\n  date: Date,\n  weekdays: unknown,\n  anchor: Date\n): boolean => {\n  const days = toWeekdayArray(weekdays);\n  if (!days.length) return false;\n  return days.some((dow) => {\n    if (date.getDay() !== dow) return false;\n    const start = new Date(anchor.getTime());\n    const deltaToDow = (dow - start.getDay() + 7) % 7;\n    start.setDate(start.getDate() + deltaToDow);\n    if (date < start) return false;\n    const diffDays = Math.floor((date.getTime() - start.getTime()) / (1000 * 60 * 60 * 24));\n    return diffDays % 14 === 0;\n  });\n};\n\n/**\n * Determine if a recurring stream should fire on the supplied date.\n */\nexport const shouldApplyStreamOn = (date: Date, stream: any): boolean => {\n  if (!stream || typeof stream !== \"object\") return false;\n  const start = fromYMD(stream.startDate);\n  const end = fromYMD(stream.endDate);\n  if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime())) return false;\n  if (!isBetween(date, start, end)) return false;\n\n  switch (stream.frequency) {\n    case \"once\":\n      return Boolean(stream.onDate && toYMD(date) === stream.onDate);\n    case \"daily\":\n      if (stream.skipWeekends && (date.getDay() === 0 || date.getDay() === 6)) return false;\n      return true;\n    case \"weekly\":\n      return matchesWeekly(date, stream.dayOfWeek);\n    case \"biweekly\":\n      return matchesBiweekly(date, stream.dayOfWeek, start);\n    case \"monthly\":\n      if (stream.monthlyMode === \"nth\") {\n        return matchesMonthlyByNthWeekday(date, stream.nthWeek, stream.nthWeekday);\n      }\n      return matchesMonthlyByDay(date, Number(stream.dayOfMonth || 1));\n    default:\n      return false;\n  }\n};\n\n/**\n * Determine if a transaction (one-off or recurring) should apply on a date.\n */\nexport const shouldApplyTransactionOn = (date: Date, transaction: any): boolean => {\n  if (!transaction || typeof transaction !== \"object\") return false;\n  if (!transaction.recurring && !transaction.frequency) {\n    return typeof transaction.date === \"string\" && toYMD(date) === transaction.date;\n  }\n\n  if (!transaction.frequency || !transaction.startDate || !transaction.endDate) return false;\n\n  const shim: any = {\n    frequency: transaction.frequency,\n    startDate: transaction.startDate,\n    endDate: transaction.endDate,\n    onDate: transaction.onDate || null,\n    skipWeekends: Boolean(transaction.skipWeekends),\n    dayOfWeek: toWeekdayArray(transaction.dayOfWeek),\n    dayOfMonth: Number(transaction.dayOfMonth ?? 1),\n    monthlyMode: transaction.monthlyMode === \"nth\" ? \"nth\" : \"day\",\n    nthWeek: normalizeNth(transaction.nthWeek),\n    nthWeekday: firstWeekday(transaction.nthWeekday ?? transaction.dayOfWeek ?? 0, 0),\n  };\n\n  return shouldApplyStreamOn(date, shim);\n};\n\ninterface RecurringEntry {\n  amount?: number;\n  steps?: Step[];\n}\n\n/**\n * Calculate the base amount for a recurring entry on a given date.\n */\nexport const getBaseAmountForDate = (entry: RecurringEntry, date: Date): number => {\n  const base = Number(entry?.amount || 0);\n  if (!Array.isArray(entry?.steps) || entry.steps.length === 0) {\n    return Math.abs(base) || 0;\n  }\n  const target = toYMD(date);\n  let current = Math.abs(base) || 0;\n  for (const step of entry.steps) {\n    const effectiveFrom = typeof step?.effectiveFrom === \"string\" ? step.effectiveFrom : null;\n    if (!effectiveFrom || compareYMD(effectiveFrom, target) > 0) break;\n    const nextAmount = Number(step.amount || 0);\n    if (!Number.isFinite(nextAmount)) continue;\n    current = Math.abs(nextAmount);\n  }\n  return current;\n};\n\ninterface EscalatorEntry extends RecurringEntry {\n  escalatorPct?: number;\n}\n\n/**\n * Resolve the amount for a recurring entry considering escalators.\n */\nexport const resolveRecurringAmount = (\n  entry: EscalatorEntry,\n  date: Date,\n  prevDate: Date | null\n): number => {\n  const baseAmount = Math.abs(Number(getBaseAmountForDate(entry, date) || 0));\n  if (!baseAmount) return 0;\n  const escalatorPct = Number(entry?.escalatorPct || 0);\n  if (!prevDate || !Number.isFinite(escalatorPct) || escalatorPct === 0) {\n    return baseAmount;\n  }\n  const steps = monthsBetween(prevDate, date);\n  if (!steps) return baseAmount;\n  const factor = Math.pow(1 + escalatorPct / 100, steps);\n  return baseAmount * factor;\n};\n\n/**\n * Estimate the average weekly occurrences for a stream definition.\n */\nexport const estimateOccurrencesPerWeek = (stream: any): number => {\n  if (!stream || typeof stream !== \"object\") return 0;\n  switch (stream.frequency) {\n    case \"daily\":\n      return stream.skipWeekends ? 5 : 7;\n    case \"weekly\": {\n      const days = toWeekdayArray(stream.dayOfWeek);\n      return days.length || 1;\n    }\n    case \"biweekly\": {\n      const days = toWeekdayArray(stream.dayOfWeek);\n      return (days.length || 1) / 2;\n    }\n    case \"monthly\":\n      return 12 / 52;\n    case \"once\":\n    default:\n      return 0;\n  }\n};\n\ninterface OccurrenceResult {\n  date: YMDString;\n  amount: number;\n}\n\n/**\n * Determine the next occurrence for a transaction or stream relative to a base date.\n */\nexport const getNextOccurrence = (\n  entry: any,\n  fromDateYMD?: string\n): OccurrenceResult | null => {\n  if (!entry || typeof entry !== \"object\") return null;\n  const today = typeof fromDateYMD === \"string\" ? fromDateYMD : null;\n  const baseDateYMD = today || null;\n\n  const isRecurring = Boolean(entry.recurring || entry.frequency);\n\n  if (!isRecurring) {\n    const date = typeof entry.date === \"string\" ? entry.date : null;\n    if (!date || (baseDateYMD && compareYMD(date, baseDateYMD) < 0)) return null;\n    const amount = Math.abs(Number(entry.amount || 0));\n    if (!Number.isFinite(amount)) return null;\n    return { date, amount };\n  }\n\n  const startDate =\n    typeof entry.startDate === \"string\"\n      ? entry.startDate\n      : typeof entry.date === \"string\"\n      ? entry.date\n      : null;\n  const endDate =\n    typeof entry.endDate === \"string\"\n      ? entry.endDate\n      : typeof entry.date === \"string\"\n      ? entry.date\n      : null;\n\n  if (!startDate || !endDate) return null;\n  const start = fromYMD(startDate);\n  const end = fromYMD(endDate);\n  if (Number.isNaN(start.getTime()) || Number.isNaN(end.getTime()) || start > end) return null;\n\n  let previous: Date | null = null;\n  for (let cursor = new Date(start.getTime()); cursor <= end; cursor.setDate(cursor.getDate() + 1)) {\n    if (!shouldApplyStreamOn(cursor, entry)) continue;\n    const occurrenceYMD = toYMD(cursor);\n    if (baseDateYMD && compareYMD(occurrenceYMD, baseDateYMD) < 0) {\n      previous = new Date(cursor.getTime());\n      continue;\n    }\n    const amount = resolveRecurringAmount(entry, cursor, previous);\n    if (!amount) return null;\n    return { date: occurrenceYMD, amount: Math.abs(amount) };\n  }\n\n  return null;\n};\n\ninterface DescribableEntry {\n  name?: string;\n  category?: string;\n  note?: string;\n}\n\n/**\n * Describe a transaction by combining its identifying fields.\n */\nexport const describeNameAndCategory = (entry: DescribableEntry, fallback: string): string => {\n  if (!entry || typeof entry !== \"object\") return fallback;\n  const parts: string[] = [];\n  if (entry.name) parts.push(entry.name);\n  if (entry.category) parts.push(entry.category);\n  if (!parts.length && entry.note) parts.push(entry.note);\n  return parts.join(\"  \") || fallback;\n};\n\ninterface CreateOptions {\n  strict?: boolean;\n}\n\n/**\n * Create a sanitized one-off transaction.\n */\nexport const createOneOffTransaction = (\n  entry: unknown,\n  options: CreateOptions = {}\n): Transaction | null => {\n  const { strict = false } = options;\n  return sanitizeOneOff(entry, strict);\n};\n\n/**\n * Update a one-off transaction within a list.\n */\nexport const updateOneOffTransaction = (\n  list: Transaction[],\n  id: string,\n  updates: Partial<Transaction>,\n  options: CreateOptions = {}\n): Transaction[] => {\n  const { strict = false } = options;\n  if (!Array.isArray(list)) return [];\n  return list.map((item) => {\n    if (!item || item.id !== id) return item;\n    const merged = { ...item, ...updates };\n    const sanitized = sanitizeOneOff(merged, strict);\n    return sanitized ?? item;\n  });\n};\n\n/**\n * Remove a one-off transaction from a list.\n */\nexport const deleteOneOffTransaction = (list: Transaction[], id: string): Transaction[] => {\n  if (!Array.isArray(list)) return [];\n  return list.filter((item) => item && item.id !== id);\n};\n\n/**\n * Create a sanitized recurring income stream.\n */\nexport const createIncomeStream = (\n  entry: unknown,\n  options: CreateOptions = {}\n): IncomeStream | null => {\n  const { strict = false } = options;\n  return sanitizeStream(entry, strict);\n};\n\n/**\n * Update an income stream within a list.\n */\nexport const updateIncomeStream = (\n  list: IncomeStream[],\n  id: string,\n  updates: Partial<IncomeStream>,\n  options: CreateOptions = {}\n): IncomeStream[] => {\n  const { strict = false } = options;\n  if (!Array.isArray(list)) return [];\n  return list.map((item) => {\n    if (!item || item.id !== id) return item;\n    const merged = { ...item, ...updates };\n    const sanitized = sanitizeStream(merged, strict);\n    return sanitized ?? item;\n  });\n};\n\n/**\n * Remove an income stream from a list.\n */\nexport const deleteIncomeStream = (list: IncomeStream[], id: string): IncomeStream[] => {\n  if (!Array.isArray(list)) return [];\n  return list.filter((item) => item && item.id !== id);\n};\n\n/**\n * Ensure a recurring stream definition contains sanitized step adjustments.\n */\nexport const normalizeStreamSteps = (stream: IncomeStream): IncomeStream => {\n  if (!stream || typeof stream !== \"object\") return stream;\n  const next = { ...stream };\n  next.steps = sanitizeSteps(stream.steps);\n  return next;\n};\n\ninterface RecurrenceWindow {\n  startDate?: string;\n  endDate?: string;\n}\n\n/**\n * Validate whether provided recurrence boundaries are sensible.\n */\nexport const hasValidRecurrenceWindow = (entry: RecurrenceWindow): boolean => {\n  if (!entry || typeof entry !== \"object\") return false;\n  const start = typeof entry.startDate === \"string\" ? entry.startDate : null;\n  const end = typeof entry.endDate === \"string\" ? entry.endDate : null;\n  if (!start || !end) return false;\n  if (!isValidYMDString(start) || !isValidYMDString(end)) return false;\n  return compareYMD(start, end) <= 0;\n};\n\n/**\n * Remove duplicate transactions based on a composite key\n */\nexport const deduplicateTransactions = (transactions: Transaction[]): Transaction[] => {\n  const seen = new Set<string>();\n  return transactions.filter((tx) => {\n    const key = tx.recurring\n      ? `${tx.name}|${tx.category}|${tx.amount}|${tx.startDate}|${tx.endDate}`\n      : `${tx.name}|${tx.category}|${tx.amount}|${tx.date}`;\n    if (seen.has(key)) return false;\n    seen.add(key);\n    return true;\n  });\n};\n","\"use strict\";\n\nimport { compareYMD, fromYMD, toYMD } from \"./dateUtils\";\nimport { clampCurrency, clampPercent, isValidYMDString } from \"./validation\";\nimport {\n  describeNameAndCategory,\n  resolveRecurringAmount,\n  shouldApplyStreamOn,\n} from \"./transactions\";\nimport type {\n  AppState,\n  CalendarRow,\n  ProjectionOverrides,\n  ProjectionResult,\n  Transaction,\n  YMDString,\n} from \"../types\";\n\n/**\n * Format a numeric value into a currency string.\n * @param value - Numeric value to format.\n * @returns Formatted currency string (e.g. $1,234.00).\n */\nexport const fmtMoney = (value: number): string =>\n  (value < 0 ? \"-$\" : \"$\") +\n  Math.abs(Number(value) || 0).toLocaleString(undefined, {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  });\n\n/**\n * Parse loose currency inputs into a numeric value.\n * @param value - Raw input value.\n * @returns Parsed numeric value or NaN when parsing fails.\n */\nexport const parseMoney = (value: unknown): number => {\n  if (value === null || value === undefined || value === \"\") return NaN;\n  if (typeof value === \"number\") {\n    return Number.isFinite(value) ? value : NaN;\n  }\n\n  let str = String(value).trim();\n  if (!str) return NaN;\n\n  let negative = false;\n  if (/^\\((.*)\\)$/.test(str)) {\n    negative = true;\n    str = str.slice(1, -1);\n  }\n  str = str.replace(/[]/g, \"-\");\n  if (str.endsWith(\"-\")) {\n    negative = true;\n    str = str.slice(0, -1);\n  }\n  if (str.startsWith(\"-\")) {\n    negative = true;\n    str = str.slice(1);\n  }\n\n  str = str.replace(/[^0-9.,]/g, \"\");\n  if (!str) return NaN;\n\n  const hasComma = str.includes(\",\");\n  const hasDot = str.includes(\".\");\n  if (hasComma && hasDot) {\n    if (str.lastIndexOf(\",\") > str.lastIndexOf(\".\")) {\n      str = str.replace(/\\./g, \"\");\n      str = str.replace(/,/g, \".\");\n    } else {\n      str = str.replace(/,/g, \"\");\n    }\n  } else if (hasComma) {\n    const parts = str.split(\",\");\n    if (parts.length > 1 && parts[parts.length - 1].length === 2) {\n      str = `${parts.slice(0, -1).join(\"\")}.${parts[parts.length - 1]}`;\n    } else {\n      str = parts.join(\"\");\n    }\n  } else {\n    str = str.replace(/,/g, \"\");\n  }\n\n  const num = Number(str);\n  if (!Number.isFinite(num)) return NaN;\n  return negative ? -num : num;\n};\n\n/**\n * Round a number to two decimal places.\n * @param value - Numeric value to round.\n * @returns Rounded value.\n */\nexport const round2 = (value: number): number => {\n  const num = Number(value);\n  if (!Number.isFinite(num)) return 0;\n  return Math.round(num * 100) / 100;\n};\n\n/**\n * Compute the effective amount after applying percentage and delta adjustments.\n * @param base - Base amount.\n * @param pct - Percentage adjustment (e.g. 0.1 for +10%).\n * @param delta - Flat adjustment delta.\n * @returns Rounded effective amount.\n */\nexport const computeEffectiveAmount = (base: number, pct: number, delta: number): number => {\n  const b = Number(base || 0);\n  const p = Number(pct || 0);\n  const d = Number(delta || 0);\n  if (!Number.isFinite(b) || !Number.isFinite(p) || !Number.isFinite(d)) return 0;\n  return round2(b * (1 + p) + d);\n};\n\n/**\n * Resolve the percentage required to reach an effective amount.\n * @param base - Base amount.\n * @param effective - Target effective amount.\n * @param delta - Flat delta applied alongside the percentage.\n * @returns Calculated percentage (e.g. 0.1 for +10%).\n */\nexport const resolvePercentFromEffective = (\n  base: number,\n  effective: number,\n  delta: number = 0\n): number => {\n  const b = Number(base || 0);\n  if (!Number.isFinite(b) || b === 0) return 0;\n  const e = Number(effective || 0);\n  if (!Number.isFinite(e)) return 0;\n  const d = Number(delta || 0);\n  if (!Number.isFinite(d)) return 0;\n  return clampPercent((e - d) / b - 1);\n};\n\n/**\n * Generate calendar rows between two dates.\n * @param startYMD - Inclusive start date (YYYY-MM-DD).\n * @param endYMD - Inclusive end date (YYYY-MM-DD).\n * @returns Calendar rows seeded with zeroed totals.\n */\nexport const generateCalendar = (startYMD: YMDString, endYMD: YMDString): CalendarRow[] => {\n  const start = fromYMD(startYMD);\n  const end = fromYMD(endYMD);\n  const rows: CalendarRow[] = [];\n  for (let cursor = new Date(start); cursor <= end; cursor.setDate(cursor.getDate() + 1)) {\n    rows.push({\n      date: toYMD(cursor),\n      income: 0,\n      expenses: 0,\n      net: 0,\n      running: 0,\n      incomeDetails: [],\n      expenseDetails: [],\n    });\n  }\n  return rows;\n};\n\ninterface SaleEntryInternal {\n  id: string;\n  startDate: YMDString;\n  endDate: YMDString;\n  pct: number;\n  topup: number;\n  lastEdited: \"pct\" | \"topup\";\n  businessDaysOnly: boolean;\n}\n\n/**\n * Compute a cash-flow projection across the supplied state window.\n * @param state - Application state containing settings and transactions.\n * @param overrides - Optional overrides for multiplier/transform hooks.\n * @returns Projection summary including calendar rows and balance stats.\n */\nexport const computeProjection = (\n  state: AppState,\n  overrides: ProjectionOverrides = {}\n): ProjectionResult => {\n  const getStreamMultiplier =\n    typeof overrides.getStreamMultiplier === \"function\" ? overrides.getStreamMultiplier : () => 1;\n  const transformStreamAmount =\n    typeof overrides.transformStreamAmount === \"function\" ? overrides.transformStreamAmount : null;\n\n  const saleConfig = overrides.sale && typeof overrides.sale === \"object\" ? overrides.sale : null;\n  const saleEntries: SaleEntryInternal[] = [];\n  if (saleConfig && saleConfig.enabled && Array.isArray(saleConfig.entries)) {\n    for (const rawEntry of saleConfig.entries) {\n      if (!rawEntry || typeof rawEntry !== \"object\") continue;\n      const start = isValidYMDString(rawEntry.startDate) ? rawEntry.startDate : null;\n      if (!start) continue;\n      const rawEnd = isValidYMDString(rawEntry.endDate) ? rawEntry.endDate : start;\n      const pct = clampPercent(rawEntry.pct, { min: -1, max: 5, fallback: 0 });\n      const topup = clampCurrency(rawEntry.topup, 0);\n      const lastEdited = rawEntry.lastEdited === \"topup\" ? \"topup\" : \"pct\";\n      const end = compareYMD(start, rawEnd) > 0 ? start : rawEnd;\n      saleEntries.push({\n        id: rawEntry.id,\n        startDate: start,\n        endDate: end,\n        pct,\n        topup,\n        lastEdited,\n        businessDaysOnly: Boolean(rawEntry.businessDaysOnly),\n      });\n    }\n  }\n  const saleEnabled = saleEntries.length > 0;\n\n  const { settings, oneOffs = [], incomeStreams = [], adjustments = [] } = state || {};\n  if (!settings) {\n    throw new Error(\"State missing settings for projection\");\n  }\n  const calendar = generateCalendar(settings.startDate, settings.endDate);\n  const byDate = new Map(calendar.map((row) => [row.date, row]));\n\n  const recurring = oneOffs.filter(\n    (tx): tx is Transaction => tx && typeof tx === \"object\" && tx.recurring\n  );\n  const singles = oneOffs.filter(\n    (tx): tx is Transaction =>\n      tx &&\n      typeof tx === \"object\" &&\n      !tx.recurring &&\n      !(tx.source === \"AR\" && tx.status === \"archived\")\n  );\n\n  let totalStreamIncome = 0;\n\n  for (const tx of singles) {\n    if (!('date' in tx) || typeof tx.date !== 'string') continue;\n    const row = byDate.get(tx.date);\n    if (!row) continue;\n    const amount = Number(tx.amount || 0);\n    if (!amount) continue;\n    const absAmount = Math.abs(amount);\n    const label = describeNameAndCategory(tx, tx.type === \"expense\" ? \"Expense\" : \"Income\");\n    if (tx.type === \"expense\") {\n      row.expenses += absAmount;\n      row.expenseDetails.push({ source: label, amount: absAmount });\n    } else {\n      const signed = amount >= 0 ? absAmount : -absAmount;\n      row.income += signed;\n      row.incomeDetails.push({ source: label, amount: signed });\n    }\n  }\n\n  const incomeLastOccurrence = new Map<string, Date>();\n  incomeStreams.forEach((stream, index) => {\n    if (!stream || typeof stream !== \"object\") return;\n    const key = `stream:${typeof stream.id === \"string\" ? stream.id : index}`;\n    for (const row of calendar) {\n      const date = fromYMD(row.date);\n      if (!shouldApplyStreamOn(date, stream)) continue;\n      const prev = incomeLastOccurrence.get(key) || null;\n      const amount = resolveRecurringAmount(stream, date, prev);\n      if (amount) {\n        const absAmount = Math.abs(amount);\n        const label = describeNameAndCategory(stream, \"Income Stream\");\n        let adjustedAmount = absAmount;\n        if (transformStreamAmount) {\n          const transformed = Number(\n            transformStreamAmount({ stream, baseAmount: absAmount, date: row.date })\n          );\n          adjustedAmount = Number.isFinite(transformed) && transformed >= 0 ? round2(transformed) : 0;\n        } else {\n          const multiplierValue = Number(getStreamMultiplier(stream, absAmount, row.date));\n          const appliedMultiplier = Number.isFinite(multiplierValue) ? Math.max(0, multiplierValue) : 1;\n          adjustedAmount = round2(absAmount * appliedMultiplier);\n        }\n        if (adjustedAmount) {\n          row.income += adjustedAmount;\n          row.incomeDetails.push({ source: label, amount: adjustedAmount });\n          totalStreamIncome += adjustedAmount;\n        }\n      }\n      incomeLastOccurrence.set(key, new Date(date.getTime()));\n    }\n  });\n\n  const txLastOccurrence = new Map<string, Date>();\n  recurring.forEach((tx, index) => {\n    if (\n      !('startDate' in tx) || typeof tx.startDate !== \"string\" ||\n      !('endDate' in tx) || typeof tx.endDate !== \"string\" ||\n      !('frequency' in tx) || typeof tx.frequency !== \"string\"\n    ) {\n      return;\n    }\n    const key = `tx:${typeof tx.id === \"string\" ? tx.id : index}`;\n    for (const row of calendar) {\n      const date = fromYMD(row.date);\n      if (!shouldApplyStreamOn(date, tx)) continue;\n      const prev = txLastOccurrence.get(key) || null;\n      const amount = resolveRecurringAmount(tx, date, prev);\n      if (amount) {\n        const absAmount = Math.abs(amount);\n        const label = describeNameAndCategory(tx, tx.type === \"expense\" ? \"Expense\" : \"Income\");\n        if (tx.type === \"expense\") {\n          row.expenses += absAmount;\n          row.expenseDetails.push({ source: label, amount: absAmount });\n        } else {\n          row.income += absAmount;\n          row.incomeDetails.push({ source: label, amount: absAmount });\n        }\n      }\n      txLastOccurrence.set(key, new Date(date.getTime()));\n    }\n  });\n\n  adjustments.forEach((adj) => {\n    const row = byDate.get(adj?.date);\n    if (!row) return;\n    const amount = Number(adj.amount || 0);\n    const label = adj?.note ? `Adjustment  ${adj.note}` : \"Adjustment\";\n    if (amount >= 0) {\n      row.income += amount;\n      row.incomeDetails.push({ source: label, amount });\n    } else {\n      const absAmount = Math.abs(amount);\n      row.expenses += absAmount;\n      row.expenseDetails.push({ source: label, amount: absAmount });\n    }\n  });\n\n  let running = round2(Number(settings.startingBalance || 0));\n  let totalIncome = 0;\n  let totalExpenses = 0;\n  let lowestBalance = Number.isFinite(running) ? running : 0;\n  let lowestBalanceDate: YMDString = settings.startDate || (calendar.length ? calendar[0].date : \"\");\n  let peakBalance = lowestBalance;\n  let peakBalanceDate: YMDString = lowestBalanceDate;\n  let firstNegativeDate: YMDString | null = null;\n  let negativeDays = 0;\n\n  for (const row of calendar) {\n    const baseIncomeBeforeSales = row.income;\n    if (saleEnabled) {\n      const dow = fromYMD(row.date).getDay();\n      const isBusinessDay = dow >= 1 && dow <= 5;\n      for (const entry of saleEntries) {\n        if (compareYMD(row.date, entry.startDate) < 0) continue;\n        if (compareYMD(row.date, entry.endDate) > 0) continue;\n        if (entry.businessDaysOnly && !isBusinessDay) continue;\n        const windowLabel = entry.startDate\n          ? entry.endDate && entry.endDate !== entry.startDate\n            ? `${entry.startDate}${entry.endDate}`\n            : entry.startDate\n          : entry.endDate || \"\";\n        if (entry.lastEdited === \"topup\") {\n          const boost = round2(entry.topup);\n          if (boost) {\n            row.income += boost;\n            row.incomeDetails.push({\n              source: windowLabel ? `Sale top-up (${windowLabel})` : \"Sale top-up\",\n              amount: boost,\n            });\n          }\n        } else if (entry.pct > 0) {\n          const boost = round2(baseIncomeBeforeSales * entry.pct);\n          if (boost) {\n            row.income += boost;\n            row.incomeDetails.push({\n              source: windowLabel ? `Sale uplift (${windowLabel})` : \"Sale uplift\",\n              amount: boost,\n            });\n          }\n        }\n      }\n    }\n\n    row.income = round2(row.income);\n    row.expenses = round2(row.expenses);\n    row.net = round2(row.income - row.expenses);\n    running = round2(running + row.net);\n    row.running = running;\n    totalIncome += row.income;\n    totalExpenses += row.expenses;\n\n    if (row.running < lowestBalance) {\n      lowestBalance = row.running;\n      lowestBalanceDate = row.date;\n    }\n    if (row.running > peakBalance) {\n      peakBalance = row.running;\n      peakBalanceDate = row.date;\n    }\n    if (row.running < 0) {\n      negativeDays += 1;\n      if (!firstNegativeDate) firstNegativeDate = row.date;\n    }\n  }\n\n  let projectedWeeklyIncome = 0;\n  const startDate = fromYMD(settings.startDate);\n  const endDate = fromYMD(settings.endDate);\n  if (\n    startDate instanceof Date &&\n    endDate instanceof Date &&\n    !Number.isNaN(startDate.getTime()) &&\n    !Number.isNaN(endDate.getTime()) &&\n    endDate >= startDate\n  ) {\n    const MS_PER_DAY = 24 * 60 * 60 * 1000;\n    const totalDays = Math.floor((endDate.getTime() - startDate.getTime()) / MS_PER_DAY) + 1;\n    const totalWeeks = totalDays / 7;\n    if (totalWeeks > 0) {\n      projectedWeeklyIncome = totalStreamIncome / totalWeeks;\n    }\n  }\n\n  return {\n    cal: calendar,\n    totalIncome,\n    totalExpenses,\n    endBalance: running,\n    projectedWeeklyIncome,\n    lowestBalance,\n    lowestBalanceDate,\n    peakBalance,\n    peakBalanceDate,\n    firstNegativeDate,\n    negativeDays,\n  };\n};\n","/**\n * Chart rendering utilities for Cash Flow Tracker\n * Uses Chart.js for visualizations\n */\n\nimport type { ProjectionResult, YMDString } from '../types';\nimport { round2 } from '../modules/calculations';\nimport { compareYMD } from '../modules/dateUtils';\n\ndeclare const Chart: any;\n\n/**\n * Chart color configuration\n */\nconst lineColors = {\n  above: '#1b5e20',\n  below: '#b71c1c',\n};\n\n/**\n * Create segment color gradient for balance chart\n */\nfunction createSegmentColor(ctx: any): string | CanvasGradient {\n  const { chart, p0DataIndex, p1DataIndex } = ctx;\n  const meta = chart.getDatasetMeta(0);\n  if (!meta || !meta.data || !meta.data.length) return lineColors.above;\n\n  const point0 = meta.data[p0DataIndex];\n  const point1 = meta.data[p1DataIndex];\n  if (!point0 || !point1) return lineColors.above;\n\n  const y0 = typeof point0.parsed?.y === 'number' ? point0.parsed.y : 0;\n  const y1 = typeof point1.parsed?.y === 'number' ? point1.parsed.y : 0;\n\n  if ((y0 >= 0 && y1 >= 0) || (y0 < 0 && y1 < 0)) {\n    return y0 >= 0 ? lineColors.above : lineColors.below;\n  }\n\n  const canvas = chart.canvas;\n  if (!canvas || typeof canvas.getContext !== 'function') return lineColors.above;\n\n  const ctx2d = canvas.getContext('2d');\n  if (!ctx2d) return lineColors.above;\n\n  const gradient = ctx2d.createLinearGradient(point0.x, point0.y, point1.x, point1.y);\n  const ratio = Math.abs(y0) / (Math.abs(y0) + Math.abs(y1));\n  const startColor = y0 >= 0 ? lineColors.above : lineColors.below;\n  const endColor = y1 >= 0 ? lineColors.above : lineColors.below;\n  const midColor = y0 >= 0 ? lineColors.below : lineColors.above;\n\n  gradient.addColorStop(0, startColor);\n  gradient.addColorStop(Math.min(Math.max(ratio, 0), 1), startColor);\n  gradient.addColorStop(Math.min(Math.max(ratio, 0), 1), midColor);\n  gradient.addColorStop(1, endColor);\n\n  return gradient;\n}\n\n/**\n * Common chart options for balance charts\n */\nconst balanceChartOptions = {\n  interaction: { intersect: false, mode: 'index' as const },\n  plugins: { legend: { display: false } },\n  scales: {\n    x: { ticks: { maxTicksLimit: 10 } },\n    y: {\n      beginAtZero: false,\n      grid: {\n        color: (ctx: any) => {\n          const value = ctx.tick && typeof ctx.tick.value === 'number' ? ctx.tick.value : null;\n          return value === 0 ? '#0f172a' : 'rgba(148, 163, 184, 0.2)';\n        },\n        lineWidth: (ctx: any) => {\n          const value = ctx.tick && typeof ctx.tick.value === 'number' ? ctx.tick.value : null;\n          return value === 0 ? 2 : 1;\n        },\n      },\n    },\n  },\n};\n\n/**\n * Chart instance storage\n */\nlet balanceChartInstance: any = null;\nlet whatIfChartInstance: any = null;\n\n/**\n * Destroy existing chart if it exists\n */\nfunction destroyChart(chartInstance: any): void {\n  if (chartInstance && typeof chartInstance.destroy === 'function') {\n    chartInstance.destroy();\n  }\n}\n\n/**\n * Get or destroy existing Chart.js instance\n */\nfunction getExistingChart(canvas: HTMLCanvasElement): any {\n  const existingChart = typeof Chart?.getChart === 'function'\n    ? Chart.getChart(canvas)\n    : null;\n\n  if (existingChart && typeof existingChart.destroy === 'function') {\n    existingChart.destroy();\n  }\n\n  return null;\n}\n\n/**\n * Render the main balance chart showing projected balance over time\n */\nexport function renderBalanceChart(\n  canvas: HTMLCanvasElement,\n  projection: ProjectionResult\n): any {\n  // Destroy existing chart\n  destroyChart(balanceChartInstance);\n  getExistingChart(canvas);\n\n  const { cal } = projection;\n  if (!cal || !cal.length) {\n    balanceChartInstance = null;\n    return null;\n  }\n\n  const labels = cal.map((r) => r.date);\n  const data = cal.map((r) => round2(r.running));\n\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    balanceChartInstance = null;\n    return null;\n  }\n\n  balanceChartInstance = new Chart(ctx, {\n    type: 'line',\n    data: {\n      labels,\n      datasets: [\n        {\n          label: 'Projected Balance',\n          data,\n          tension: 0.25,\n          borderWidth: 2,\n          pointRadius: 0,\n          borderColor: lineColors.above,\n          segment: {\n            borderColor: createSegmentColor,\n          },\n          fill: {\n            target: { value: 0 },\n            above: 'rgba(27, 94, 32, 0.15)',\n            below: 'rgba(183, 28, 28, 0.18)',\n          },\n        },\n      ],\n    },\n    options: balanceChartOptions,\n  });\n\n  return balanceChartInstance;\n}\n\n/**\n * Render the What-If comparison chart showing actual vs scenario projections\n */\nexport function renderWhatIfChart(\n  canvas: HTMLCanvasElement,\n  actualProjection: ProjectionResult,\n  whatIfProjection: ProjectionResult\n): any {\n  // Destroy existing chart\n  destroyChart(whatIfChartInstance);\n  getExistingChart(canvas);\n\n  const actualMap = new Map<YMDString, number>();\n  const sandboxMap = new Map<YMDString, number>();\n\n  for (const row of actualProjection.cal || []) {\n    actualMap.set(row.date, round2(row.running));\n  }\n  for (const row of whatIfProjection.cal || []) {\n    sandboxMap.set(row.date, round2(row.running));\n  }\n\n  const labels = Array.from(new Set([...actualMap.keys(), ...sandboxMap.keys()]))\n    .sort((a, b) => compareYMD(a, b));\n\n  const actualData = labels.map((date) =>\n    actualMap.has(date) ? round2(actualMap.get(date)!) : null\n  );\n  const sandboxData = labels.map((date) =>\n    sandboxMap.has(date) ? round2(sandboxMap.get(date)!) : null\n  );\n\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    whatIfChartInstance = null;\n    return null;\n  }\n\n  whatIfChartInstance = new Chart(ctx, {\n    type: 'line',\n    data: {\n      labels,\n      datasets: [\n        {\n          label: 'Actual Projection',\n          data: actualData,\n          borderColor: '#94a3b8',\n          backgroundColor: 'rgba(148, 163, 184, 0.18)',\n          borderWidth: 2,\n          pointRadius: 0,\n          tension: 0.25,\n          borderDash: [6, 4],\n          spanGaps: false,\n        },\n        {\n          label: 'What-If Projection',\n          data: sandboxData,\n          borderColor: '#5F7BFF',\n          backgroundColor: 'rgba(95, 123, 255, 0.2)',\n          borderWidth: 2,\n          pointRadius: 0,\n          tension: 0.25,\n          spanGaps: false,\n        },\n      ],\n    },\n    options: {\n      interaction: { intersect: false, mode: 'index' as const },\n      plugins: { legend: { display: true } },\n      scales: {\n        x: { ticks: { maxTicksLimit: 10 } },\n        y: {\n          beginAtZero: false,\n          grid: {\n            color: (ctx: any) => {\n              const value = ctx.tick && typeof ctx.tick.value === 'number' ? ctx.tick.value : null;\n              return value === 0 ? '#0f172a' : 'rgba(148, 163, 184, 0.2)';\n            },\n            lineWidth: (ctx: any) => {\n              const value = ctx.tick && typeof ctx.tick.value === 'number' ? ctx.tick.value : null;\n              return value === 0 ? 2 : 1;\n            },\n          },\n        },\n      },\n    },\n  });\n\n  return whatIfChartInstance;\n}\n\n/**\n * Destroy all chart instances\n */\nexport function destroyAllCharts(): void {\n  destroyChart(balanceChartInstance);\n  destroyChart(whatIfChartInstance);\n  balanceChartInstance = null;\n  whatIfChartInstance = null;\n}\n\n/**\n * Get current balance chart instance\n */\nexport function getBalanceChart(): any {\n  return balanceChartInstance;\n}\n\n/**\n * Get current what-if chart instance\n */\nexport function getWhatIfChart(): any {\n  return whatIfChartInstance;\n}\n","/**\n * Dashboard Tab Component\n */\n\nimport { useState, useEffect, useRef } from 'react';\nimport { useAppStore } from '../store/useAppStore';\nimport { computeProjection, fmtMoney } from '../modules/calculations';\nimport { fromYMD } from '../modules/dateUtils';\nimport { renderBalanceChart } from '../utils/chartUtils';\nimport type { ProjectionResult, Adjustment } from '../types';\n\nexport function Dashboard() {\n  const { settings, adjustments, oneOffs, incomeStreams, updateSettings, addAdjustment, removeAdjustment } = useAppStore();\n  const [projection, setProjection] = useState<ProjectionResult | null>(null);\n  const chartCanvasRef = useRef<HTMLCanvasElement>(null);\n  const chartInstanceRef = useRef<any>(null);\n\n  // State for adjustment form\n  const [adjDate, setAdjDate] = useState('');\n  const [adjAmount, setAdjAmount] = useState('');\n  const [adjNote, setAdjNote] = useState('');\n\n  // Calculate projection whenever data changes\n  useEffect(() => {\n    try {\n      const result = computeProjection({\n        settings,\n        adjustments,\n        oneOffs,\n        incomeStreams,\n        ui: { oneOffSort: { key: 'date', direction: 'asc' } },\n      });\n      setProjection(result);\n    } catch (err) {\n      console.error('Projection calculation failed:', err);\n    }\n  }, [settings, adjustments, oneOffs, incomeStreams]);\n\n  // Render chart when projection changes\n  useEffect(() => {\n    if (projection && chartCanvasRef.current) {\n      if (chartInstanceRef.current) {\n        chartInstanceRef.current.destroy();\n      }\n      chartInstanceRef.current = renderBalanceChart(chartCanvasRef.current, projection);\n    }\n  }, [projection]);\n\n  const handleSettingsSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    const formData = new FormData(e.currentTarget);\n    updateSettings({\n      startDate: formData.get('startDate') as string,\n      endDate: formData.get('endDate') as string,\n      startingBalance: parseFloat(formData.get('startingBalance') as string),\n    });\n  };\n\n  const handleAdjustmentSubmit = (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    if (!adjDate || !adjAmount) return;\n\n    const adjustment: Adjustment = {\n      date: adjDate,\n      amount: parseFloat(adjAmount),\n      note: adjNote || undefined,\n    };\n\n    addAdjustment(adjustment);\n    setAdjDate('');\n    setAdjAmount('');\n    setAdjNote('');\n  };\n\n  const handleRemoveAdjustment = (date: string) => {\n    if (confirm('Remove this adjustment?')) {\n      removeAdjustment(date);\n    }\n  };\n\n  const fmtDate = (ymd: string): string => {\n    if (!ymd) return '';\n    try {\n      const d = fromYMD(ymd);\n      if (!(d instanceof Date) || Number.isNaN(d.getTime())) return ymd;\n      return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });\n    } catch {\n      return ymd;\n    }\n  };\n\n  // Get upcoming 14 days\n  const upcomingDays = projection?.cal.slice(0, 14) || [];\n\n  return (\n    <section id=\"dashboard\" className=\"tab-panel active\">\n      <div className=\"card grid-2\">\n        <form onSubmit={handleSettingsSubmit} className=\"form\">\n          <h2>Model Settings</h2>\n          <div className=\"field\">\n            <label htmlFor=\"startDate\">Start Date</label>\n            <input\n              id=\"startDate\"\n              name=\"startDate\"\n              type=\"date\"\n              defaultValue={settings.startDate}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"endDate\">End Date</label>\n            <input\n              id=\"endDate\"\n              name=\"endDate\"\n              type=\"date\"\n              defaultValue={settings.endDate}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"startingBalance\">Starting Balance</label>\n            <input\n              id=\"startingBalance\"\n              name=\"startingBalance\"\n              type=\"number\"\n              step=\"0.01\"\n              defaultValue={settings.startingBalance}\n              required\n            />\n          </div>\n          <div className=\"actions\">\n            <button type=\"submit\" className=\"btn\">\n              Recalculate\n            </button>\n          </div>\n        </form>\n\n        <div className=\"kpis\">\n          <h2>Quick Stats</h2>\n          {projection && (\n            <>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Projected End Balance</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.endBalance)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Total Planned Income</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.totalIncome)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Projected Weekly Income</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.projectedWeeklyIncome)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Total Planned Expenses</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.totalExpenses)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Lowest Projected Balance</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.lowestBalance)}</div>\n                <div className=\"kpi-meta\">{fmtDate(projection.lowestBalanceDate)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Peak Projected Balance</div>\n                <div className=\"kpi-value\">{fmtMoney(projection.peakBalance)}</div>\n                <div className=\"kpi-meta\">{fmtDate(projection.peakBalanceDate)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Days Below $0</div>\n                <div className=\"kpi-value\">{projection.negativeDays}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">First Negative Day</div>\n                <div className=\"kpi-value\">\n                  {projection.firstNegativeDate ? fmtDate(projection.firstNegativeDate) : ''}\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h2>Projected Balance</h2>\n        <canvas ref={chartCanvasRef} id=\"balanceChart\" height=\"100\"></canvas>\n      </div>\n\n      <div className=\"card\">\n        <div>\n          <h2>Upcoming 14 Days</h2>\n          <table className=\"table\" id=\"upcomingTable\">\n            <thead>\n              <tr>\n                <th>Date</th>\n                <th>Income</th>\n                <th>Expenses</th>\n                <th>Net</th>\n                <th>Running</th>\n              </tr>\n            </thead>\n            <tbody>\n              {upcomingDays.map((day) => (\n                <tr key={day.date}>\n                  <td>{fmtDate(day.date)}</td>\n                  <td>{fmtMoney(day.income)}</td>\n                  <td>{fmtMoney(day.expenses)}</td>\n                  <td>{fmtMoney(day.net)}</td>\n                  <td>{fmtMoney(day.running)}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div>\n          <h2>Adjustments</h2>\n          <form onSubmit={handleAdjustmentSubmit} className=\"form compact\">\n            <div className=\"field\">\n              <label htmlFor=\"adjDate\">Date</label>\n              <input\n                id=\"adjDate\"\n                type=\"date\"\n                value={adjDate}\n                onChange={(e) => setAdjDate(e.target.value)}\n                required\n              />\n            </div>\n            <div className=\"field\">\n              <label htmlFor=\"adjAmount\">Amount (+/)</label>\n              <input\n                id=\"adjAmount\"\n                type=\"number\"\n                step=\"0.01\"\n                value={adjAmount}\n                onChange={(e) => setAdjAmount(e.target.value)}\n                required\n              />\n            </div>\n            <div className=\"field\">\n              <label htmlFor=\"adjNote\">Note</label>\n              <input\n                id=\"adjNote\"\n                type=\"text\"\n                placeholder=\"Reconcile to bank, etc.\"\n                value={adjNote}\n                onChange={(e) => setAdjNote(e.target.value)}\n              />\n            </div>\n            <div className=\"actions\">\n              <button className=\"btn\" type=\"submit\">\n                Add Adjustment\n              </button>\n            </div>\n          </form>\n          <table className=\"table\" id=\"adjTable\">\n            <thead>\n              <tr>\n                <th>Date</th>\n                <th>Amount</th>\n                <th>Note</th>\n                <th></th>\n              </tr>\n            </thead>\n            <tbody>\n              {adjustments.map((adj) => (\n                <tr key={adj.date}>\n                  <td>{fmtDate(adj.date)}</td>\n                  <td>{fmtMoney(adj.amount)}</td>\n                  <td>{adj.note || ''}</td>\n                  <td>\n                    <button\n                      className=\"btn btn-sm\"\n                      onClick={() => handleRemoveAdjustment(adj.date)}\n                    >\n                      Remove\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </section>\n  );\n}\n","/**\n * What-If Tab Component - Scenario planning and comparison\n */\n\nimport { useState, useEffect } from 'react';\nimport { useAppStore } from '../store/useAppStore';\nimport { computeProjection, fmtMoney } from '../modules/calculations';\nimport { fromYMD } from '../modules/dateUtils';\nimport type { ProjectionResult, WhatIfTweaks } from '../types';\n\nexport function WhatIf() {\n  const { settings, adjustments, oneOffs, incomeStreams } = useAppStore();\n  const [actualProjection, setActualProjection] = useState<ProjectionResult | null>(null);\n  const [whatIfProjection, setWhatIfProjection] = useState<ProjectionResult | null>(null);\n\n  const [tweaks, setTweaks] = useState<WhatIfTweaks>({\n    global: {\n      pct: 0,\n      delta: 0,\n      lastEdited: 'pct',\n    },\n    streams: {},\n    sale: {\n      enabled: false,\n      entries: [],\n    },\n    startDate: settings.startDate,\n    endDate: settings.endDate,\n  });\n\n  // Calculate actual projection\n  useEffect(() => {\n    try {\n      const result = computeProjection({\n        settings,\n        adjustments,\n        oneOffs,\n        incomeStreams,\n        ui: { oneOffSort: { key: 'date', direction: 'asc' } },\n      });\n      setActualProjection(result);\n    } catch (err) {\n      console.error('Actual projection calculation failed:', err);\n    }\n  }, [settings, adjustments, oneOffs, incomeStreams]);\n\n  // Calculate what-if projection with tweaks\n  useEffect(() => {\n    try {\n      // Apply global tweaks to income streams\n      const tweakedStreams = incomeStreams.map((stream) => {\n        const streamTweak = tweaks.streams[stream.id];\n        let multiplier = 1;\n\n        if (streamTweak) {\n          if (streamTweak.lastEdited === 'pct') {\n            multiplier = 1 + streamTweak.pct / 100;\n          } else if (streamTweak.lastEdited === 'delta') {\n            const newAmount = stream.amount + streamTweak.delta;\n            multiplier = newAmount / stream.amount;\n          }\n        } else {\n          // Apply global tweak\n          if (tweaks.global.lastEdited === 'pct') {\n            multiplier = 1 + tweaks.global.pct / 100;\n          } else if (tweaks.global.lastEdited === 'delta') {\n            const newAmount = stream.amount + tweaks.global.delta;\n            multiplier = newAmount / stream.amount;\n          }\n        }\n\n        return {\n          ...stream,\n          amount: stream.amount * multiplier,\n        };\n      });\n\n      const result = computeProjection({\n        settings: {\n          ...settings,\n          startDate: tweaks.startDate,\n          endDate: tweaks.endDate,\n        },\n        adjustments,\n        oneOffs,\n        incomeStreams: tweakedStreams,\n        ui: { oneOffSort: { key: 'date', direction: 'asc' } },\n      });\n      setWhatIfProjection(result);\n    } catch (err) {\n      console.error('What-if projection calculation failed:', err);\n    }\n  }, [settings, adjustments, oneOffs, incomeStreams, tweaks]);\n\n  const handlePullFromActuals = () => {\n    if (confirm('Pull current actuals into What-If scenario?')) {\n      setTweaks({\n        global: {\n          pct: 0,\n          delta: 0,\n          lastEdited: 'pct',\n        },\n        streams: {},\n        sale: {\n          enabled: false,\n          entries: [],\n        },\n        startDate: settings.startDate,\n        endDate: settings.endDate,\n      });\n    }\n  };\n\n  const handleGlobalPctChange = (pct: number) => {\n    setTweaks({\n      ...tweaks,\n      global: {\n        ...tweaks.global,\n        pct,\n        lastEdited: 'pct',\n      },\n    });\n  };\n\n  const handleGlobalDeltaChange = (delta: number) => {\n    setTweaks({\n      ...tweaks,\n      global: {\n        ...tweaks.global,\n        delta,\n        lastEdited: 'delta',\n      },\n    });\n  };\n\n  const fmtDate = (ymd: string): string => {\n    if (!ymd) return '';\n    try {\n      const d = fromYMD(ymd);\n      return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });\n    } catch {\n      return ymd;\n    }\n  };\n\n  const fmtDelta = (val: number): string => {\n    const sign = val >= 0 ? '+' : '';\n    return `${sign}${fmtMoney(val)}`;\n  };\n\n  return (\n    <section id=\"whatif\" className=\"tab-panel active\">\n      <div className=\"card\">\n        <div className=\"card-header\">\n          <h2>What-If Quick Stats</h2>\n          <div className=\"header-actions\">\n            <button onClick={handlePullFromActuals} className=\"btn btn-outline\">\n              Pull from Actuals\n            </button>\n          </div>\n        </div>\n        <div className=\"kpis whatif-kpis\">\n          {whatIfProjection && actualProjection && (\n            <>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Projected End Balance</div>\n                <div className=\"kpi-value\">{fmtMoney(whatIfProjection.endBalance)}</div>\n                <div className=\"kpi-meta\">Actual: {fmtMoney(actualProjection.endBalance)}</div>\n                <div className=\"kpi-meta\">\n                   vs Actual:{' '}\n                  <span className=\"delta\">\n                    {fmtDelta(whatIfProjection.endBalance - actualProjection.endBalance)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Total Planned Income</div>\n                <div className=\"kpi-value\">{fmtMoney(whatIfProjection.totalIncome)}</div>\n                <div className=\"kpi-meta\">Actual: {fmtMoney(actualProjection.totalIncome)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Projected Weekly Income</div>\n                <div className=\"kpi-value\">{fmtMoney(whatIfProjection.projectedWeeklyIncome)}</div>\n                <div className=\"kpi-meta\">Actual: {fmtMoney(actualProjection.projectedWeeklyIncome)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Total Planned Expenses</div>\n                <div className=\"kpi-value\">{fmtMoney(whatIfProjection.totalExpenses)}</div>\n                <div className=\"kpi-meta\">Actual: {fmtMoney(actualProjection.totalExpenses)}</div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Lowest Projected Balance</div>\n                <div className=\"kpi-value\">{fmtMoney(whatIfProjection.lowestBalance)}</div>\n                <div className=\"kpi-meta\">Actual: {fmtMoney(actualProjection.lowestBalance)}</div>\n                <div className=\"kpi-meta\">\n                   vs Actual:{' '}\n                  <span className=\"delta\">\n                    {fmtDelta(whatIfProjection.lowestBalance - actualProjection.lowestBalance)}\n                  </span>\n                </div>\n              </div>\n              <div className=\"kpi\">\n                <div className=\"kpi-label\">Days Below $0</div>\n                <div className=\"kpi-value\">{whatIfProjection.negativeDays}</div>\n                <div className=\"kpi-meta\">Actual: {actualProjection.negativeDays}</div>\n                <div className=\"kpi-meta\">\n                   vs Actual:{' '}\n                  <span className=\"delta\">{whatIfProjection.negativeDays - actualProjection.negativeDays}</span>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h2>What-If Controls</h2>\n        <div className=\"whatif-controls\">\n          <div className=\"whatif-control-block\">\n            <h3>What-If Model Dates</h3>\n            <div className=\"whatif-fields\">\n              <label htmlFor=\"whatifStartDate\">Start Date</label>\n              <input\n                id=\"whatifStartDate\"\n                type=\"date\"\n                value={tweaks.startDate}\n                onChange={(e) => setTweaks({ ...tweaks, startDate: e.target.value })}\n              />\n            </div>\n            <div className=\"whatif-fields\">\n              <label htmlFor=\"whatifEndDate\">End Date</label>\n              <input\n                id=\"whatifEndDate\"\n                type=\"date\"\n                value={tweaks.endDate}\n                onChange={(e) => setTweaks({ ...tweaks, endDate: e.target.value })}\n              />\n            </div>\n          </div>\n\n          <div className=\"whatif-control-block whatif-global-block\">\n            <h3>Global Tweaks</h3>\n            <div className=\"whatif-global-grid\">\n              <label className=\"whatif-fields\">\n                <span>% tweak</span>\n                <div className=\"whatif-percent-inputs\">\n                  <input\n                    id=\"whatifGlobalPct\"\n                    type=\"number\"\n                    min=\"-100\"\n                    max=\"200\"\n                    step=\"1\"\n                    value={tweaks.global.pct}\n                    onChange={(e) => handleGlobalPctChange(parseFloat(e.target.value) || 0)}\n                  />\n                  <input\n                    id=\"whatifGlobalPctSlider\"\n                    type=\"range\"\n                    min=\"-100\"\n                    max=\"200\"\n                    step=\"1\"\n                    value={tweaks.global.pct}\n                    onChange={(e) => handleGlobalPctChange(parseFloat(e.target.value))}\n                  />\n                </div>\n              </label>\n              <label className=\"whatif-fields\">\n                <span>$ tweak</span>\n                <input\n                  id=\"whatifGlobalDelta\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  value={tweaks.global.delta}\n                  onChange={(e) => handleGlobalDeltaChange(parseFloat(e.target.value) || 0)}\n                />\n              </label>\n            </div>\n            <div className=\"whatif-global-summary\">\n              {tweaks.global.pct !== 0 && (\n                <p>\n                  All income streams adjusted by {tweaks.global.pct > 0 ? '+' : ''}\n                  {tweaks.global.pct}%\n                </p>\n              )}\n              {tweaks.global.delta !== 0 && (\n                <p>All income streams adjusted by {fmtDelta(tweaks.global.delta)}</p>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"card\">\n        <h2>What-If 30-Day Outlook</h2>\n        <table className=\"table\">\n          <thead>\n            <tr>\n              <th>Date</th>\n              <th>Income</th>\n              <th>Expenses</th>\n              <th>Net</th>\n              <th>Running</th>\n            </tr>\n          </thead>\n          <tbody>\n            {whatIfProjection?.cal.slice(0, 30).map((day) => (\n              <tr key={day.date}>\n                <td>{fmtDate(day.date)}</td>\n                <td>{fmtMoney(day.income)}</td>\n                <td>{fmtMoney(day.expenses)}</td>\n                <td>{fmtMoney(day.net)}</td>\n                <td>{fmtMoney(day.running)}</td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </section>\n  );\n}\n","/**\n * Cash Movements Tab Component - One-off and recurring transactions\n */\n\nimport { useState } from 'react';\nimport { useAppStore } from '../store/useAppStore';\nimport type { Transaction, OneOffTransaction, RecurringTransaction, Frequency } from '../types';\nimport { fmtMoney } from '../modules/calculations';\nimport { fromYMD } from '../modules/dateUtils';\nimport { deduplicateTransactions } from '../modules/transactions';\n\ninterface FormData {\n  type?: 'income' | 'expense';\n  name?: string;\n  category?: string;\n  amount?: number;\n  date?: string;\n  frequency?: Frequency;\n  startDate?: string;\n  endDate?: string;\n  escalatorPct?: number;\n  skipWeekends?: boolean;\n  dayOfWeek?: number[];\n  monthlyMode?: 'day' | 'nth';\n  dayOfMonth?: number;\n  nthWeek?: string;\n  nthWeekday?: number;\n  steps?: any[];\n}\n\nexport function CashMovements() {\n  const { oneOffs, addOneOff, updateOneOff, removeOneOff, setOneOffs } = useAppStore();\n\n  // Form state\n  const [isRecurring, setIsRecurring] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [formData, setFormData] = useState<FormData>({\n    type: 'expense',\n    frequency: 'monthly',\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n\n    const transaction: Transaction = isRecurring\n      ? ({\n          id: editingId || crypto.randomUUID(),\n          name: formData.name || '',\n          category: formData.category || '',\n          amount: formData.amount || 0,\n          type: formData.type || 'expense',\n          recurring: true,\n          frequency: formData.frequency || 'monthly',\n          startDate: formData.startDate || '',\n          endDate: formData.endDate || '',\n          steps: formData.steps || [],\n          escalatorPct: formData.escalatorPct || 0,\n          skipWeekends: formData.skipWeekends,\n          dayOfWeek: formData.dayOfWeek,\n          monthlyMode: formData.monthlyMode,\n          dayOfMonth: formData.dayOfMonth,\n          nthWeek: formData.nthWeek,\n          nthWeekday: formData.nthWeekday,\n        } as RecurringTransaction)\n      : ({\n          id: editingId || crypto.randomUUID(),\n          name: formData.name || '',\n          category: formData.category || '',\n          amount: formData.amount || 0,\n          type: formData.type || 'expense',\n          date: formData.date || '',\n          recurring: false,\n          steps: [],\n          escalatorPct: 0,\n        } as OneOffTransaction);\n\n    if (editingId) {\n      updateOneOff(editingId, transaction);\n      setEditingId(null);\n    } else {\n      addOneOff(transaction);\n    }\n\n    resetForm();\n  };\n\n  const resetForm = () => {\n    setFormData({\n      type: 'expense',\n      frequency: 'monthly',\n    });\n    setIsRecurring(false);\n    setEditingId(null);\n  };\n\n  const handleEdit = (transaction: Transaction) => {\n    setFormData(transaction);\n    setIsRecurring(transaction.recurring);\n    setEditingId(transaction.id);\n  };\n\n  const handleRemove = (id: string) => {\n    if (confirm('Delete this transaction?')) {\n      removeOneOff(id);\n    }\n  };\n\n  const handleDeduplicate = () => {\n    const deduplicated = deduplicateTransactions(oneOffs);\n    const removedCount = oneOffs.length - deduplicated.length;\n    if (removedCount > 0) {\n      if (confirm(`Remove ${removedCount} duplicate transaction(s)?`)) {\n        setOneOffs(deduplicated);\n      }\n    } else {\n      alert('No duplicates found!');\n    }\n  };\n\n  const fmtDate = (ymd: string): string => {\n    if (!ymd) return '';\n    try {\n      const d = fromYMD(ymd);\n      return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });\n    } catch {\n      return ymd;\n    }\n  };\n\n  const getScheduleLabel = (tx: Transaction): string => {\n    if (!tx.recurring) return 'One-time';\n    return tx.frequency.charAt(0).toUpperCase() + tx.frequency.slice(1);\n  };\n\n  return (\n    <section id=\"movements\" className=\"tab-panel active\">\n      <div className=\"card\">\n        <div className=\"card-header\">\n          <h2>One-Off Transactions</h2>\n          <div className=\"header-actions\">\n            <button onClick={handleDeduplicate} className=\"btn btn-outline\">\n              Remove Duplicates\n            </button>\n          </div>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"form grid-4\">\n          <div className=\"field\">\n            <label htmlFor=\"ooDate\">Date</label>\n            <input\n              id=\"ooDate\"\n              type=\"date\"\n              value={formData.date || ''}\n              onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n              required={!isRecurring}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"ooType\">Type</label>\n            <select\n              id=\"ooType\"\n              value={formData.type}\n              onChange={(e) => setFormData({ ...formData, type: e.target.value as 'income' | 'expense' })}\n            >\n              <option value=\"expense\">Expense</option>\n              <option value=\"income\">Income</option>\n            </select>\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"ooName\">Description</label>\n            <input\n              id=\"ooName\"\n              type=\"text\"\n              placeholder=\"Rent, AR payment, etc.\"\n              value={formData.name || ''}\n              onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"ooCategory\">Category</label>\n            <input\n              id=\"ooCategory\"\n              type=\"text\"\n              placeholder=\"Ops, AR, etc.\"\n              value={formData.category || ''}\n              onChange={(e) => setFormData({ ...formData, category: e.target.value })}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"ooAmount\">Amount</label>\n            <input\n              id=\"ooAmount\"\n              type=\"number\"\n              step=\"0.01\"\n              value={formData.amount || ''}\n              onChange={(e) => setFormData({ ...formData, amount: parseFloat(e.target.value) })}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label>\n              <input\n                id=\"ooRepeats\"\n                type=\"checkbox\"\n                checked={isRecurring}\n                onChange={(e) => setIsRecurring(e.target.checked)}\n              />{' '}\n              Repeats?\n            </label>\n          </div>\n\n          {isRecurring && (\n            <>\n              <div className=\"field\">\n                <label htmlFor=\"ooFreq\">Frequency</label>\n                <select\n                  id=\"ooFreq\"\n                  value={formData.frequency}\n                  onChange={(e) => setFormData({ ...formData, frequency: e.target.value as Frequency })}\n                >\n                  <option value=\"daily\">Daily</option>\n                  <option value=\"weekly\">Weekly</option>\n                  <option value=\"biweekly\">Biweekly</option>\n                  <option value=\"monthly\">Monthly</option>\n                </select>\n              </div>\n              <div className=\"field\">\n                <label htmlFor=\"ooStart\">Start Date</label>\n                <input\n                  id=\"ooStart\"\n                  type=\"date\"\n                  value={formData.startDate || ''}\n                  onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\n                />\n              </div>\n              <div className=\"field\">\n                <label htmlFor=\"ooEnd\">End Date</label>\n                <input\n                  id=\"ooEnd\"\n                  type=\"date\"\n                  value={formData.endDate || ''}\n                  onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\n                />\n              </div>\n              <div className=\"field\">\n                <label htmlFor=\"ooEscalator\">Monthly Escalator (%)</label>\n                <input\n                  id=\"ooEscalator\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"e.g. 2 for 2%\"\n                  value={formData.escalatorPct || ''}\n                  onChange={(e) => setFormData({ ...formData, escalatorPct: parseFloat(e.target.value) || 0 })}\n                />\n              </div>\n            </>\n          )}\n\n          <div className=\"actions\">\n            <button className=\"btn\" type=\"submit\">\n              {editingId ? 'Update' : 'Add'}\n            </button>\n            {editingId && (\n              <button className=\"btn btn-outline\" type=\"button\" onClick={resetForm}>\n                Cancel\n              </button>\n            )}\n          </div>\n        </form>\n\n        <table className=\"table\" id=\"oneOffTable\">\n          <thead>\n            <tr>\n              <th>Base Date</th>\n              <th>Schedule</th>\n              <th>Type</th>\n              <th>Description</th>\n              <th>Category</th>\n              <th className=\"num\">Amount</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {oneOffs.map((tx) => (\n              <tr key={tx.id}>\n                <td>{tx.recurring ? fmtDate(tx.startDate) : fmtDate(tx.date)}</td>\n                <td>{getScheduleLabel(tx)}</td>\n                <td>{tx.type}</td>\n                <td>{tx.name}</td>\n                <td>{tx.category}</td>\n                <td className=\"num\">{fmtMoney(tx.amount)}</td>\n                <td>\n                  <button className=\"btn btn-sm\" onClick={() => handleEdit(tx)}>\n                    Edit\n                  </button>\n                  <button className=\"btn btn-sm\" onClick={() => handleRemove(tx.id)}>\n                    Remove\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </section>\n  );\n}\n","/**\n * Income Plan Tab Component - Recurring income streams\n */\n\nimport { useState } from 'react';\nimport { useAppStore } from '../store/useAppStore';\nimport type { IncomeStream, Frequency } from '../types';\nimport { fmtMoney } from '../modules/calculations';\nimport { fromYMD } from '../modules/dateUtils';\n\nexport function IncomePlan() {\n  const { incomeStreams, addIncomeStream, updateIncomeStream, removeIncomeStream } = useAppStore();\n\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [formData, setFormData] = useState<Partial<IncomeStream>>({\n    frequency: 'weekly',\n    skipWeekends: false,\n    monthlyMode: 'day',\n    dayOfMonth: 1,\n    escalatorPct: 0,\n    steps: [],\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n\n    const stream: IncomeStream = {\n      id: editingId || crypto.randomUUID(),\n      name: formData.name || '',\n      category: formData.category || '',\n      amount: formData.amount || 0,\n      frequency: formData.frequency || 'weekly',\n      startDate: formData.startDate || '',\n      endDate: formData.endDate || '',\n      onDate: formData.onDate || null,\n      skipWeekends: formData.skipWeekends || false,\n      steps: formData.steps || [],\n      escalatorPct: formData.escalatorPct || 0,\n      dayOfWeek: formData.dayOfWeek,\n      monthlyMode: formData.monthlyMode,\n      dayOfMonth: formData.dayOfMonth,\n      nthWeek: formData.nthWeek,\n      nthWeekday: formData.nthWeekday,\n    };\n\n    if (editingId) {\n      updateIncomeStream(editingId, stream);\n      setEditingId(null);\n    } else {\n      addIncomeStream(stream);\n    }\n\n    resetForm();\n  };\n\n  const resetForm = () => {\n    setFormData({\n      frequency: 'weekly',\n      skipWeekends: false,\n      monthlyMode: 'day',\n      dayOfMonth: 1,\n      escalatorPct: 0,\n      steps: [],\n    });\n    setEditingId(null);\n  };\n\n  const handleEdit = (stream: IncomeStream) => {\n    setFormData(stream);\n    setEditingId(stream.id);\n  };\n\n  const handleRemove = (id: string) => {\n    if (confirm('Delete this income stream?')) {\n      removeIncomeStream(id);\n    }\n  };\n\n  const fmtDate = (ymd: string): string => {\n    if (!ymd) return '';\n    try {\n      const d = fromYMD(ymd);\n      return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });\n    } catch {\n      return ymd;\n    }\n  };\n\n  const getScheduleLabel = (stream: IncomeStream): string => {\n    if (stream.frequency === 'once') return `On ${fmtDate(stream.onDate || '')}`;\n\n    let label = stream.frequency.charAt(0).toUpperCase() + stream.frequency.slice(1);\n\n    if (stream.frequency === 'daily' && stream.skipWeekends) {\n      label += ' (skip weekends)';\n    }\n\n    if ((stream.frequency === 'weekly' || stream.frequency === 'biweekly') && stream.dayOfWeek) {\n      const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n      const dayNames = stream.dayOfWeek.map(d => days[d]).join(', ');\n      label += ` on ${dayNames}`;\n    }\n\n    if (stream.frequency === 'monthly') {\n      if (stream.monthlyMode === 'day' && stream.dayOfMonth) {\n        label += ` on day ${stream.dayOfMonth}`;\n      } else if (stream.monthlyMode === 'nth' && stream.nthWeek && stream.nthWeekday !== undefined) {\n        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n        label += ` on ${stream.nthWeek} ${days[stream.nthWeekday]}`;\n      }\n    }\n\n    return label;\n  };\n\n  return (\n    <section id=\"income\" className=\"tab-panel active\">\n      <div className=\"card\">\n        <h2>Recurring Income Streams</h2>\n\n        <form onSubmit={handleSubmit} className=\"form grid-4\">\n          <div className=\"field\">\n            <label htmlFor=\"stName\">Name</label>\n            <input\n              id=\"stName\"\n              type=\"text\"\n              placeholder=\"Weekly sales, AR collections, etc.\"\n              value={formData.name || ''}\n              onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"stCategory\">Category</label>\n            <input\n              id=\"stCategory\"\n              type=\"text\"\n              placeholder=\"Sales, AR, etc.\"\n              value={formData.category || ''}\n              onChange={(e) => setFormData({ ...formData, category: e.target.value })}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"stAmount\">Amount</label>\n            <input\n              id=\"stAmount\"\n              type=\"number\"\n              step=\"0.01\"\n              value={formData.amount || ''}\n              onChange={(e) => setFormData({ ...formData, amount: parseFloat(e.target.value) })}\n              required\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"stEscalator\">Monthly Escalator (%)</label>\n            <input\n              id=\"stEscalator\"\n              type=\"number\"\n              step=\"0.01\"\n              placeholder=\"e.g. 1.5\"\n              value={formData.escalatorPct || ''}\n              onChange={(e) => setFormData({ ...formData, escalatorPct: parseFloat(e.target.value) || 0 })}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"stFreq\">Frequency</label>\n            <select\n              id=\"stFreq\"\n              value={formData.frequency}\n              onChange={(e) => setFormData({ ...formData, frequency: e.target.value as Frequency })}\n            >\n              <option value=\"once\">Once</option>\n              <option value=\"daily\">Daily</option>\n              <option value=\"weekly\">Weekly</option>\n              <option value=\"biweekly\">Biweekly</option>\n              <option value=\"monthly\">Monthly</option>\n            </select>\n          </div>\n\n          {formData.frequency === 'once' && (\n            <div className=\"field\">\n              <label htmlFor=\"stOnDate\">On Date</label>\n              <input\n                id=\"stOnDate\"\n                type=\"date\"\n                value={formData.onDate || ''}\n                onChange={(e) => setFormData({ ...formData, onDate: e.target.value })}\n              />\n            </div>\n          )}\n\n          {formData.frequency === 'daily' && (\n            <div className=\"field\">\n              <label>\n                <input\n                  id=\"stSkipWeekends\"\n                  type=\"checkbox\"\n                  checked={formData.skipWeekends}\n                  onChange={(e) => setFormData({ ...formData, skipWeekends: e.target.checked })}\n                />{' '}\n                Skip weekends\n              </label>\n            </div>\n          )}\n\n          {formData.frequency !== 'once' && (\n            <>\n              <div className=\"field\">\n                <label htmlFor=\"stStart\">Start Date</label>\n                <input\n                  id=\"stStart\"\n                  type=\"date\"\n                  value={formData.startDate || ''}\n                  onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\n                  required\n                />\n              </div>\n              <div className=\"field\">\n                <label htmlFor=\"stEnd\">End Date</label>\n                <input\n                  id=\"stEnd\"\n                  type=\"date\"\n                  value={formData.endDate || ''}\n                  onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\n                  required\n                />\n              </div>\n            </>\n          )}\n\n          <div className=\"actions\">\n            <button className=\"btn\" type=\"submit\">\n              {editingId ? 'Update Stream' : 'Add Stream'}\n            </button>\n            {editingId && (\n              <button className=\"btn btn-outline\" type=\"button\" onClick={resetForm}>\n                Cancel\n              </button>\n            )}\n          </div>\n        </form>\n\n        <table className=\"table\" id=\"streamsTable\">\n          <thead>\n            <tr>\n              <th>Name</th>\n              <th>Category</th>\n              <th>Frequency</th>\n              <th>Schedule</th>\n              <th className=\"num\">Amount</th>\n              <th>Dates</th>\n              <th></th>\n            </tr>\n          </thead>\n          <tbody>\n            {incomeStreams.map((stream) => (\n              <tr key={stream.id}>\n                <td>{stream.name}</td>\n                <td>{stream.category}</td>\n                <td>{stream.frequency}</td>\n                <td>{getScheduleLabel(stream)}</td>\n                <td className=\"num\">{fmtMoney(stream.amount)}</td>\n                <td>\n                  {stream.frequency !== 'once' && `${fmtDate(stream.startDate)} - ${fmtDate(stream.endDate)}`}\n                  {stream.frequency === 'once' && fmtDate(stream.onDate || '')}\n                </td>\n                <td>\n                  <button className=\"btn btn-sm\" onClick={() => handleEdit(stream)}>\n                    Edit\n                  </button>\n                  <button className=\"btn btn-sm\" onClick={() => handleRemove(stream.id)}>\n                    Remove\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </section>\n  );\n}\n","/**\n * Receivables (AR) Tab Component - Accounts Receivable importer\n */\n\nimport { useState } from 'react';\nimport { useAppStore } from '../store/useAppStore';\nimport type { AROptions, ARInvoice, Transaction } from '../types';\n\nexport function Receivables() {\n  const { addOneOff } = useAppStore();\n\n  const [arOptions, setArOptions] = useState<AROptions>({\n    roll: 'forward',\n    lag: 0,\n    conf: 100,\n    category: 'AR',\n    prune: false,\n  });\n\n  const [invoices, setInvoices] = useState<ARInvoice[]>([]);\n  const [selectedInvoices, setSelectedInvoices] = useState<Set<string>>(new Set());\n\n  const handleFileUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      try {\n        const text = event.target?.result as string;\n        // Simple CSV parsing - in production, use a proper CSV library\n        const lines = text.split('\\n');\n\n        const parsed: ARInvoice[] = lines.slice(1)\n          .filter(line => line.trim())\n          .map((line) => {\n            const values = line.split(',').map(v => v.trim());\n            return {\n              id: crypto.randomUUID(),\n              company: values[0] || '',\n              invoice: values[1] || '',\n              due: values[2] || '',\n              amount: parseFloat(values[3]) || 0,\n              conf: arOptions.conf,\n            };\n          });\n\n        setInvoices(parsed);\n        alert(`Parsed ${parsed.length} invoices from file`);\n      } catch (err) {\n        console.error('Failed to parse AR file:', err);\n        alert('Failed to parse AR file. Please check the format.');\n      }\n    };\n    reader.readAsText(file);\n  };\n\n  const handlePreview = () => {\n    if (invoices.length === 0) {\n      alert('No invoices loaded. Please upload a file first.');\n    } else {\n      alert(`Preview: ${invoices.length} invoices ready to import`);\n    }\n  };\n\n  const handleImport = () => {\n    const toImport = invoices.filter(inv => selectedInvoices.has(inv.id));\n\n    if (toImport.length === 0) {\n      alert('No invoices selected for import');\n      return;\n    }\n\n    toImport.forEach(inv => {\n      // Apply lag to due date\n      const dueDate = new Date(inv.due);\n      dueDate.setDate(dueDate.getDate() + arOptions.lag);\n\n      // Apply weekend rolling if needed\n      if (arOptions.roll !== 'none') {\n        const day = dueDate.getDay();\n        if (day === 0) { // Sunday\n          dueDate.setDate(dueDate.getDate() + (arOptions.roll === 'forward' ? 1 : -2));\n        } else if (day === 6) { // Saturday\n          dueDate.setDate(dueDate.getDate() + (arOptions.roll === 'forward' ? 2 : -1));\n        }\n      }\n\n      const expectedDate = dueDate.toISOString().slice(0, 10);\n      const adjustedAmount = (inv.amount * inv.conf) / 100;\n\n      const transaction: Transaction = {\n        id: inv.id,\n        name: `AR: ${inv.company} - ${inv.invoice}`,\n        category: arOptions.category,\n        amount: adjustedAmount,\n        type: 'income',\n        date: expectedDate,\n        recurring: false,\n        steps: [],\n        escalatorPct: 0,\n        source: 'AR Import',\n        status: 'imported',\n      };\n\n      addOneOff(transaction);\n    });\n\n    alert(`Imported ${toImport.length} AR transactions`);\n    setInvoices([]);\n    setSelectedInvoices(new Set());\n  };\n\n  const handleSelectAll = () => {\n    if (selectedInvoices.size === invoices.length) {\n      setSelectedInvoices(new Set());\n    } else {\n      setSelectedInvoices(new Set(invoices.map(inv => inv.id)));\n    }\n  };\n\n  const toggleInvoiceSelection = (id: string) => {\n    const newSelection = new Set(selectedInvoices);\n    if (newSelection.has(id)) {\n      newSelection.delete(id);\n    } else {\n      newSelection.add(id);\n    }\n    setSelectedInvoices(newSelection);\n  };\n\n  const fmtDate = (ymd: string): string => {\n    if (!ymd) return '';\n    try {\n      const d = new Date(ymd);\n      return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });\n    } catch {\n      return ymd;\n    }\n  };\n\n  const fmtMoney = (amount: number): string => {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n    }).format(amount);\n  };\n\n  return (\n    <section id=\"receivables\" className=\"tab-panel active\">\n      <div className=\"card\">\n        <h2>Receivables (AR) Importer</h2>\n        <div className=\"ar-controls\">\n          <div className=\"field\">\n            <label htmlFor=\"arFile\">Upload AR aging file</label>\n            <input\n              id=\"arFile\"\n              type=\"file\"\n              accept=\".csv,.xlsx,.xls\"\n              onChange={handleFileUpload}\n            />\n          </div>\n        </div>\n\n        <div className=\"ar-options\">\n          <div className=\"field\">\n            <label htmlFor=\"arRoll\">Weekend roll</label>\n            <select\n              id=\"arRoll\"\n              value={arOptions.roll}\n              onChange={(e) => setArOptions({ ...arOptions, roll: e.target.value as any })}\n            >\n              <option value=\"forward\">Roll forward</option>\n              <option value=\"back\">Roll back</option>\n              <option value=\"none\">No roll</option>\n            </select>\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"arLag\">Payment lag (days)</label>\n            <input\n              id=\"arLag\"\n              type=\"number\"\n              value={arOptions.lag}\n              min=\"0\"\n              step=\"1\"\n              onChange={(e) => setArOptions({ ...arOptions, lag: parseInt(e.target.value) || 0 })}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"arConf\">Confidence %</label>\n            <input\n              id=\"arConf\"\n              type=\"number\"\n              value={arOptions.conf}\n              min=\"0\"\n              max=\"100\"\n              step=\"1\"\n              onChange={(e) => setArOptions({ ...arOptions, conf: parseInt(e.target.value) || 100 })}\n            />\n          </div>\n          <div className=\"field\">\n            <label htmlFor=\"arCategory\">Category</label>\n            <input\n              id=\"arCategory\"\n              type=\"text\"\n              value={arOptions.category}\n              onChange={(e) => setArOptions({ ...arOptions, category: e.target.value })}\n            />\n          </div>\n          <div className=\"field checkbox-field\">\n            <label className=\"checkbox-label\">\n              <input\n                id=\"arPrune\"\n                type=\"checkbox\"\n                checked={arOptions.prune}\n                onChange={(e) => setArOptions({ ...arOptions, prune: e.target.checked })}\n              />\n              Prune invoices missing from this import (archive)\n            </label>\n          </div>\n          <div className=\"field actions-inline\">\n            <button onClick={handlePreview} className=\"btn\">\n              Preview\n            </button>\n            <button\n              onClick={handleImport}\n              className=\"btn\"\n              disabled={selectedInvoices.size === 0}\n            >\n              Import ({selectedInvoices.size})\n            </button>\n          </div>\n        </div>\n\n        <div className=\"ar-status\">\n          {invoices.length > 0 && (\n            <p>\n              Loaded {invoices.length} invoice(s). Select which ones to import below.\n            </p>\n          )}\n        </div>\n\n        <div className=\"ar-preview-wrapper\">\n          <table className=\"table ar-preview\">\n            <thead>\n              <tr>\n                <th className=\"select-col\">\n                  <label className=\"ar-select-all\">\n                    <input\n                      type=\"checkbox\"\n                      checked={selectedInvoices.size === invoices.length && invoices.length > 0}\n                      onChange={handleSelectAll}\n                    />\n                    <span>Select All</span>\n                  </label>\n                </th>\n                <th>Company</th>\n                <th>Invoice</th>\n                <th>Due</th>\n                <th>Amount</th>\n                <th>Conf %</th>\n                <th>Expected</th>\n              </tr>\n            </thead>\n            <tbody>\n              {invoices.map((inv) => {\n                const dueDate = new Date(inv.due);\n                dueDate.setDate(dueDate.getDate() + arOptions.lag);\n                const expectedDate = dueDate.toISOString().slice(0, 10);\n                const adjustedAmount = (inv.amount * arOptions.conf) / 100;\n\n                return (\n                  <tr key={inv.id}>\n                    <td>\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedInvoices.has(inv.id)}\n                        onChange={() => toggleInvoiceSelection(inv.id)}\n                      />\n                    </td>\n                    <td>{inv.company}</td>\n                    <td>{inv.invoice}</td>\n                    <td>{fmtDate(inv.due)}</td>\n                    <td>{fmtMoney(inv.amount)}</td>\n                    <td>{arOptions.conf}%</td>\n                    <td>\n                      {fmtDate(expectedDate)} ({fmtMoney(adjustedAmount)})\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </section>\n  );\n}\n","/**\n * Main App Component\n */\n\nimport { useState } from 'react';\nimport { useAppStore } from './store/useAppStore';\nimport {\n  Layout,\n  TabNavigation,\n  Dashboard,\n  WhatIf,\n  CashMovements,\n  IncomePlan,\n  Receivables,\n  type TabId,\n} from './components';\nimport './App.css';\n\nfunction App() {\n  const [activeTab, setActiveTab] = useState<TabId>('dashboard');\n  const { importData, settings, adjustments, oneOffs, incomeStreams } = useAppStore();\n\n  const handleExportJSON = () => {\n    const data = {\n      settings,\n      adjustments,\n      oneOffs,\n      incomeStreams,\n    };\n\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `cashflow-export-${new Date().toISOString().slice(0, 10)}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n\n  const handleImportJSON = () => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (!file) return;\n\n      const reader = new FileReader();\n      reader.onload = (event) => {\n        try {\n          const data = JSON.parse(event.target?.result as string);\n          if (confirm('Import this data? This will replace your current plan.')) {\n            importData(data);\n            alert('Data imported successfully!');\n          }\n        } catch (err) {\n          console.error('Failed to parse JSON:', err);\n          alert('Failed to parse JSON file. Please check the format.');\n        }\n      };\n      reader.readAsText(file);\n    };\n    input.click();\n  };\n\n  const handleExportPDF = () => {\n    alert('PDF export coming soon! This will generate a 30-day forecast PDF.');\n  };\n\n  const handleExportSnapshotPDF = () => {\n    alert('Snapshot PDF export coming soon! This will generate a cash flow snapshot PDF.');\n  };\n\n  return (\n    <Layout\n      onExportJSON={handleExportJSON}\n      onImportJSON={handleImportJSON}\n      onExportPDF={handleExportPDF}\n      onExportSnapshotPDF={handleExportSnapshotPDF}\n    >\n      <TabNavigation activeTab={activeTab} onTabChange={setActiveTab} />\n\n      <main>\n        {activeTab === 'dashboard' && <Dashboard />}\n        {activeTab === 'whatif' && <WhatIf />}\n        {activeTab === 'movements' && <CashMovements />}\n        {activeTab === 'income' && <IncomePlan />}\n        {activeTab === 'receivables' && <Receivables />}\n      </main>\n    </Layout>\n  );\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.tsx'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)\n"],"names":["f","require$$0","k","l","m","n","p","q","c","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","client","createStoreImpl","createState","state","listeners","setState","partial","replace","nextState","previousState","listener","getState","api","initialState","__vite_import_meta_env__","createStore","React","is","x","y","objectIs","useState","useEffect","useLayoutEffect","useDebugValue","useSyncExternalStore$2","subscribe","getSnapshot","value","_useState","inst","forceUpdate","checkIfSnapshotChanged","latestGetSnapshot","nextValue","useSyncExternalStore$1","shim","useSyncExternalStoreShim_production","shimModule","require$$1","useSyncExternalStore","useRef","useMemo","withSelector_production","getServerSnapshot","selector","isEqual","instRef","memoizedSelector","nextSnapshot","hasMemo","memoizedSnapshot","currentSelection","memoizedSelection","nextSelection","maybeGetServerSnapshot","withSelectorModule","ReactExports","useSyncExternalStoreWithSelector","useSyncExternalStoreExports","didWarnAboutEqualityFn","identity","arg","useStore","equalityFn","slice","createImpl","useBoundStore","create","createJSONStorage","getStorage","options","storage","name","_a","parse","str2","str","newValue","toThenable","fn","input","result","onFulfilled","_onRejected","_onFulfilled","onRejected","oldImpl","config","baseOptions","set","get","persistedState","currentState","hasHydrated","hydrationListeners","finishHydrationListeners","args","thenableSerialize","setItem","errorInSync","thenable","serializedValue","savedSetState","configResult","stateFromStorage","hydrate","cb","postRehydrationCallback","storageValue","deserializedStorageValue","migratedState","_a2","newOptions","newImpl","_b","migrationResult","migrated","persistImpl","persist","pad","toYMD","date","fromYMD","year","month","day","compareYMD","a","monthsBetween","start","end","diff","todayYMD","ONE_OFF_SORT_KEYS","DEFAULT_END","normalizeWeekdayArray","raw","seen","days","item","num","normalized","clamp","normalizeFirstWeekday","fallback","normalizeNthDescriptor","trimmed","parsed","int","uid","round2","min","max","clampPercent","clampCurrency","defaultOneOffSortState","sanitizeOneOffSortState","defaults","obj","key","direction","isValidYMDString","sanitizeSteps","step","stepObj","effectiveFrom","amount","sanitizeOneOff","entry","strict","entryObj","type","baseResult","resultWithNote","steps","escalator","escalatorPct","frequency","startDate","endDate","recurringResult","startDow","startDom","onDate","weekdays","mode","rawDom","dom","sanitizeStream","startVsEnd","normalizedStart","normalizedEnd","id","startDateObj","stream","defaultState","normalizeState","rawObj","base","rawSettings","rawUi","ensureArray","sanitizeList","list","fallbackStart","fallbackEnd","mapped","streamObj","candidate","sb","STORAGE_KEY","loadState","data","saveState","getDefaultState","today","endOfYear","getInitialState","loaded","err","useAppStore","settings","newState","adjustment","adj","transaction","t","oneOffs","s","streams","sort","Layout","children","onExportJSON","onImportJSON","onExportPDF","onExportSnapshotPDF","jsxs","jsx","TabNavigation","activeTab","onTabChange","tabs","tab","toWeekdayArray","normalizeNth","firstWeekday","isBetween","matchesMonthlyByDay","dayOfMonth","lastDay","target","matchesMonthlyByNthWeekday","nth","weekday","nthValue","targetDow","firstDow","firstOccurrenceDay","occurrences","i","idx","matchesWeekly","matchesBiweekly","anchor","dow","deltaToDow","shouldApplyStreamOn","getBaseAmountForDate","current","nextAmount","resolveRecurringAmount","prevDate","baseAmount","factor","describeNameAndCategory","parts","deduplicateTransactions","transactions","tx","fmtMoney","generateCalendar","startYMD","endYMD","rows","cursor","computeProjection","overrides","getStreamMultiplier","transformStreamAmount","saleConfig","saleEntries","rawEntry","rawEnd","pct","topup","lastEdited","saleEnabled","incomeStreams","adjustments","calendar","byDate","row","recurring","singles","totalStreamIncome","absAmount","label","signed","incomeLastOccurrence","index","prev","adjustedAmount","transformed","multiplierValue","appliedMultiplier","txLastOccurrence","running","totalIncome","totalExpenses","lowestBalance","lowestBalanceDate","peakBalance","peakBalanceDate","firstNegativeDate","negativeDays","baseIncomeBeforeSales","isBusinessDay","windowLabel","boost","projectedWeeklyIncome","totalWeeks","lineColors","createSegmentColor","ctx","chart","p0DataIndex","p1DataIndex","meta","point0","point1","y0","y1","canvas","ctx2d","gradient","ratio","startColor","endColor","midColor","balanceChartOptions","balanceChartInstance","destroyChart","chartInstance","getExistingChart","existingChart","renderBalanceChart","projection","cal","labels","r","Dashboard","updateSettings","addAdjustment","removeAdjustment","setProjection","chartCanvasRef","chartInstanceRef","adjDate","setAdjDate","adjAmount","setAdjAmount","adjNote","setAdjNote","handleSettingsSubmit","formData","handleAdjustmentSubmit","handleRemoveAdjustment","fmtDate","ymd","upcomingDays","Fragment","WhatIf","actualProjection","setActualProjection","whatIfProjection","setWhatIfProjection","tweaks","setTweaks","tweakedStreams","streamTweak","multiplier","handlePullFromActuals","handleGlobalPctChange","handleGlobalDeltaChange","delta","fmtDelta","val","CashMovements","addOneOff","updateOneOff","removeOneOff","setOneOffs","isRecurring","setIsRecurring","editingId","setEditingId","setFormData","handleSubmit","resetForm","handleEdit","handleRemove","handleDeduplicate","deduplicated","removedCount","getScheduleLabel","IncomePlan","addIncomeStream","updateIncomeStream","removeIncomeStream","dayNames","Receivables","arOptions","setArOptions","invoices","setInvoices","selectedInvoices","setSelectedInvoices","handleFileUpload","file","reader","event","line","values","v","handlePreview","handleImport","toImport","inv","dueDate","expectedDate","handleSelectAll","toggleInvoiceSelection","newSelection","App","setActiveTab","importData","handleExportJSON","blob","url","handleImportJSON","handleExportPDF","handleExportSnapshotPDF","ReactDOM"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9]}