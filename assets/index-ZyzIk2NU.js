import{r as k,a as We,g as Re,R as be}from"./vendor-F9Y4d3HK.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var ve={exports:{}},te={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pe=k,Be=Symbol.for("react.element"),Te=Symbol.for("react.fragment"),_e=Object.prototype.hasOwnProperty,$e=Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qe={key:!0,ref:!0,__self:!0,__source:!0};function De(t,a,n){var r,s={},o=null,c=null;n!==void 0&&(o=""+n),a.key!==void 0&&(o=""+a.key),a.ref!==void 0&&(c=a.ref);for(r in a)_e.call(a,r)&&!qe.hasOwnProperty(r)&&(s[r]=a[r]);if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Be,type:t,key:o,ref:c,props:s,_owner:$e.current}}te.Fragment=Te;te.jsx=De;te.jsxs=De;ve.exports=te;var e=ve.exports,re={},he=We;re.createRoot=he.createRoot,re.hydrateRoot=he.hydrateRoot;const Le={},fe=t=>{let a;const n=new Set,r=(y,g)=>{const j=typeof y=="function"?y(a):y;if(!Object.is(j,a)){const x=a;a=g??(typeof j!="object"||j===null)?j:Object.assign({},a,j),n.forEach(i=>i(a,x))}},s=()=>a,p={setState:r,getState:s,getInitialState:()=>u,subscribe:y=>(n.add(y),()=>n.delete(y)),destroy:()=>{(Le?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=a=t(r,s,p);return p},Ue=t=>t?fe(t):fe;var Ne={exports:{}},Se={},ke={exports:{}},we={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J=k;function ze(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var Je=typeof Object.is=="function"?Object.is:ze,Ye=J.useState,He=J.useEffect,Ge=J.useLayoutEffect,Ve=J.useDebugValue;function Ke(t,a){var n=a(),r=Ye({inst:{value:n,getSnapshot:a}}),s=r[0].inst,o=r[1];return Ge(function(){s.value=n,s.getSnapshot=a,ae(s)&&o({inst:s})},[t,n,a]),He(function(){return ae(s)&&o({inst:s}),t(function(){ae(s)&&o({inst:s})})},[t]),Ve(n),n}function ae(t){var a=t.getSnapshot;t=t.value;try{var n=a();return!Je(t,n)}catch{return!0}}function Qe(t,a){return a()}var Ze=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Qe:Ke;we.useSyncExternalStore=J.useSyncExternalStore!==void 0?J.useSyncExternalStore:Ze;ke.exports=we;var Xe=ke.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ne=k,et=Xe;function tt(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var nt=typeof Object.is=="function"?Object.is:tt,at=et.useSyncExternalStore,st=ne.useRef,rt=ne.useEffect,ot=ne.useMemo,it=ne.useDebugValue;Se.useSyncExternalStoreWithSelector=function(t,a,n,r,s){var o=st(null);if(o.current===null){var c={hasValue:!1,value:null};o.current=c}else c=o.current;o=ot(function(){function p(x){if(!u){if(u=!0,y=x,x=r(x),s!==void 0&&c.hasValue){var i=c.value;if(s(i,x))return g=i}return g=x}if(i=g,nt(y,x))return i;var l=r(x);return s!==void 0&&s(i,l)?(y=x,i):(y=x,g=l)}var u=!1,y,g,j=n===void 0?null:n;return[function(){return p(a())},j===null?void 0:function(){return p(j())}]},[a,n,r,s]);var m=at(t,o[0],o[1]);return rt(function(){c.hasValue=!0,c.value=m},[m]),it(m),m};Ne.exports=Se;var lt=Ne.exports;const ct=Re(lt),Oe={},{useDebugValue:dt}=be,{useSyncExternalStoreWithSelector:ut}=ct;let pe=!1;const mt=t=>t;function ht(t,a=mt,n){(Oe?"production":void 0)!=="production"&&n&&!pe&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),pe=!0);const r=ut(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,n);return dt(r),r}const ft=t=>{(Oe?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof t=="function"?Ue(t):t,n=(r,s)=>ht(a,r,s);return Object.assign(n,a),n},pt=t=>ft,gt={};function yt(t,a){let n;try{n=t()}catch{return}return{getItem:s=>{var o;const c=p=>p===null?null:JSON.parse(p,void 0),m=(o=n.getItem(s))!=null?o:null;return m instanceof Promise?m.then(c):c(m)},setItem:(s,o)=>n.setItem(s,JSON.stringify(o,void 0)),removeItem:s=>n.removeItem(s)}}const V=t=>a=>{try{const n=t(a);return n instanceof Promise?n:{then(r){return V(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return V(r)(n)}}}},jt=(t,a)=>(n,r,s)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:f=>f,version:0,merge:(f,b)=>({...b,...f}),...a},c=!1;const m=new Set,p=new Set;let u;try{u=o.getStorage()}catch{}if(!u)return t((...f)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...f)},r,s);const y=V(o.serialize),g=()=>{const f=o.partialize({...r()});let b;const d=y({state:f,version:o.version}).then(D=>u.setItem(o.name,D)).catch(D=>{b=D});if(b)throw b;return d},j=s.setState;s.setState=(f,b)=>{j(f,b),g()};const x=t((...f)=>{n(...f),g()},r,s);let i;const l=()=>{var f;if(!u)return;c=!1,m.forEach(d=>d(r()));const b=((f=o.onRehydrateStorage)==null?void 0:f.call(o,r()))||void 0;return V(u.getItem.bind(u))(o.name).then(d=>{if(d)return o.deserialize(d)}).then(d=>{if(d)if(typeof d.version=="number"&&d.version!==o.version){if(o.migrate)return o.migrate(d.state,d.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return d.state}).then(d=>{var D;return i=o.merge(d,(D=r())!=null?D:x),n(i,!0),g()}).then(()=>{b==null||b(i,void 0),c=!0,p.forEach(d=>d(i))}).catch(d=>{b==null||b(void 0,d)})};return s.persist={setOptions:f=>{o={...o,...f},f.getStorage&&(u=f.getStorage())},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>l(),hasHydrated:()=>c,onHydrate:f=>(m.add(f),()=>{m.delete(f)}),onFinishHydration:f=>(p.add(f),()=>{p.delete(f)})},l(),i||x},xt=(t,a)=>(n,r,s)=>{let o={storage:yt(()=>localStorage),partialize:l=>l,version:0,merge:(l,f)=>({...f,...l}),...a},c=!1;const m=new Set,p=new Set;let u=o.storage;if(!u)return t((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...l)},r,s);const y=()=>{const l=o.partialize({...r()});return u.setItem(o.name,{state:l,version:o.version})},g=s.setState;s.setState=(l,f)=>{g(l,f),y()};const j=t((...l)=>{n(...l),y()},r,s);s.getInitialState=()=>j;let x;const i=()=>{var l,f;if(!u)return;c=!1,m.forEach(d=>{var D;return d((D=r())!=null?D:j)});const b=((f=o.onRehydrateStorage)==null?void 0:f.call(o,(l=r())!=null?l:j))||void 0;return V(u.getItem.bind(u))(o.name).then(d=>{if(d)if(typeof d.version=="number"&&d.version!==o.version){if(o.migrate)return[!0,o.migrate(d.state,d.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,d.state];return[!1,void 0]}).then(d=>{var D;const[w,C]=d;if(x=o.merge(C,(D=r())!=null?D:j),n(x,!0),w)return y()}).then(()=>{b==null||b(x,void 0),x=r(),c=!0,p.forEach(d=>d(x))}).catch(d=>{b==null||b(void 0,d)})};return s.persist={setOptions:l=>{o={...o,...l},l.storage&&(u=l.storage)},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>i(),hasHydrated:()=>c,onHydrate:l=>(m.add(l),()=>{m.delete(l)}),onFinishHydration:l=>(p.add(l),()=>{p.delete(l)})},o.skipHydration||i(),x||j},bt=(t,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?((gt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),jt(t,a)):xt(t,a),vt=bt,ge=t=>String(t).padStart(2,"0"),Q=t=>`${t.getFullYear()}-${ge(t.getMonth()+1)}-${ge(t.getDate())}`,I=t=>{const[a,n,r]=String(t||"").split("-").map(Number);return new Date(a,(n||1)-1,r||1)},q=(t,a)=>String(t||"").localeCompare(String(a||"")),Dt=(t,a)=>{if(!(t instanceof Date)||!(a instanceof Date))return 0;const n=(a.getFullYear()-t.getFullYear())*12+(a.getMonth()-t.getMonth());return Math.max(0,n)},Nt=Q(new Date),St=["date","schedule","type","name","category","next"],kt="2025-12-31",K=t=>{if(t==null)return[];const a=Array.isArray(t)?t:typeof t=="string"&&t.includes(",")?t.split(/[\s,]+/):[t],n=new Set,r=[];for(const s of a){if(s==null)continue;const o=String(s).trim();if(!o)continue;const c=Number(o);if(!Number.isFinite(c))continue;const m=_(Math.trunc(c),0,6);n.has(m)||(n.add(m),r.push(m))}return r.sort((s,o)=>s-o)},Ee=(t,a=0)=>{const n=K(t);if(n.length)return n[0];const r=Number(t);return Number.isFinite(r)?_(Math.trunc(r),0,6):_(Number(a)||0,0,6)},Fe=t=>{if(t==null)return"1";if(typeof t=="string"){const a=t.trim().toLowerCase();if(a==="last")return"last";const n=Number.parseInt(a,10);if(Number.isFinite(n)&&n>=1&&n<=5)return String(n)}if(typeof t=="number"&&Number.isFinite(t)){const a=Math.trunc(t);if(a>=1&&a<=5)return String(a)}return"1"},ce=()=>Math.random().toString(36).slice(2,9),wt=t=>{const a=Number(t);return Number.isFinite(a)?Math.round(a*100)/100:0},_=(t,a,n)=>Math.max(a,Math.min(n,t)),Ot=(t,{min:a=-1,max:n=2,fallback:r=0}={})=>{const s=Number(t);return Number.isFinite(s)?Math.max(a,Math.min(n,Math.round(s*1e3)/1e3)):r},Et=(t,a=0)=>{const n=Number(t);return Number.isFinite(n)?wt(n):a},Ae=()=>({key:"date",direction:"asc"}),Ft=t=>{const a=Ae();if(!t||typeof t!="object")return a;const n=t,r=St.includes(n.key)?n.key:a.key,s=n.direction==="desc"?"desc":a.direction;return{key:r,direction:s}},$=t=>{if(typeof t!="string"||!t)return!1;const a=I(t);return Number.isNaN(a.getTime())?!1:Q(a)===t},Ie=t=>Array.isArray(t)?t.map(a=>{if(!a||typeof a!="object"||Array.isArray(a))return null;const n=a,r=typeof n.effectiveFrom=="string"&&$(n.effectiveFrom)?n.effectiveFrom:null,s=Number(n.amount||0);return!r||!Number.isFinite(s)?null:{effectiveFrom:r,amount:Math.abs(s)}}).filter(a=>a!==null).sort((a,n)=>q(a.effectiveFrom,n.effectiveFrom)):[],ye=(t,a=!1)=>{if(!t||typeof t!="object"||Array.isArray(t)){if(a)throw new Error("Invalid one-off record");return null}const n=t,r=Number(n.amount||0);if(!Number.isFinite(r)){if(a)throw new Error("Invalid one-off amount");return null}const s=n.type==="income"?"income":"expense",c={id:typeof n.id=="string"?n.id:ce(),type:s,name:typeof n.name=="string"?n.name:"",category:typeof n.category=="string"?n.category:"",amount:Math.abs(r),recurring:!!n.recurring},m=typeof n.note=="string"?{...c,note:n.note}:c,p=Ie(n.steps),u=Number(n.escalatorPct||0),y=Number.isFinite(u)?u:0;if(c.recurring){const g=typeof n.frequency=="string"?n.frequency:null,j=typeof n.startDate=="string"?n.startDate:null,x=typeof n.endDate=="string"?n.endDate:typeof n.date=="string"?n.date:null;if(!(g&&j&&x&&$(j)&&$(x))){if(a)throw new Error("Invalid recurring one-off metadata");return null}const l={...m,recurring:!0,frequency:g,startDate:j,endDate:x,steps:p,escalatorPct:y},f=I(j),b=Number.isNaN(f.getTime())?0:f.getDay(),d=Number.isNaN(f.getTime())?1:f.getDate();if(q(l.startDate,l.endDate)>0){if(a)throw new Error("Invalid recurring one-off range");l.endDate=l.startDate}const D=typeof n.onDate=="string"?n.onDate:null;if(D&&(l.onDate=D),g==="daily"&&(l.skipWeekends=!!n.skipWeekends),g==="weekly"||g==="biweekly"){const w=K(n.dayOfWeek);l.dayOfWeek=w.length?w:[b]}if(g==="monthly"){const w=n.monthlyMode==="nth"?"nth":"day";if(l.monthlyMode=w,w==="nth"){const C=K(n.dayOfWeek);C.length&&(l.dayOfWeek=C),l.nthWeek=Fe(n.nthWeek??n.nthWeekNumber),l.nthWeekday=Ee(n.nthWeekday??n.dayOfWeek,b)}else{const C=Number(n.dayOfMonth),v=Number.isFinite(C)?Math.trunc(C):d;l.dayOfMonth=_(v,1,31)}}return l}else{const g=typeof n.date=="string"?n.date:null;if(!g){if(a)throw new Error("Invalid one-off date");return null}return{...m,recurring:!1,date:g,steps:[],escalatorPct:0}}},At=(t,a=!1)=>{if(!t||typeof t!="object"||Array.isArray(t)){if(a)throw new Error("Invalid income stream record");return null}const n=t,r=Number(n.amount||0);if(!Number.isFinite(r)){if(a)throw new Error("Invalid income stream amount");return null}const s=typeof n.frequency=="string"?n.frequency:"once",o=typeof n.startDate=="string"?n.startDate:typeof n.onDate=="string"?n.onDate:null,c=typeof n.endDate=="string"?n.endDate:typeof n.onDate=="string"?n.onDate:null;if(!(o&&c&&$(o)&&$(c))){if(a)throw new Error("Invalid income stream date range");return null}const p=q(o,c),u=p<=0?o:c,y=p<=0?c:o,g=typeof n.id=="string"?n.id:ce(),j=I(u),x=Number.isNaN(j.getTime())?0:j.getDay(),i=Number.isNaN(j.getTime())?1:j.getDate(),l={id:g,name:typeof n.name=="string"?n.name:"",category:typeof n.category=="string"?n.category:"",amount:Math.abs(r),frequency:s,startDate:u,endDate:y,onDate:typeof n.onDate=="string"?n.onDate:null,skipWeekends:!!n.skipWeekends,steps:Ie(n.steps),escalatorPct:Number.isFinite(Number(n.escalatorPct||0))?Number(n.escalatorPct||0):0};if(s==="once"&&(l.onDate=typeof n.onDate=="string"?n.onDate:l.startDate),s==="daily"&&(l.skipWeekends=!!n.skipWeekends),s==="weekly"||s==="biweekly"){const f=K(n.dayOfWeek);l.dayOfWeek=f.length?f:[x]}if(s==="monthly"){const f=n.monthlyMode==="nth"?"nth":"day";if(l.monthlyMode=f,f==="nth"){const b=K(n.dayOfWeek);b.length&&(l.dayOfWeek=b),l.nthWeek=Fe(n.nthWeek??n.nthWeekNumber),l.nthWeekday=Ee(n.nthWeekday??n.dayOfWeek,x)}else{const b=Number(n.dayOfMonth),d=Number.isFinite(b)?Math.trunc(b):i;l.dayOfMonth=_(d,1,31)}}return l},oe=()=>({settings:{startDate:Nt,endDate:kt,startingBalance:0},adjustments:[],oneOffs:[],incomeStreams:[],ui:{oneOffSort:Ae()}}),It=(t,{strict:a=!1}={})=>{if(!t||typeof t!="object"||Array.isArray(t))throw new Error("Invalid state payload");const n=t,r=oe(),s={...r,...n},o=n.settings;if(o&&typeof o=="object"&&!Array.isArray(o))s.settings={...r.settings,...o};else{if(a)throw new Error("Invalid settings data");s.settings={...r.settings}}if(n.ui&&typeof n.ui=="object"&&!Array.isArray(n.ui)){const u=n.ui;s.ui={...r.ui,...u},s.ui.oneOffSort=Ft(u.oneOffSort)}else{if(a&&n.ui!==void 0)throw new Error("Invalid ui data");s.ui={...r.ui}}const c=u=>{const y=n[u]??s[u];if(y===void 0){s[u]=[];return}if(!Array.isArray(y)){if(a)throw new Error(`Invalid ${u}; expected an array`);s[u]=[];return}s[u]=y};c("adjustments"),c("oneOffs"),c("incomeStreams");const m=u=>u.map(y=>ye(y,a)).filter(y=>y!==null);if(s.oneOffs=m(s.oneOffs),s.incomeStreams=s.incomeStreams.map(u=>At(u,a)).filter(u=>u!==null),Array.isArray(n.expenseStreams)&&n.expenseStreams.length){const u=s.settings.startDate,y=s.settings.endDate,g=n.expenseStreams.map(j=>{if(!j||typeof j!="object"||Array.isArray(j)){if(a)throw new Error("Invalid legacy expense stream");return null}const x=j,i={...x,id:typeof x.id=="string"?x.id:ce(),type:"expense",recurring:!0,date:typeof x.startDate=="string"?x.startDate:x.onDate,startDate:typeof x.startDate=="string"?x.startDate:u,endDate:typeof x.endDate=="string"?x.endDate:y};return ye(i,a)}).filter(j=>j!==null);g.length&&(s.oneOffs=[...s.oneOffs,...g])}if(delete s.expenseStreams,typeof s.settings.startDate!="string"){if(a)throw new Error("Invalid settings.startDate");s.settings.startDate=r.settings.startDate}if(typeof s.settings.endDate!="string"){if(a)throw new Error("Invalid settings.endDate");s.settings.endDate=r.settings.endDate}if(!$(s.settings.startDate)){if(a)throw new Error("Invalid settings.startDate format");s.settings.startDate=r.settings.startDate}if(!$(s.settings.endDate)){if(a)throw new Error("Invalid settings.endDate format");s.settings.endDate=r.settings.endDate}if(q(s.settings.startDate,s.settings.endDate)>0){if(a)throw new Error("Invalid settings date range");s.settings.endDate=s.settings.startDate}const p=Number(s.settings.startingBalance);if(Number.isFinite(p))s.settings.startingBalance=p;else{if(a)throw new Error("Invalid settings.startingBalance");s.settings.startingBalance=r.settings.startingBalance}return s},Ce="cashflow2025_v1",Ct=()=>{try{const t=localStorage.getItem(Ce);if(!t)return oe();const a=JSON.parse(t);return It(a,{strict:!1})}catch{return oe()}},R=t=>{localStorage.setItem(Ce,JSON.stringify(t))},ie=()=>{const t=new Date().toISOString().slice(0,10),a=new Date(new Date().getFullYear(),11,31).toISOString().slice(0,10);return{settings:{startDate:t,endDate:a,startingBalance:0},adjustments:[],oneOffs:[],incomeStreams:[],ui:{oneOffSort:{key:"date",direction:"asc"}}}},Mt=()=>{try{const t=Ct();if(t)return{...ie(),...t}}catch(t){console.warn("Failed to load state from storage:",t)}return ie()},Y=pt()(vt(t=>({...Mt(),updateSettings:a=>{t(n=>{const r={...n,settings:{...n.settings,...a}};return R(r),r})},addAdjustment:a=>{t(n=>{const r={...n,adjustments:[...n.adjustments,a]};return R(r),r})},removeAdjustment:a=>{t(n=>{const r={...n,adjustments:n.adjustments.filter(s=>s.date!==a)};return R(r),r})},addOneOff:a=>{t(n=>{const r={...n,oneOffs:[...n.oneOffs,a]};return R(r),r})},updateOneOff:(a,n)=>{t(r=>{const s={...r,oneOffs:r.oneOffs.map(o=>o.id===a?n:o)};return R(s),s})},removeOneOff:a=>{t(n=>{const r={...n,oneOffs:n.oneOffs.filter(s=>s.id!==a)};return R(r),r})},setOneOffs:a=>{t(n=>{const r={...n,oneOffs:a};return R(r),r})},addIncomeStream:a=>{t(n=>{const r={...n,incomeStreams:[...n.incomeStreams,a]};return R(r),r})},updateIncomeStream:(a,n)=>{t(r=>{const s={...r,incomeStreams:r.incomeStreams.map(o=>o.id===a?n:o)};return R(s),s})},removeIncomeStream:a=>{t(n=>{const r={...n,incomeStreams:n.incomeStreams.filter(s=>s.id!==a)};return R(r),r})},setIncomeStreams:a=>{t(n=>{const r={...n,incomeStreams:a};return R(r),r})},setOneOffSort:a=>{t(n=>({...n,ui:{...n.ui,oneOffSort:a}}))},importData:a=>{t(n=>{const r={...n,...a};return R(r),r})},resetToDefaults:()=>{const a=ie();t(a),R(a)}}),{name:"cashflow-tracker-storage"}));function Wt({children:t,onExportJSON:a,onImportJSON:n,onExportPDF:r,onExportSnapshotPDF:s}){return e.jsxs("div",{className:"app-shell",children:[e.jsxs("header",{className:"app-header",children:[e.jsx("h1",{children:"2025 Cash Flow"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:a,className:"btn",children:"Export JSON"}),e.jsx("button",{onClick:r,className:"btn",children:"Next 30 Days PDF"}),e.jsx("button",{onClick:s,className:"btn",children:"Cash Flow Snapshot PDF"}),e.jsx("button",{onClick:n,className:"btn btn-outline",children:"Import JSON"})]})]}),t,e.jsx("footer",{className:"app-footer",children:e.jsx("small",{children:"All data is stored locally in your browser. ðŸ’¾"})})]})}function Rt({activeTab:t,onTabChange:a}){const n=[{id:"dashboard",label:"Dashboard"},{id:"whatif",label:"What-If"},{id:"movements",label:"Cash Movements"},{id:"income",label:"Income Plan"},{id:"receivables",label:"Receivables (AR)"}];return e.jsx("nav",{className:"tabs",children:n.map(r=>e.jsx("button",{className:`tab ${t===r.id?"active":""}`,onClick:()=>a(r.id),"data-tab":r.id,children:r.label},r.id))})}const de=t=>{if(t==null)return[];const a=Array.isArray(t)?t:typeof t=="string"&&t.includes(",")?t.split(/[\s,]+/):[t],n=new Set,r=[];for(const s of a){if(s==null)continue;const o=String(s).trim();if(!o)continue;const c=Number(o);if(!Number.isFinite(c))continue;const m=_(Math.trunc(c),0,6);n.has(m)||(n.add(m),r.push(m))}return r.sort((s,o)=>s-o)},Pt=t=>{if(t==null)return"1";if(typeof t=="string"){const a=t.trim().toLowerCase();if(a==="last")return"last";const n=Number.parseInt(a,10);if(Number.isFinite(n)&&n>=1&&n<=5)return String(n)}if(typeof t=="number"&&Number.isFinite(t)){const a=Math.trunc(t);if(a>=1&&a<=5)return String(a)}return"1"},Bt=(t,a=0)=>{const n=de(t);if(n.length)return n[0];const r=Number(t);return Number.isFinite(r)?_(Math.trunc(r),0,6):_(Number(a)||0,0,6)},Tt=(t,a,n)=>t>=a&&t<=n,_t=(t,a)=>{const n=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),r=_(a,1,n);return t.getDate()===r},$t=(t,a,n)=>{const r=Pt(a),s=Bt(n,0),c=new Date(t.getFullYear(),t.getMonth(),1).getDay(),m=1+(s-c+7)%7,p=[],u=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();for(let g=0;g<6;g+=1){const j=m+g*7;if(j>u)break;p.push(j)}if(!p.length)return!1;if(r==="last")return t.getDate()===p[p.length-1];const y=Number(r)-1;return!Number.isFinite(y)||y<0||y>=p.length?!1:t.getDate()===p[y]},qt=(t,a)=>{const n=de(a);return n.length?n.includes(t.getDay()):!1},Lt=(t,a,n)=>{const r=de(a);return r.length?r.some(s=>{if(t.getDay()!==s)return!1;const o=new Date(n.getTime()),c=(s-o.getDay()+7)%7;return o.setDate(o.getDate()+c),t<o?!1:Math.floor((t.getTime()-o.getTime())/(1e3*60*60*24))%14===0}):!1},je=(t,a)=>{if(!a||typeof a!="object")return!1;const n=I(a.startDate),r=I(a.endDate);if(Number.isNaN(n.getTime())||Number.isNaN(r.getTime())||!Tt(t,n,r))return!1;switch(a.frequency){case"once":return!!(a.onDate&&Q(t)===a.onDate);case"daily":return!(a.skipWeekends&&(t.getDay()===0||t.getDay()===6));case"weekly":return qt(t,a.dayOfWeek);case"biweekly":return Lt(t,a.dayOfWeek,n);case"monthly":return a.monthlyMode==="nth"?$t(t,a.nthWeek,a.nthWeekday):_t(t,Number(a.dayOfMonth||1));default:return!1}},Ut=(t,a)=>{const n=Number((t==null?void 0:t.amount)||0);if(!Array.isArray(t==null?void 0:t.steps)||t.steps.length===0)return Math.abs(n)||0;const r=Q(a);let s=Math.abs(n)||0;for(const o of t.steps){const c=typeof(o==null?void 0:o.effectiveFrom)=="string"?o.effectiveFrom:null;if(!c||q(c,r)>0)break;const m=Number(o.amount||0);Number.isFinite(m)&&(s=Math.abs(m))}return s},xe=(t,a,n)=>{const r=Math.abs(Number(Ut(t,a)||0));if(!r)return 0;const s=Number((t==null?void 0:t.escalatorPct)||0);if(!n||!Number.isFinite(s)||s===0)return r;const o=Dt(n,a);if(!o)return r;const c=Math.pow(1+s/100,o);return r*c},se=(t,a)=>{if(!t||typeof t!="object")return a;const n=[];return t.name&&n.push(t.name),t.category&&n.push(t.category),!n.length&&t.note&&n.push(t.note),n.join(" â€“ ")||a},zt=t=>{const a=new Set;return t.filter(n=>{const r=n.recurring?`${n.name}|${n.category}|${n.amount}|${n.startDate}|${n.endDate}`:`${n.name}|${n.category}|${n.amount}|${n.date}`;return a.has(r)?!1:(a.add(r),!0)})},S=t=>(t<0?"-$":"$")+Math.abs(Number(t)||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),B=t=>{const a=Number(t);return Number.isFinite(a)?Math.round(a*100)/100:0},Jt=(t,a)=>{const n=I(t),r=I(a),s=[];for(let o=new Date(n);o<=r;o.setDate(o.getDate()+1))s.push({date:Q(o),income:0,expenses:0,net:0,running:0,incomeDetails:[],expenseDetails:[]});return s},le=(t,a={})=>{const n=typeof a.getStreamMultiplier=="function"?a.getStreamMultiplier:()=>1,r=typeof a.transformStreamAmount=="function"?a.transformStreamAmount:null,s=a.sale&&typeof a.sale=="object"?a.sale:null,o=[];if(s&&s.enabled&&Array.isArray(s.entries))for(const h of s.entries){if(!h||typeof h!="object")continue;const O=$(h.startDate)?h.startDate:null;if(!O)continue;const E=$(h.endDate)?h.endDate:O,F=Ot(h.pct,{min:-1,max:5,fallback:0}),N=Et(h.topup,0),W=h.lastEdited==="topup"?"topup":"pct",M=q(O,E)>0?O:E;o.push({id:h.id,startDate:O,endDate:M,pct:F,topup:N,lastEdited:W,businessDaysOnly:!!h.businessDaysOnly})}const c=o.length>0,{settings:m,oneOffs:p=[],incomeStreams:u=[],adjustments:y=[]}=t||{};if(!m)throw new Error("State missing settings for projection");const g=Jt(m.startDate,m.endDate),j=new Map(g.map(h=>[h.date,h])),x=p.filter(h=>h&&typeof h=="object"&&h.recurring),i=p.filter(h=>h&&typeof h=="object"&&!h.recurring&&!(h.source==="AR"&&h.status==="archived"));let l=0;for(const h of i){if(!("date"in h)||typeof h.date!="string")continue;const O=j.get(h.date);if(!O)continue;const E=Number(h.amount||0);if(!E)continue;const F=Math.abs(E),N=se(h,h.type==="expense"?"Expense":"Income");if(h.type==="expense")O.expenses+=F,O.expenseDetails.push({source:N,amount:F});else{const W=E>=0?F:-F;O.income+=W,O.incomeDetails.push({source:N,amount:W})}}const f=new Map;u.forEach((h,O)=>{if(!h||typeof h!="object")return;const E=`stream:${typeof h.id=="string"?h.id:O}`;for(const F of g){const N=I(F.date);if(!je(N,h))continue;const W=f.get(E)||null,M=xe(h,N,W);if(M){const T=Math.abs(M),ee=se(h,"Income Stream");let U=T;if(r){const z=Number(r({stream:h,baseAmount:T,date:F.date}));U=Number.isFinite(z)&&z>=0?B(z):0}else{const z=Number(n(h,T,F.date)),Me=Number.isFinite(z)?Math.max(0,z):1;U=B(T*Me)}U&&(F.income+=U,F.incomeDetails.push({source:ee,amount:U}),l+=U)}f.set(E,new Date(N.getTime()))}});const b=new Map;x.forEach((h,O)=>{if(!("startDate"in h)||typeof h.startDate!="string"||!("endDate"in h)||typeof h.endDate!="string"||!("frequency"in h)||typeof h.frequency!="string")return;const E=`tx:${typeof h.id=="string"?h.id:O}`;for(const F of g){const N=I(F.date);if(!je(N,h))continue;const W=b.get(E)||null,M=xe(h,N,W);if(M){const T=Math.abs(M),ee=se(h,h.type==="expense"?"Expense":"Income");h.type==="expense"?(F.expenses+=T,F.expenseDetails.push({source:ee,amount:T})):(F.income+=T,F.incomeDetails.push({source:ee,amount:T}))}b.set(E,new Date(N.getTime()))}}),y.forEach(h=>{const O=j.get(h==null?void 0:h.date);if(!O)return;const E=Number(h.amount||0),F=h!=null&&h.note?`Adjustment â€“ ${h.note}`:"Adjustment";if(E>=0)O.income+=E,O.incomeDetails.push({source:F,amount:E});else{const N=Math.abs(E);O.expenses+=N,O.expenseDetails.push({source:F,amount:N})}});let d=B(Number(m.startingBalance||0)),D=0,w=0,C=Number.isFinite(d)?d:0,v=m.startDate||(g.length?g[0].date:""),A=C,L=v,H=null,ue=0;for(const h of g){const O=h.income;if(c){const E=I(h.date).getDay(),F=E>=1&&E<=5;for(const N of o){if(q(h.date,N.startDate)<0||q(h.date,N.endDate)>0||N.businessDaysOnly&&!F)continue;const W=N.startDate?N.endDate&&N.endDate!==N.startDate?`${N.startDate}â†’${N.endDate}`:N.startDate:N.endDate||"";if(N.lastEdited==="topup"){const M=B(N.topup);M&&(h.income+=M,h.incomeDetails.push({source:W?`Sale top-up (${W})`:"Sale top-up",amount:M}))}else if(N.pct>0){const M=B(O*N.pct);M&&(h.income+=M,h.incomeDetails.push({source:W?`Sale uplift (${W})`:"Sale uplift",amount:M}))}}}h.income=B(h.income),h.expenses=B(h.expenses),h.net=B(h.income-h.expenses),d=B(d+h.net),h.running=d,D+=h.income,w+=h.expenses,h.running<C&&(C=h.running,v=h.date),h.running>A&&(A=h.running,L=h.date),h.running<0&&(ue+=1,H||(H=h.date))}let me=0;const Z=I(m.startDate),X=I(m.endDate);if(Z instanceof Date&&X instanceof Date&&!Number.isNaN(Z.getTime())&&!Number.isNaN(X.getTime())&&X>=Z){const E=(Math.floor((X.getTime()-Z.getTime())/864e5)+1)/7;E>0&&(me=l/E)}return{cal:g,totalIncome:D,totalExpenses:w,endBalance:d,projectedWeeklyIncome:me,lowestBalance:C,lowestBalanceDate:v,peakBalance:A,peakBalanceDate:L,firstNegativeDate:H,negativeDays:ue}},P={above:"#1b5e20",below:"#b71c1c"};function Yt(t){var f,b;const{chart:a,p0DataIndex:n,p1DataIndex:r}=t,s=a.getDatasetMeta(0);if(!s||!s.data||!s.data.length)return P.above;const o=s.data[n],c=s.data[r];if(!o||!c)return P.above;const m=typeof((f=o.parsed)==null?void 0:f.y)=="number"?o.parsed.y:0,p=typeof((b=c.parsed)==null?void 0:b.y)=="number"?c.parsed.y:0;if(m>=0&&p>=0||m<0&&p<0)return m>=0?P.above:P.below;const u=a.canvas;if(!u||typeof u.getContext!="function")return P.above;const y=u.getContext("2d");if(!y)return P.above;const g=y.createLinearGradient(o.x,o.y,c.x,c.y),j=Math.abs(m)/(Math.abs(m)+Math.abs(p)),x=m>=0?P.above:P.below,i=p>=0?P.above:P.below,l=m>=0?P.below:P.above;return g.addColorStop(0,x),g.addColorStop(Math.min(Math.max(j,0),1),x),g.addColorStop(Math.min(Math.max(j,0),1),l),g.addColorStop(1,i),g}const Ht={interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1}},scales:{x:{ticks:{maxTicksLimit:10}},y:{beginAtZero:!1,grid:{color:t=>(t.tick&&typeof t.tick.value=="number"?t.tick.value:null)===0?"#0f172a":"rgba(148, 163, 184, 0.2)",lineWidth:t=>(t.tick&&typeof t.tick.value=="number"?t.tick.value:null)===0?2:1}}}};let G=null;function Gt(t){t&&typeof t.destroy=="function"&&t.destroy()}function Vt(t){const a=typeof(Chart==null?void 0:Chart.getChart)=="function"?Chart.getChart(t):null;return a&&typeof a.destroy=="function"&&a.destroy(),null}function Kt(t,a){Gt(G),Vt(t);const{cal:n}=a;if(!n||!n.length)return G=null,null;const r=n.map(c=>c.date),s=n.map(c=>B(c.running)),o=t.getContext("2d");return o?(G=new Chart(o,{type:"line",data:{labels:r,datasets:[{label:"Projected Balance",data:s,tension:.25,borderWidth:2,pointRadius:0,borderColor:P.above,segment:{borderColor:Yt},fill:{target:{value:0},above:"rgba(27, 94, 32, 0.15)",below:"rgba(183, 28, 28, 0.18)"}}]},options:Ht}),G):(G=null,null)}function Qt(){const{settings:t,adjustments:a,oneOffs:n,incomeStreams:r,updateSettings:s,addAdjustment:o,removeAdjustment:c}=Y(),[m,p]=k.useState(null),u=k.useRef(null),y=k.useRef(null),[g,j]=k.useState(""),[x,i]=k.useState(""),[l,f]=k.useState("");k.useEffect(()=>{try{const v=le({settings:t,adjustments:a,oneOffs:n,incomeStreams:r,ui:{oneOffSort:{key:"date",direction:"asc"}}});p(v)}catch(v){console.error("Projection calculation failed:",v)}},[t,a,n,r]),k.useEffect(()=>{m&&u.current&&(y.current&&y.current.destroy(),y.current=Kt(u.current,m))},[m]);const b=v=>{v.preventDefault();const A=new FormData(v.currentTarget);s({startDate:A.get("startDate"),endDate:A.get("endDate"),startingBalance:parseFloat(A.get("startingBalance"))})},d=v=>{if(v.preventDefault(),!g||!x)return;const A={date:g,amount:parseFloat(x),note:l||void 0};o(A),j(""),i(""),f("")},D=v=>{confirm("Remove this adjustment?")&&c(v)},w=v=>{if(!v)return"";try{const A=I(v);return!(A instanceof Date)||Number.isNaN(A.getTime())?v:A.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return v}},C=(m==null?void 0:m.cal.slice(0,14))||[];return e.jsxs("section",{id:"dashboard",className:"tab-panel active",children:[e.jsxs("div",{className:"card grid-2",children:[e.jsxs("form",{onSubmit:b,className:"form",children:[e.jsx("h2",{children:"Model Settings"}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"startDate",children:"Start Date"}),e.jsx("input",{id:"startDate",name:"startDate",type:"date",defaultValue:t.startDate,required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"endDate",children:"End Date"}),e.jsx("input",{id:"endDate",name:"endDate",type:"date",defaultValue:t.endDate,required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"startingBalance",children:"Starting Balance"}),e.jsx("input",{id:"startingBalance",name:"startingBalance",type:"number",step:"0.01",defaultValue:t.startingBalance,required:!0})]}),e.jsx("div",{className:"actions",children:e.jsx("button",{type:"submit",className:"btn",children:"Recalculate"})})]}),e.jsxs("div",{className:"kpis",children:[e.jsx("h2",{children:"Quick Stats"}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Projected End Balance"}),e.jsx("div",{className:"kpi-value",children:S(m.endBalance)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Total Planned Income"}),e.jsx("div",{className:"kpi-value",children:S(m.totalIncome)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Projected Weekly Income"}),e.jsx("div",{className:"kpi-value",children:S(m.projectedWeeklyIncome)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Total Planned Expenses"}),e.jsx("div",{className:"kpi-value",children:S(m.totalExpenses)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Lowest Projected Balance"}),e.jsx("div",{className:"kpi-value",children:S(m.lowestBalance)}),e.jsx("div",{className:"kpi-meta",children:w(m.lowestBalanceDate)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Peak Projected Balance"}),e.jsx("div",{className:"kpi-value",children:S(m.peakBalance)}),e.jsx("div",{className:"kpi-meta",children:w(m.peakBalanceDate)})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Days Below $0"}),e.jsx("div",{className:"kpi-value",children:m.negativeDays})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"First Negative Day"}),e.jsx("div",{className:"kpi-value",children:m.firstNegativeDate?w(m.firstNegativeDate):"â€”"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:"Projected Balance"}),e.jsx("canvas",{ref:u,id:"balanceChart",height:"100"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{children:[e.jsx("h2",{children:"Upcoming 14 Days"}),e.jsxs("table",{className:"table",id:"upcomingTable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Income"}),e.jsx("th",{children:"Expenses"}),e.jsx("th",{children:"Net"}),e.jsx("th",{children:"Running"})]})}),e.jsx("tbody",{children:C.map(v=>e.jsxs("tr",{children:[e.jsx("td",{children:w(v.date)}),e.jsx("td",{children:S(v.income)}),e.jsx("td",{children:S(v.expenses)}),e.jsx("td",{children:S(v.net)}),e.jsx("td",{children:S(v.running)})]},v.date))})]})]}),e.jsxs("div",{children:[e.jsx("h2",{children:"Adjustments"}),e.jsxs("form",{onSubmit:d,className:"form compact",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"adjDate",children:"Date"}),e.jsx("input",{id:"adjDate",type:"date",value:g,onChange:v=>j(v.target.value),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"adjAmount",children:"Amount (+/âˆ’)"}),e.jsx("input",{id:"adjAmount",type:"number",step:"0.01",value:x,onChange:v=>i(v.target.value),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"adjNote",children:"Note"}),e.jsx("input",{id:"adjNote",type:"text",placeholder:"Reconcile to bank, etc.",value:l,onChange:v=>f(v.target.value)})]}),e.jsx("div",{className:"actions",children:e.jsx("button",{className:"btn",type:"submit",children:"Add Adjustment"})})]}),e.jsxs("table",{className:"table",id:"adjTable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Note"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:a.map(v=>e.jsxs("tr",{children:[e.jsx("td",{children:w(v.date)}),e.jsx("td",{children:S(v.amount)}),e.jsx("td",{children:v.note||"â€”"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",onClick:()=>D(v.date),children:"Remove"})})]},v.date))})]})]})]})]})}function Zt(){const{settings:t,adjustments:a,oneOffs:n,incomeStreams:r}=Y(),[s,o]=k.useState(null),[c,m]=k.useState(null),[p,u]=k.useState({global:{pct:0,delta:0,lastEdited:"pct"},streams:{},sale:{enabled:!1,entries:[]},startDate:t.startDate,endDate:t.endDate});k.useEffect(()=>{try{const l=le({settings:t,adjustments:a,oneOffs:n,incomeStreams:r,ui:{oneOffSort:{key:"date",direction:"asc"}}});o(l)}catch(l){console.error("Actual projection calculation failed:",l)}},[t,a,n,r]),k.useEffect(()=>{try{const l=r.map(b=>{const d=p.streams[b.id];let D=1;return d?d.lastEdited==="pct"?D=1+d.pct/100:d.lastEdited==="delta"&&(D=(b.amount+d.delta)/b.amount):p.global.lastEdited==="pct"?D=1+p.global.pct/100:p.global.lastEdited==="delta"&&(D=(b.amount+p.global.delta)/b.amount),{...b,amount:b.amount*D}}),f=le({settings:{...t,startDate:p.startDate,endDate:p.endDate},adjustments:a,oneOffs:n,incomeStreams:l,ui:{oneOffSort:{key:"date",direction:"asc"}}});m(f)}catch(l){console.error("What-if projection calculation failed:",l)}},[t,a,n,r,p]);const y=()=>{confirm("Pull current actuals into What-If scenario?")&&u({global:{pct:0,delta:0,lastEdited:"pct"},streams:{},sale:{enabled:!1,entries:[]},startDate:t.startDate,endDate:t.endDate})},g=l=>{u({...p,global:{...p.global,pct:l,lastEdited:"pct"}})},j=l=>{u({...p,global:{...p.global,delta:l,lastEdited:"delta"}})},x=l=>{if(!l)return"";try{return I(l).toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return l}},i=l=>`${l>=0?"+":""}${S(l)}`;return e.jsxs("section",{id:"whatif",className:"tab-panel active",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h2",{children:"What-If Quick Stats"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{onClick:y,className:"btn btn-outline",children:"Pull from Actuals"})})]}),e.jsx("div",{className:"kpis whatif-kpis",children:c&&s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Projected End Balance"}),e.jsx("div",{className:"kpi-value",children:S(c.endBalance)}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",S(s.endBalance)]}),e.jsxs("div",{className:"kpi-meta",children:["Î” vs Actual:"," ",e.jsx("span",{className:"delta",children:i(c.endBalance-s.endBalance)})]})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Total Planned Income"}),e.jsx("div",{className:"kpi-value",children:S(c.totalIncome)}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",S(s.totalIncome)]})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Projected Weekly Income"}),e.jsx("div",{className:"kpi-value",children:S(c.projectedWeeklyIncome)}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",S(s.projectedWeeklyIncome)]})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Total Planned Expenses"}),e.jsx("div",{className:"kpi-value",children:S(c.totalExpenses)}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",S(s.totalExpenses)]})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Lowest Projected Balance"}),e.jsx("div",{className:"kpi-value",children:S(c.lowestBalance)}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",S(s.lowestBalance)]}),e.jsxs("div",{className:"kpi-meta",children:["Î” vs Actual:"," ",e.jsx("span",{className:"delta",children:i(c.lowestBalance-s.lowestBalance)})]})]}),e.jsxs("div",{className:"kpi",children:[e.jsx("div",{className:"kpi-label",children:"Days Below $0"}),e.jsx("div",{className:"kpi-value",children:c.negativeDays}),e.jsxs("div",{className:"kpi-meta",children:["Actual: ",s.negativeDays]}),e.jsxs("div",{className:"kpi-meta",children:["Î” vs Actual:"," ",e.jsx("span",{className:"delta",children:c.negativeDays-s.negativeDays})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:"What-If Controls"}),e.jsxs("div",{className:"whatif-controls",children:[e.jsxs("div",{className:"whatif-control-block",children:[e.jsx("h3",{children:"What-If Model Dates"}),e.jsxs("div",{className:"whatif-fields",children:[e.jsx("label",{htmlFor:"whatifStartDate",children:"Start Date"}),e.jsx("input",{id:"whatifStartDate",type:"date",value:p.startDate,onChange:l=>u({...p,startDate:l.target.value})})]}),e.jsxs("div",{className:"whatif-fields",children:[e.jsx("label",{htmlFor:"whatifEndDate",children:"End Date"}),e.jsx("input",{id:"whatifEndDate",type:"date",value:p.endDate,onChange:l=>u({...p,endDate:l.target.value})})]})]}),e.jsxs("div",{className:"whatif-control-block whatif-global-block",children:[e.jsx("h3",{children:"Global Tweaks"}),e.jsxs("div",{className:"whatif-global-grid",children:[e.jsxs("label",{className:"whatif-fields",children:[e.jsx("span",{children:"% tweak"}),e.jsxs("div",{className:"whatif-percent-inputs",children:[e.jsx("input",{id:"whatifGlobalPct",type:"number",min:"-100",max:"200",step:"1",value:p.global.pct,onChange:l=>g(parseFloat(l.target.value)||0)}),e.jsx("input",{id:"whatifGlobalPctSlider",type:"range",min:"-100",max:"200",step:"1",value:p.global.pct,onChange:l=>g(parseFloat(l.target.value))})]})]}),e.jsxs("label",{className:"whatif-fields",children:[e.jsx("span",{children:"$ tweak"}),e.jsx("input",{id:"whatifGlobalDelta",type:"number",step:"0.01",value:p.global.delta,onChange:l=>j(parseFloat(l.target.value)||0)})]})]}),e.jsxs("div",{className:"whatif-global-summary",children:[p.global.pct!==0&&e.jsxs("p",{children:["All income streams adjusted by ",p.global.pct>0?"+":"",p.global.pct,"%"]}),p.global.delta!==0&&e.jsxs("p",{children:["All income streams adjusted by ",i(p.global.delta)]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:"What-If 30-Day Outlook"}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Income"}),e.jsx("th",{children:"Expenses"}),e.jsx("th",{children:"Net"}),e.jsx("th",{children:"Running"})]})}),e.jsx("tbody",{children:c==null?void 0:c.cal.slice(0,30).map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:x(l.date)}),e.jsx("td",{children:S(l.income)}),e.jsx("td",{children:S(l.expenses)}),e.jsx("td",{children:S(l.net)}),e.jsx("td",{children:S(l.running)})]},l.date))})]})]})]})}function Xt(){const{oneOffs:t,addOneOff:a,updateOneOff:n,removeOneOff:r,setOneOffs:s}=Y(),[o,c]=k.useState(!1),[m,p]=k.useState(null),[u,y]=k.useState({type:"expense",frequency:"monthly"}),g=d=>{d.preventDefault();const D=o?{id:m||crypto.randomUUID(),name:u.name||"",category:u.category||"",amount:u.amount||0,type:u.type||"expense",recurring:!0,frequency:u.frequency||"monthly",startDate:u.startDate||"",endDate:u.endDate||"",steps:u.steps||[],escalatorPct:u.escalatorPct||0,skipWeekends:u.skipWeekends,dayOfWeek:u.dayOfWeek,monthlyMode:u.monthlyMode,dayOfMonth:u.dayOfMonth,nthWeek:u.nthWeek,nthWeekday:u.nthWeekday}:{id:m||crypto.randomUUID(),name:u.name||"",category:u.category||"",amount:u.amount||0,type:u.type||"expense",date:u.date||"",recurring:!1,steps:[],escalatorPct:0};m?(n(m,D),p(null)):a(D),j()},j=()=>{y({type:"expense",frequency:"monthly"}),c(!1),p(null)},x=d=>{y(d),c(d.recurring),p(d.id)},i=d=>{confirm("Delete this transaction?")&&r(d)},l=()=>{const d=zt(t),D=t.length-d.length;D>0?confirm(`Remove ${D} duplicate transaction(s)?`)&&s(d):alert("No duplicates found!")},f=d=>{if(!d)return"";try{return I(d).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}catch{return d}},b=d=>d.recurring?d.frequency.charAt(0).toUpperCase()+d.frequency.slice(1):"One-time";return e.jsx("section",{id:"movements",className:"tab-panel active",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h2",{children:"One-Off Transactions"}),e.jsx("div",{className:"header-actions",children:e.jsx("button",{onClick:l,className:"btn btn-outline",children:"Remove Duplicates"})})]}),e.jsxs("form",{onSubmit:g,className:"form grid-4",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooDate",children:"Date"}),e.jsx("input",{id:"ooDate",type:"date",value:u.date||"",onChange:d=>y({...u,date:d.target.value}),required:!o})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooType",children:"Type"}),e.jsxs("select",{id:"ooType",value:u.type,onChange:d=>y({...u,type:d.target.value}),children:[e.jsx("option",{value:"expense",children:"Expense"}),e.jsx("option",{value:"income",children:"Income"})]})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooName",children:"Description"}),e.jsx("input",{id:"ooName",type:"text",placeholder:"Rent, AR payment, etc.",value:u.name||"",onChange:d=>y({...u,name:d.target.value}),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooCategory",children:"Category"}),e.jsx("input",{id:"ooCategory",type:"text",placeholder:"Ops, AR, etc.",value:u.category||"",onChange:d=>y({...u,category:d.target.value})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooAmount",children:"Amount"}),e.jsx("input",{id:"ooAmount",type:"number",step:"0.01",value:u.amount||"",onChange:d=>y({...u,amount:parseFloat(d.target.value)}),required:!0})]}),e.jsx("div",{className:"field",children:e.jsxs("label",{children:[e.jsx("input",{id:"ooRepeats",type:"checkbox",checked:o,onChange:d=>c(d.target.checked)})," ","Repeats?"]})}),o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooFreq",children:"Frequency"}),e.jsxs("select",{id:"ooFreq",value:u.frequency,onChange:d=>y({...u,frequency:d.target.value}),children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"biweekly",children:"Biweekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooStart",children:"Start Date"}),e.jsx("input",{id:"ooStart",type:"date",value:u.startDate||"",onChange:d=>y({...u,startDate:d.target.value})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooEnd",children:"End Date"}),e.jsx("input",{id:"ooEnd",type:"date",value:u.endDate||"",onChange:d=>y({...u,endDate:d.target.value})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"ooEscalator",children:"Monthly Escalator (%)"}),e.jsx("input",{id:"ooEscalator",type:"number",step:"0.01",placeholder:"e.g. 2 for 2%",value:u.escalatorPct||"",onChange:d=>y({...u,escalatorPct:parseFloat(d.target.value)||0})})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",type:"submit",children:m?"Update":"Add"}),m&&e.jsx("button",{className:"btn btn-outline",type:"button",onClick:j,children:"Cancel"})]})]}),e.jsxs("table",{className:"table",id:"oneOffTable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Base Date"}),e.jsx("th",{children:"Schedule"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Category"}),e.jsx("th",{className:"num",children:"Amount"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.recurring?f(d.startDate):f(d.date)}),e.jsx("td",{children:b(d)}),e.jsx("td",{children:d.type}),e.jsx("td",{children:d.name}),e.jsx("td",{children:d.category}),e.jsx("td",{className:"num",children:S(d.amount)}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>x(d),children:"Edit"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>i(d.id),children:"Remove"})]})]},d.id))})]})]})})}function en(){const{incomeStreams:t,addIncomeStream:a,updateIncomeStream:n,removeIncomeStream:r}=Y(),[s,o]=k.useState(null),[c,m]=k.useState({frequency:"weekly",skipWeekends:!1,monthlyMode:"day",dayOfMonth:1,escalatorPct:0,steps:[]}),p=i=>{i.preventDefault();const l={id:s||crypto.randomUUID(),name:c.name||"",category:c.category||"",amount:c.amount||0,frequency:c.frequency||"weekly",startDate:c.startDate||"",endDate:c.endDate||"",onDate:c.onDate||null,skipWeekends:c.skipWeekends||!1,steps:c.steps||[],escalatorPct:c.escalatorPct||0,dayOfWeek:c.dayOfWeek,monthlyMode:c.monthlyMode,dayOfMonth:c.dayOfMonth,nthWeek:c.nthWeek,nthWeekday:c.nthWeekday};s?(n(s,l),o(null)):a(l),u()},u=()=>{m({frequency:"weekly",skipWeekends:!1,monthlyMode:"day",dayOfMonth:1,escalatorPct:0,steps:[]}),o(null)},y=i=>{m(i),o(i.id)},g=i=>{confirm("Delete this income stream?")&&r(i)},j=i=>{if(!i)return"";try{return I(i).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}catch{return i}},x=i=>{if(i.frequency==="once")return`On ${j(i.onDate||"")}`;let l=i.frequency.charAt(0).toUpperCase()+i.frequency.slice(1);if(i.frequency==="daily"&&i.skipWeekends&&(l+=" (skip weekends)"),(i.frequency==="weekly"||i.frequency==="biweekly")&&i.dayOfWeek){const f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],b=i.dayOfWeek.map(d=>f[d]).join(", ");l+=` on ${b}`}if(i.frequency==="monthly"){if(i.monthlyMode==="day"&&i.dayOfMonth)l+=` on day ${i.dayOfMonth}`;else if(i.monthlyMode==="nth"&&i.nthWeek&&i.nthWeekday!==void 0){const f=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];l+=` on ${i.nthWeek} ${f[i.nthWeekday]}`}}return l};return e.jsx("section",{id:"income",className:"tab-panel active",children:e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:"Recurring Income Streams"}),e.jsxs("form",{onSubmit:p,className:"form grid-4",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stName",children:"Name"}),e.jsx("input",{id:"stName",type:"text",placeholder:"Weekly sales, AR collections, etc.",value:c.name||"",onChange:i=>m({...c,name:i.target.value}),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stCategory",children:"Category"}),e.jsx("input",{id:"stCategory",type:"text",placeholder:"Sales, AR, etc.",value:c.category||"",onChange:i=>m({...c,category:i.target.value})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stAmount",children:"Amount"}),e.jsx("input",{id:"stAmount",type:"number",step:"0.01",value:c.amount||"",onChange:i=>m({...c,amount:parseFloat(i.target.value)}),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stEscalator",children:"Monthly Escalator (%)"}),e.jsx("input",{id:"stEscalator",type:"number",step:"0.01",placeholder:"e.g. 1.5",value:c.escalatorPct||"",onChange:i=>m({...c,escalatorPct:parseFloat(i.target.value)||0})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stFreq",children:"Frequency"}),e.jsxs("select",{id:"stFreq",value:c.frequency,onChange:i=>m({...c,frequency:i.target.value}),children:[e.jsx("option",{value:"once",children:"Once"}),e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"biweekly",children:"Biweekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),c.frequency==="once"&&e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stOnDate",children:"On Date"}),e.jsx("input",{id:"stOnDate",type:"date",value:c.onDate||"",onChange:i=>m({...c,onDate:i.target.value})})]}),c.frequency==="daily"&&e.jsx("div",{className:"field",children:e.jsxs("label",{children:[e.jsx("input",{id:"stSkipWeekends",type:"checkbox",checked:c.skipWeekends,onChange:i=>m({...c,skipWeekends:i.target.checked})})," ","Skip weekends"]})}),c.frequency!=="once"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stStart",children:"Start Date"}),e.jsx("input",{id:"stStart",type:"date",value:c.startDate||"",onChange:i=>m({...c,startDate:i.target.value}),required:!0})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"stEnd",children:"End Date"}),e.jsx("input",{id:"stEnd",type:"date",value:c.endDate||"",onChange:i=>m({...c,endDate:i.target.value}),required:!0})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",type:"submit",children:s?"Update Stream":"Add Stream"}),s&&e.jsx("button",{className:"btn btn-outline",type:"button",onClick:u,children:"Cancel"})]})]}),e.jsxs("table",{className:"table",id:"streamsTable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Frequency"}),e.jsx("th",{children:"Schedule"}),e.jsx("th",{className:"num",children:"Amount"}),e.jsx("th",{children:"Dates"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:i.name}),e.jsx("td",{children:i.category}),e.jsx("td",{children:i.frequency}),e.jsx("td",{children:x(i)}),e.jsx("td",{className:"num",children:S(i.amount)}),e.jsxs("td",{children:[i.frequency!=="once"&&`${j(i.startDate)} - ${j(i.endDate)}`,i.frequency==="once"&&j(i.onDate||"")]}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>y(i),children:"Edit"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>g(i.id),children:"Remove"})]})]},i.id))})]})]})})}function tn(){const{addOneOff:t}=Y(),[a,n]=k.useState({roll:"forward",lag:0,conf:100,category:"AR",prune:!1}),[r,s]=k.useState([]),[o,c]=k.useState(new Set),m=i=>{var b;const l=(b=i.target.files)==null?void 0:b[0];if(!l)return;const f=new FileReader;f.onload=d=>{var D;try{const v=((D=d.target)==null?void 0:D.result).split(`
`).slice(1).filter(A=>A.trim()).map(A=>{const L=A.split(",").map(H=>H.trim());return{id:crypto.randomUUID(),company:L[0]||"",invoice:L[1]||"",due:L[2]||"",amount:parseFloat(L[3])||0,conf:a.conf}});s(v),alert(`Parsed ${v.length} invoices from file`)}catch(w){console.error("Failed to parse AR file:",w),alert("Failed to parse AR file. Please check the format.")}},f.readAsText(l)},p=()=>{r.length===0?alert("No invoices loaded. Please upload a file first."):alert(`Preview: ${r.length} invoices ready to import`)},u=()=>{const i=r.filter(l=>o.has(l.id));if(i.length===0){alert("No invoices selected for import");return}i.forEach(l=>{const f=new Date(l.due);if(f.setDate(f.getDate()+a.lag),a.roll!=="none"){const w=f.getDay();w===0?f.setDate(f.getDate()+(a.roll==="forward"?1:-2)):w===6&&f.setDate(f.getDate()+(a.roll==="forward"?2:-1))}const b=f.toISOString().slice(0,10),d=l.amount*l.conf/100,D={id:l.id,name:`AR: ${l.company} - ${l.invoice}`,category:a.category,amount:d,type:"income",date:b,recurring:!1,steps:[],escalatorPct:0,source:"AR Import",status:"imported"};t(D)}),alert(`Imported ${i.length} AR transactions`),s([]),c(new Set)},y=()=>{o.size===r.length?c(new Set):c(new Set(r.map(i=>i.id)))},g=i=>{const l=new Set(o);l.has(i)?l.delete(i):l.add(i),c(l)},j=i=>{if(!i)return"";try{return new Date(i).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}catch{return i}},x=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(i);return e.jsx("section",{id:"receivables",className:"tab-panel active",children:e.jsxs("div",{className:"card",children:[e.jsx("h2",{children:"Receivables (AR) Importer"}),e.jsx("div",{className:"ar-controls",children:e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"arFile",children:"Upload AR aging file"}),e.jsx("input",{id:"arFile",type:"file",accept:".csv,.xlsx,.xls",onChange:m})]})}),e.jsxs("div",{className:"ar-options",children:[e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"arRoll",children:"Weekend roll"}),e.jsxs("select",{id:"arRoll",value:a.roll,onChange:i=>n({...a,roll:i.target.value}),children:[e.jsx("option",{value:"forward",children:"Roll forward"}),e.jsx("option",{value:"back",children:"Roll back"}),e.jsx("option",{value:"none",children:"No roll"})]})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"arLag",children:"Payment lag (days)"}),e.jsx("input",{id:"arLag",type:"number",value:a.lag,min:"0",step:"1",onChange:i=>n({...a,lag:parseInt(i.target.value)||0})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"arConf",children:"Confidence %"}),e.jsx("input",{id:"arConf",type:"number",value:a.conf,min:"0",max:"100",step:"1",onChange:i=>n({...a,conf:parseInt(i.target.value)||100})})]}),e.jsxs("div",{className:"field",children:[e.jsx("label",{htmlFor:"arCategory",children:"Category"}),e.jsx("input",{id:"arCategory",type:"text",value:a.category,onChange:i=>n({...a,category:i.target.value})})]}),e.jsx("div",{className:"field checkbox-field",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{id:"arPrune",type:"checkbox",checked:a.prune,onChange:i=>n({...a,prune:i.target.checked})}),"Prune invoices missing from this import (archive)"]})}),e.jsxs("div",{className:"field actions-inline",children:[e.jsx("button",{onClick:p,className:"btn",children:"Preview"}),e.jsxs("button",{onClick:u,className:"btn",disabled:o.size===0,children:["Import (",o.size,")"]})]})]}),e.jsx("div",{className:"ar-status",children:r.length>0&&e.jsxs("p",{children:["Loaded ",r.length," invoice(s). Select which ones to import below."]})}),e.jsx("div",{className:"ar-preview-wrapper",children:e.jsxs("table",{className:"table ar-preview",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"select-col",children:e.jsxs("label",{className:"ar-select-all",children:[e.jsx("input",{type:"checkbox",checked:o.size===r.length&&r.length>0,onChange:y}),e.jsx("span",{children:"Select All"})]})}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"Due"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Conf %"}),e.jsx("th",{children:"Expected"})]})}),e.jsx("tbody",{children:r.map(i=>{const l=new Date(i.due);l.setDate(l.getDate()+a.lag);const f=l.toISOString().slice(0,10),b=i.amount*a.conf/100;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:o.has(i.id),onChange:()=>g(i.id)})}),e.jsx("td",{children:i.company}),e.jsx("td",{children:i.invoice}),e.jsx("td",{children:j(i.due)}),e.jsx("td",{children:x(i.amount)}),e.jsxs("td",{children:[a.conf,"%"]}),e.jsxs("td",{children:[j(f)," (",x(b),")"]})]},i.id)})})]})})]})})}function nn(){const[t,a]=k.useState("dashboard"),{importData:n,settings:r,adjustments:s,oneOffs:o,incomeStreams:c}=Y(),m=()=>{const g={settings:r,adjustments:s,oneOffs:o,incomeStreams:c},j=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),x=URL.createObjectURL(j),i=document.createElement("a");i.href=x,i.download=`cashflow-export-${new Date().toISOString().slice(0,10)}.json`,i.click(),URL.revokeObjectURL(x)},p=()=>{const g=document.createElement("input");g.type="file",g.accept=".json",g.onchange=j=>{var l;const x=(l=j.target.files)==null?void 0:l[0];if(!x)return;const i=new FileReader;i.onload=f=>{var b;try{const d=JSON.parse((b=f.target)==null?void 0:b.result);confirm("Import this data? This will replace your current plan.")&&(n(d),alert("Data imported successfully!"))}catch(d){console.error("Failed to parse JSON:",d),alert("Failed to parse JSON file. Please check the format.")}},i.readAsText(x)},g.click()},u=()=>{alert("PDF export coming soon! This will generate a 30-day forecast PDF.")},y=()=>{alert("Snapshot PDF export coming soon! This will generate a cash flow snapshot PDF.")};return e.jsxs(Wt,{onExportJSON:m,onImportJSON:p,onExportPDF:u,onExportSnapshotPDF:y,children:[e.jsx(Rt,{activeTab:t,onTabChange:a}),e.jsxs("main",{children:[t==="dashboard"&&e.jsx(Qt,{}),t==="whatif"&&e.jsx(Zt,{}),t==="movements"&&e.jsx(Xt,{}),t==="income"&&e.jsx(en,{}),t==="receivables"&&e.jsx(tn,{})]})]})}re.createRoot(document.getElementById("root")).render(e.jsx(be.StrictMode,{children:e.jsx(nn,{})}));
//# sourceMappingURL=index-ZyzIk2NU.js.map
